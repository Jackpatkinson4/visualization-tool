{"version":3,"sources":["serviceWorker.js","anim/SingleAnimation.js","anim/UndoFunctions.js","anim/CustomEvents.js","anim/AnimatedObject.js","anim/AnimatedBTreeNode.js","anim/AnimatedCircle.js","anim/AnimatedCircularlyLinkedListNode.js","anim/AnimatedDoublyLinkedListNode.js","anim/AnimatedHighlightCircle.js","anim/AnimatedLabel.js","anim/AnimatedLine.js","anim/AnimatedLinkedListNode.js","anim/AnimatedRectangle.js","anim/AnimatedSkipListNode.js","anim/ObjectManager.js","anim/AnimationMain.js","components/Footer.js","components/Header.js","algo/Algorithm.js","algo/AVL.js","algo/ArrayList.js","algo/util/GraphUtil.js","algo/Graph.js","algo/BFS.js","algo/BST.js","algo/BTree.js","algo/BoyerMoore.js","algo/BruteForce.js","algo/BubbleSort.js","algo/CircularlyLinkedList.js","algo/Hash.js","algo/ClosedHash.js","algo/CocktailSort.js","algo/DFS.js","algo/DPLCS.js","algo/DequeArray.js","algo/DequeLL.js","algo/DijkstraPrim.js","algo/DoublyLinkedList.js","algo/Floyd.js","algo/Heap.js","algo/InsertionSort.js","algo/KMP.js","algo/Kruskal.js","algo/LSDRadix.js","algo/LinkedList.js","algo/MergeSort.js","algo/OpenHash.js","algo/QueueArray.js","algo/QueueLL.js","algo/QuickSelect.js","algo/QuickSort.js","algo/RabinKarp.js","algo/SelectionSort.js","algo/SkipList.js","algo/SplayTree.js","AlgoList.js","algo/StackArray.js","algo/StackLL.js","examples/ExampleModals.js","screens/AlgoScreen.js","screens/AboutScreen.js","screens/HomeScreen.js","App.js","index.js"],"names":["Boolean","window","location","hostname","match","SingleAnimation","id","fromX","fromY","toX","toY","this","objectID","UndoBlock","UndoMove","fmX","fmy","tx","ty","animationList","nextAnim","push","UndoCreate","world","removeObject","UndoHighlight","val","color","highlightValue","setHighlight","UndoSetHeight","height","setHeight","UndoSetWidth","width","setWidth","UndoSetNumElements","obj","newNumElems","sizeBeforeChange","getNumElements","sizeAfterChange","labels","Array","colors","i","getText","getTextColor","setNumElements","setText","setTextColor","UndoSetAlpha","alph","alphaVal","setAlpha","UndoSetNull","nv","nullVal","setNull","UndoSetPrevNull","setPrevNull","UndoSetNextNull","setNextNull","UndoSetForegroundColor","setForegroundColor","UndoSetBackgroundColor","setBackgroundColor","UndoSetHighlightIndex","index","setHighlightIndex","UndoSetText","str","newText","labelIndex","UndoSetTextColor","UndoHighlightEdge","from","to","fromID","toID","setEdgeHighlight","UndoSetEdgeColor","oldColor","setEdgeColor","UndoSetEdgeAlpha","oldAplha","alpha","setEdgeAlpha","UndoSetPosition","x","y","setNodePosition","EventListener","events","kind","scope","func","scopeFunctions","length","functions","splice","undefined","event","objects","functs","j","call","AnimatedObject","backgroundColor","foregroundColor","highlighted","label","labelColor","layer","minHeightDiff","range","highlightIndex","highlightIndexDirty","addedToScene","newColor","newAlpha","value","highlightColor","Error","otherObject","right","getWidth","centerY","left","centerX","top","getHeight","bottom","xDelta","yDelta","xPos","yPos","frameNum","frameMod","delta","Math","abs","highlightDiff","hlIndex","AnimatedBTreeNode","widthPerElement","h","numLabels","labelColors","newNumElements","context","startX","isNaN","startY","strokeStyle","fillStyle","beginPath","moveTo","lineTo","closePath","stroke","fill","textAlign","textBaseline","labelX","labelY","fillText","anchor","textIndex","UndoDeleteBTreeNode","addBTreeNode","setLayer","AnimatedCircle","radius","thickness","getHeadPointerAttachPos","newWidth","xVec","yVec","len","sqrt","globalAlpha","arc","PI","lineWidth","font","strList","split","leftWidth","measureText","substring","centerWidth","textWidth","startingXForHighlight","leftStr","highlightStr","rightStr","mid","UndoDeleteCircle","addCircleObject","AnimatedCircularlyLinkedListNode","w","linkPercent","nullPointer","labelPosX","labelPosY","np","getClosestCardinalPoint","resetTextPosition","UndoDeleteCircularlyLinkedList","addCircularlyLinkedListObject","AnimatedDoublyLinkedListNode","prevNullPointer","nextNullPointer","closest","UndoDeleteDoublyLinkedList","pnp","nnp","addDoublyLinkedListObject","AnimatedHighlightCircle","UndoDeleteHighlightCircle","addHighlightCircleObject","AnimatedLabel","centered","initialWidth","strokeText","offset","indexOf","UndoDeleteLabel","addLabelObject","AnimatedLine","curve","directed","edgeLabel","anchorPoint","dirty","arrowHeight","arrowWidth","highlightVal","LINE_MAX_HEIGHT_DIFF","n","penSize","fromPos","getTailPointerAttachPos","toPos","deltaX","deltaY","midX","midY","controlX","controlY","quadraticCurveTo","midLen","sign","drawArrow","UndoConnect","createConnection","connectEdge","disconnect","AnimatedLinkedListNode","vertical","linkPosEnd","UndoDeleteLinkedList","addLinkedListObject","AnimatedRectangle","xJustify","yJustify","UndoDeleteRectangle","addRectangleObject","AnimatedSkipListNode","UndoDeleteSkipList","addSkipListObject","ObjectManager","canvasRef","nodes","edges","backEdges","activeLayers","ctx","current","getContext","framenum","statusReport","clearRect","alwaysOnTop","draw","pulseHighlight","shown","layers","resetLayers","objectColor","String","newNode","oldAlpha","nodeID","getAlpha","nextEdge","getHighlight","getHighlightIndex","objectIDfrom","objectIDto","undo","createUndoConnect","pop","deleted","undoStack","node2ID","identifier","len2","node1ID","oldObject","objectLabel","text","max","getTextWidth","lab","connectionPoint","fromObj","toObj","l","getNull","getLeftNull","getRightNull","setColor","id1","id2","alignTop","alignLeft","alignRight","getAlignRightPos","getAlignLeftPos","alignBottom","oldHighlight","centering","newLabel","nodeLabel","linkPer","verticalOrientation","numElems","widthPerElem","newX","newY","getCookie","cookieName","cookies","document","cookie","substr","replace","unescape","setCookie","expireDays","exDate","Date","setDate","getDate","ANIMATION_SPEED_DEFAULT","returnSubmit","field","maxSize","intOnly","size","keyASCII","keyCode","which","controlKey","addControlToAnimationBar","animBarRef","type","name","callback","element","createElement","setAttribute","onclick","onkeydown","tableEntry","appendChild","addDivisorToAnimationBar","divisorLeft","divisorRight","AnimationManager","objectManager","animatedObjects","animationPaused","awaitingStep","currentlyAnimating","animationSteps","currentAnimation","previousAnimationSteps","currFrame","animationBlockLength","currentBlock","doingUndo","undoAnimationStepIndices","undoAnimationStepIndicesStack","paused","canvas","skipBackButton","skipBack","stepBackButton","stepBack","playPauseBackButton","doPlayPause","stepForwardButton","step","skipForwardButton","skipForward","speed","parseInt","slider","Slider","defaultValue","onChange","e","setSpeed","controlBar","getElementById","newTable","midLevel","bottomLevel","ReactDOM","render","align","txtNode","createTextNode","widthEntry","changeSize","bind","heightEntry","sizeButton","addListener","animStarted","animEnded","animWaiting","animUndoUnavailable","percent","pausedValue","uppercase","toUpperCase","clr","charAt","newSpeed","floor","fireEvent","undoBlock","stopTimer","update","foundBreak","anyAnimations","act","params","commands","startNextBlock","startTimer","undoLastBlock","keepUndoing","finishUndoBlock","clearHistory","clearAllObjects","runFast","undoInitialStep","animateNext","addUndoAnimation","setAllLayers","lerp","getNodeX","getNodeY","disabled","timer","setTimeout","timeout","setPaused","clearInterval","move","removedEdges","deleteIncident","concat","getObject","createUndoDelete","connect","connectNext","connectPrev","connectCurve","connectSkipList","undoConnect","createCircle","createHighlightCircle","createRectangle","createLabel","createLinkedListNode","isArray","map","createDoublyLinkedListNode","createCircularlyLinkedListNode","createSkipListNode","createBTreeNode","oldText","oldHeight","oldWidth","oldNull","oldElem","setPosition","oldX","oldY","oldIndex","moveToAlignRight","newXY","Footer","className","href","Header","state","menuVisible","toggleMenu","setState","Fragment","onClick","null","true","false","React","Component","addLabelToAlgorithmBar","labelName","group","addCheckboxToAlgorithmBar","boxLabel","checked","span","addRadioButtonGroupToAlgorithmBar","buttonNames","groupName","buttonList","button","topLevelTableEntry","addControlToAlgorithmBar","addDivisorToAlgorithmBar","addGroupToAlgorithmBar","horizontal","parentGroup","Algorithm","am","animationManager","disableUI","enableUI","canvasWidth","canvasHeight","actionHistory","recordAnimation","code","start_x","start_y","line_height","standard_color","codeID","nextIndex","cmd","reset","args","next","retVal","startNewAnimation","input","maxLen","test","funct","maxsize","newHeight","prototype","returnSubmitFloat","addReturnSubmit","action","AVL","first_print_pos_y","PRINT_VERTICAL_GAP","print_max","startingX","addControls","EXPLANITORY_TEXT_X","EXPLANITORY_TEXT_Y","controls","insertField","insertCallback","insertButton","deleteField","deleteCallback","deleteButton","findField","findCallback","findButton","printButton","printCallback","clearButton","clearCallback","predSuccButtonList","predButton","succButton","predSucc","treeRoot","insertedValue","normalizeNumber","implementAction","add","deletedValue","remove","findValue","findElement","printTree","clear","highlightID","firstLabel","HIGHLIGHT_COLOR","xPosOfNextLabel","FIRST_PRINT_POS_X","yPosOfNextLabel","printTreeRec","tree","nextLabelID","data","PRINT_COLOR","PRINT_HORIZONTAL_GAP","doFind","graphicID","curr","LINK_COLOR","remakeTree","addH","resizeTree","treeNodeID","heightLabelID","bfLabelID","STARTING_Y","FOREGROUND_COLOR","BACKGROUND_COLOR","HEIGHT_LABEL_COLOR","AVLNode","parent","connectSmart","balance","some","updateHeightAndBF","bf","HIGHLIGHT_LABEL_COLOR","singleRotateRight","singleRotateLeft","B","A","t2","isLeftChild","removeH","deleteNode","dummy","removeSucc","removePred","startingPoint","resizeWidths","rightWidth","setNewPositions","animateNewPositions","xPosition","yPosition","side","heightLabelX","bfLabelX","heightLabelY","bfLabelY","HEIGHT_DELTA","WIDTH_DELTA","recClear","hid","bfid","initialX","initialY","node","r","HIGHLIGHT_LINK_COLOR","HIGHLIGHT_CIRCLE_COLOR","ArrayList","setup","addVerticalGroup","addTopHorizontalGroup","addBottomHorizontalGroup","addValueField","addIndexCallback","addIndexField","addFrontButton","addFrontCallback","addBackButton","addBackCallback","addIndexButton","removeVerticalGroup","removeTopHorizontalGroup","removeBottomHorizontalGroup","removeField","removeIndexCallback","removeIndexButton","removeFrontButton","removeFrontCallback","removeBackButton","removeBackCallback","arrayData","arrayID","arrayLabelID","xpos","ypos","highlight1ID","addVal","clearAll","elemToAdd","labPushID","labPushValID","presentID","labPopValID","LARGE_ALLOWED","LARGE_CURVE","LARGE_X_POS_LOGICAL","LARGE_Y_POS_LOGICAL","SMALL_ALLLOWED","SMALL_CURVE","SMALL_X_POS_LOGICAL","SMALL_Y_POS_LOGICAL","Graph","dir","dag","costs","currentLayer","isDAG","showEdgeCosts","setup_small","addDirection","newGraphButton","newGraphCallback","radioButtonList","undirectedGraphButton","directedGraphCallback","directedGraphButton","smallGraphButton","smallGraphCallback","largeGraphButton","largeGraphCallback","logicalButton","graphRepChangedCallback","adjacencyListButton","adjacencyMatrixButton","newDirected","resetAll","setup_large","newLayer","adj_matrix","adj_list_edges","adj_matrixID","circleID","clearEdges","buildEdges","adjustCurveForDirectedEdges","allowed","x_pos_logical","y_pos_logical","adj_matrix_x_start","adj_matrix_y_start","adj_matrix_width","adj_matrix_height","adj_list_x_start","adj_list_y_start","adj_list_elem_width","adj_list_elem_height","adj_list_height","adj_list_width","adj_list_spacing_after_list","adj_list_spacing_between_nodes","bidirectional","fromCharCode","edgePercent","random","buildAdjList","buildAdjMatrix","adj_matrix_index_x","adj_matrix_index_y","adj_list_list","adj_list_index","lastElem","nextXPos","hasEdges","BFS","startField","startCallback","startButton","messageID","visitedID","visitedIndexID","visited","queueID","listID","VISITED_START_X","terminationLabelID","AUX_ARRAY_START_Y","LIST_START_X","LIST_START_Y","QUEUE_START_X","QUEUE_START_Y","highlightCircleL","highlightCircleAL","highlightCircleAM","lastIndex","startvalue","charCodeAt","doBFS","startVetex","queue","head","tail","queueSize","rebuildEdges","vertex","nextQueueIndex","neighbor","highlightEdge","BST","BSTNode","MESSAGE_X","MESSAGE_Y","BTree","starting_x","preemptiveSplit","max_keys","min_keys","split_index","max_degree","moveLabel1ID","moveLabel2ID","ignoreInputs","newMaxDegree","changeDegree","insertElement","deleteElement","clearTree","premptiveSplitBox","changePreemtiveSplit","newValue","isLeaf","numKeys","keys","getLabelX","children","deleteTree","degree","newDegree","maxDegreeRadioButtons","findInTree","BTreeNode","insertNotFull","insert","insertValue","insertIndex","findIndex","newTree","insertRepair","rightNode","currentParent","parentIndex","risingNode","leftNode","doDeleteNotEmpty","doDelete","nextNode","stealFromLeft","mergeRight","stealFromRight","maxNode","minNode","repairAfterDelete","parentNode","rightSib","fromParentIndex","tmpLabel1","tmpLabel2","leftSib","WIDTH_PER_ELEM","leftEdge","priorWidth","widths","treeWidth","BoyerMoore","textField","patternField","blotButton","buildLastOccurrenceTableCallback","textRowID","comparisonMatrixID","patternTableLabelID","patternTableCharacterID","patternTableIndexID","lastTableLabelID","lastTableCharacterID","lastTableValueID","pattern","find","onlyBuildLastOccurrenceTable","maxRows","getMaxRows","cellSize","row","col","lastTable","buildLastTable","iPointerID","jPointerID","k","shift","textLength","labelsX","PATTERN_START_Y","LAST_TABLE_START_Y","patternTableStartX","lotStartX","lotPointerID","Object","char","BruteForce","lastSwapEnabled","BubbleSort","listField","sortCallback","lastSwapCheckbox","toggleLastSwap","displayData","list","sort","Number","filter","slice","elemCounts","Map","letterMap","count","has","get","set","toString","currChar","ARRAY_START_X","sorted","end","lastSwapped","movePointers","swap","iXPos","jXPos","iLabelID","jLabelID","temp","CircularlyLinkedList","initialIndex","linkedListElemID","leftoverLabelID","resetNodePositions","labCopiedValID","copiedData","firstNodeID","lastX","lastY","LINKED_LIST_ELEM_HEIGHT","nextX","nextY","labPopID","nodePosX","LINKED_LIST_START_X","secondNodeY","LINKED_LIST_START_Y","removedNodeIndex","Hash","hashingIntegers","hashIntegerButton","changeHashTypeCallback","hashStringButton","newHashingIntegers","changeHashType","newHashingIntegerValue","labelID1","labelID2","table_size","currHash","HASH_LABEL_X","indexXPos","indexYPos","label1","wordToHashID","wordToHash","digits","hashValue","nextByte","nextByteID","resultDigits","floatingDigits","floatingVals","operatorID","barID","nextChar","carry","HASH_NUMBER_START_X","label2","HASH_NUMBER_START_Y","ARRAY_ELEM_WIDTH","ClosedHash","elements_per_row","linearProblingButton","linearProbeCallback","quadraticProbingButton","quadraticProbeCallback","doubleHashingButton","doubleHashingCallback","currentHashingTypeButtonState","newProbingType","skipDist","changeProbeType","elem","ExplainLabel","doHash","getEmptyIndex","labID","hashTableVisual","hashTableValues","empty","labelID","skipVal","resetSkipDist","foundIndex","candidateIndex","getElemIndex","hashTableIndices","nextID","nextYPos","resetIndex","CocktailSort","start","DFS","physicalStackButton","recursiveStackButton","stackType","stackID","doDFSStack","doDFSRecursive","startVertex","stack","vertexID","currentID","messageY","dfsVisit","messageX","nextMessage","DPLCS","CODE_START_X","CODE_START_Y","CODE_LINE_HEIGHT","CODE_STANDARD_COLOR","oldIDs","S1Field","emptyCallback","MAX_SEQUENCE_LENGTH","S2Field","recursiveButton","recursiveCallback","tableButton","tableCallback","memoizedButton","memoizedCallback","S1","S2","tableID","tableVals","tableXPos","tableYPos","S1TableID","TABLE_START_X","TABLE_ELEM_WIDTH","TABLE_START_Y","TABLE_ELEM_HEIGHT","S2TableID","helpMessage","recursiveLCS","tableLCS","memoizedLCS","clearOldIDs","RECURSIVE_START_X","RECURSIVE_START_Y","sequences","currentY","functionCallID","final","LCS","ID","ID2","CODE_HIGHLIGHT_COLOR","RECURSIVE_DELTA_Y","subProb","RECURSIVE_DELTA_X","firstID","secondID","subProb1","subProb2","best","currX","currY","sequence","header","SEQUENCE_START_X","SEQUENCE_START_Y","nextSequenceID","SEQUENCE_DELTA_X","buildTable","moveID","buildLCSFromTable","movingLabel","LCSMem","TABLE_DIFF_X","TABLE_INDEX_COLOR","CODE_RECURSIVE_1_COLOR","CODE_RECURSIVE_2_COLOR","MAX_VALUE","MESSAGE_ID","DequeArray","addField","addFirstButton","addFirstCallBack","addLastButton","addLastCallback","removeFirstButton","removeFirstCallback","removeLastButton","removeLastCallback","frontID","frontLabelID","sizeID","sizeLabelID","front","highlight2ID","pushVal","addLast","removeFirst","removeLast","addFirst","elemToaddLast","labaddLastID","labaddLastValID","addIndex","labelAddID","QUEUE_LABEL_X","labremoveFirstID","labremoveFirstValID","removeFirstdVal","adjustIfEmpty","remLabelID","remLabelValID","remIndex","removedVal","DequeLL","addFirstCallback","DijkstraPrim","runningDijkstra","message1ID","knownID","distanceID","pathID","known","distance","path","comparisonMessageID","bestIndex","recolorGraph","findCheapestUnknown","distString","compare","createPaths","highlightTree","pathList","nextInPath","doDijkstraPrim","Dijkstra","Prim","DoublyLinkedList","Floyd","costTable","pathTable","alwaysUseINF","cost_table_width","SMALL_COST_TABLE_WIDTH","cost_table_height","SMALL_COST_TABLE_HEIGHT","cost_table_start_x","SMALL_COST_TABLE_START_X","cost_table_start_y","SMALL_COST_TABLE_START_Y","path_table_width","SMALL_PATH_TABLE_WIDTH","path_table_height","SMALL_PATH_TABLE_HEIGHT","path_table_start_x","SMALL_PATH_TABLE_START_X","path_table_start_y","SMALL_PATH_TABLE_START_Y","node_1_x_pos","SMALL_NODE_1_X_POS","node_1_y_pos","SMALL_NODE_1_Y_POS","node_2_x_pos","SMALL_NODE_2_X_POS","node_2_y_pos","SMALL_NODE_2_Y_POS","node_3_x_pos","SMALL_NODE_3_X_POS","node_3_y_pos","SMALL_NODE_3_Y_POS","message_x","SMALL_MESSAGE_X","message_y","SMALL_MESSAGE_Y","LARGE_COST_TABLE_WIDTH","LARGE_COST_TABLE_HEIGHT","LARGE_COST_TABLE_START_X","LARGE_COST_TABLE_START_Y","LARGE_PATH_TABLE_WIDTH","LARGE_PATH_TABLE_HEIGHT","LARGE_PATH_TABLE_START_X","LARGE_PATH_TABLE_START_Y","LARGE_NODE_1_X_POS","LARGE_NODE_1_Y_POS","LARGE_NODE_2_X_POS","LARGE_NODE_2_Y_POS","LARGE_NODE_3_X_POS","LARGE_NODE_3_Y_POS","LARGE_MESSAGE_X","LARGE_MESSAGE_Y","costTableID","pathTableID","pathIndexXID","pathIndexYID","costIndexXID","costIndexYID","node3ID","costTableHeader","pathTableHeader","getCostLabel","doFloydWarshall","HEAP_X_POSITIONS","HEAP_Y_POSITIONS","Heap","createArray","removeButton","removeCallback","verticalGroup","horizontalGroup","buildHeapField","buildHeapCallback","buildHeapButton","minMaxButtonList","minHeapButton","minHeapCallback","maxHeapButton","maxHeapCallback","isMinHeap","arrayLabels","arrayRects","circleObjs","arrayXPositions","currentHeapSize","swapLabel1","swapLabel2","swapLabel3","swapLabel4","descriptLabel1","descriptLabel2","buildHeap","index1","index2","tmp","childIndex","setIndexHighlight","downheapCheckRightChild","downheapCompare","pushDown","unshift","nextElem","ARRAY_SIZE","currentIndex","upheapCompare","InsertionSort","KMP","bftButton","buildFailureTableCallback","failureTableLabelID","failureTableCharacterID","failureTableValueID","onlyBuildFailureTable","failureTable","buildFailureTable","nextAlignment","FAILURE_TABLE_START_Y","tableStartX","Kruskal","setID","setIndexID","setData","SET_ARRAY_ELEM_WIDTH","SET_ARRAY_ELEM_HEIGHT","SET_ARRAY_START_X","SET_ARRAY_START_Y","doKruskal","valueToFind","highlightCircleID","edgesListLeftID","edgesListRightID","edgesListLeft","edgesListRight","EDGE_LIST_START_X","EDGE_LIST_MAX_PER_COLUMN","EDGE_LIST_COLUMN_WIDTH","EDGE_LIST_START_Y","EDGE_LIST_ELEM_HEIGHT","EDGE_LIST_ELEM_WIDTH","tmpLeftID","tmpRightID","tmpLeft","tmpRight","edgeCount","findLabelLeft","findLabelRight","highlightCircle1","highlightCircle2","moveLabelID","messageLabelID","edgesAdded","nextListIndex","FIND_LABEL_1_X","FIND_LABEL_1_Y","FIND_LABEL_2_X","FIND_LABEL_2_Y","HIGHLIGHT_CIRCLE_COLOR_1","disjointSetFind","HIGHLIGHT_CIRCLE_COLOR_2","MESSAGE_LABEL_X","MESSAGE_LABEL_Y","LSDRadix","arrayDisplay","bucketsData","bucketsID","bucketsDisplay","infoLabelID","greatest","log10","longData","display","digit","nthDigit","idBucket","dataBucket","displayBucket","BUCKETS_START_Y","pow","LinkedList","MergeSort","kPointerID","ceil","leftHelper","rightHelper","merge","prevOffset","tempArrayID","drawArrayAndCopy","extraOffset","copyData","currOffset","leftOffset","rightOffset","currArrayID","tempArray","tempDisplay","bottomYPos","kXPos","topYPos","movePointer","fromIndex","toIndex","fromOffset","toOffset","fromRow","toRow","cellID","pointerID","fromXPos","fromYPos","toXPos","toYPos","POINTER_ARRAY_ELEM_WIDTH","OpenHash","POINTER_ARRAY_ELEM_Y","LinkedListNode","found","compareIndex","repositionList","tmpPrev","QueueArray","enqueueField","enqueueCallback","enqueueButton","dequeueButton","dequeueCallback","headID","headLabelID","tailID","tailLabelID","enqueue","dequeue","elemToEnqueue","labEnqueueID","labEnqueueValID","labDequeueID","labDequeueValID","dequeuedVal","QueueLL","tail_pos_y","tail_label_y","elemToPush","resetLinkedListPositions","worstPivotEnabled","firstPivotEnabled","QuickSelect","runCallback","kField","togglesGroup","worstPivotToggle","toggleWorstPivot","firstPivotToggle","toggleFirstPivot","pPointerID","listStr","run","helper","pivot","min","pXPos","swapPivot","other","moveJ","lLabelID","lXPos","pLabelID","QuickSort","RabinKarp","baseLabelID","characterValuesLabelID","textHashLabelID","textHashCalculationID","patternHashLabelID","patternHashCalculationID","toLowerCase","textCalculation","textHash","patternCalculation","patternHash","calculationsX","SelectionSort","smallest","SkipList","topHorizontalGroup","bottomHorizontalGroup","addRandomlyCallback","headsField","addWithHeadsCallback","addRandomlyButton","addWithHeadsButton","getField","getCallback","getButton","NEGATIVE_INFINITY","POSITIVE_INFINITY","SKIP_LIST_START_X","heads","valueLabelId","valueStringId","cfLabelId","cfStringId","headsString","rightPhantomsCol","newCol","foundDuplicate","nextCol","getNextCol","shiftColumns","prevCol","getPrevCol","removedCol","maxHeight","leftPhantomID","rightPhantomID","SplayTree","splay","zigZigRight","doubleRotateRight","zigZigLeft","doubleRotateLeft","treeRot","splayUp","insertElem","treeDelete","valueToDelete","inTree","oldGraphicID","largestLeft","findMax","C","t3","algoMap","algos","StackArray","pushField","pushCallback","pushButton","popButton","popCallback","topID","topLabelID","clearData","StackLL","algoList","AlgoScreen","props","toggleExamples","examplesEnabled","algoName","pathname","createRef","animManag","currentAlg","modals","ref","AboutScreen","HomeScreen","exact","idx","key","App","basename","component","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,EAAE,IAAM,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACxD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,IACpD,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GACpD,CAAC,EAAG,EAAG,EAAG,IAAM,EAAG,EA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","file":"static/js/main.e55de5ac.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\n/* global process */\n/* eslint-disable no-console */\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export default class SingleAnimation {\n\tconstructor(id, fromX, fromY, toX, toY) {\n\t\tthis.objectID = id;\n\t\tthis.fromX = fromX;\n\t\tthis.fromY = fromY;\n\t\tthis.toX = toX;\n\t\tthis.toY = toY;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Base \"class\": UndoBlock\n\nimport SingleAnimation from './SingleAnimation';\n\nexport class UndoBlock {\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n\n\tundoInitialStep() {}\n}\n\nexport class UndoMove extends UndoBlock {\n\tconstructor(id, fmX, fmy, tx, ty) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.fromX = fmX;\n\t\tthis.fromY = fmy;\n\t\tthis.toX = tx;\n\t\tthis.toY = ty;\n\t}\n\n\taddUndoAnimation(animationList) {\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tthis.objectID,\n\t\t\tthis.fromX,\n\t\t\tthis.fromY,\n\t\t\tthis.toX,\n\t\t\tthis.toY\n\t\t);\n\t\tanimationList.push(nextAnim);\n\t\treturn true;\n\t}\n}\n\nexport class UndoCreate extends UndoBlock {\n\tconstructor(id) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.removeObject(this.objectID);\n\t}\n}\n\nexport class UndoHighlight extends UndoBlock {\n\tconstructor(id, val, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.highlightValue = val;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlight(this.objectID, this.highlightValue, this.color);\n\t}\n}\n\nexport class UndoSetHeight extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.height = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHeight(this.objectID, this.height);\n\t}\n}\n\nexport class UndoSetWidth extends UndoBlock {\n\tconstructor(id, val) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.width = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setWidth(this.objectID, this.width);\n\t}\n}\n\nexport class UndoSetNumElements extends UndoBlock {\n\tconstructor(obj, newNumElems) {\n\t\tsuper();\n\t\tthis.objectID = obj.objectID;\n\t\tthis.sizeBeforeChange = obj.getNumElements();\n\t\tthis.sizeAfterChange = newNumElems;\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tthis.labels = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tthis.colors = new Array(this.sizeBeforeChange - this.sizeAfterChange);\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tthis.labels[i] = obj.getText(i + this.sizeAfterChange);\n\t\t\t\tthis.colors[i] = obj.getTextColor(i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNumElements(this.objectID, this.sizeBeforeChange);\n\t\tif (this.sizeBeforeChange > this.sizeAfterChange) {\n\t\t\tfor (let i = 0; i < this.sizeBeforeChange - this.sizeAfterChange; i++) {\n\t\t\t\tworld.setText(this.objectID, this.labels[i], i + this.sizeAfterChange);\n\t\t\t\tworld.setTextColor(this.objectID, this.colors[i], i + this.sizeAfterChange);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class UndoSetAlpha extends UndoBlock {\n\tconstructor(id, alph) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.alphaVal = alph;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setAlpha(this.objectID, this.alphaVal);\n\t}\n}\n\nexport class UndoSetNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetPrevNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setPrevNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetNextNull extends UndoBlock {\n\tconstructor(id, nv) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.nullVal = nv;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNextNull(this.objectID, this.nullVal);\n\t}\n}\n\nexport class UndoSetForegroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setForegroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetBackgroundColor extends UndoBlock {\n\tconstructor(id, color) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setBackgroundColor(this.objectID, this.color);\n\t}\n}\n\nexport class UndoSetHighlightIndex extends UndoBlock {\n\tconstructor(id, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setHighlightIndex(this.objectID, this.index);\n\t}\n}\n\nexport class UndoSetText extends UndoBlock {\n\tconstructor(id, str, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.newText = str;\n\t\tthis.labelIndex = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setText(this.objectID, this.newText, this.labelIndex);\n\t}\n}\n\nexport class UndoSetTextColor extends UndoBlock {\n\tconstructor(id, color, index) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.color = color;\n\t\tthis.index = index;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setTextColor(this.objectID, this.color, this.index);\n\t}\n}\n\nexport class UndoHighlightEdge extends UndoBlock {\n\tconstructor(from, to, val) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.highlightValue = val;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeHighlight(this.fromID, this.toID, this.highlightValue);\n\t}\n}\n\nexport class UndoSetEdgeColor extends UndoBlock {\n\tconstructor(from, to, oldColor) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.color = oldColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeColor(this.fromID, this.toID, this.color);\n\t}\n}\n\nexport class UndoSetEdgeAlpha extends UndoBlock {\n\tconstructor(from, to, oldAplha) {\n\t\tsuper();\n\t\tthis.fromID = from;\n\t\tthis.toID = to;\n\t\tthis.alpha = oldAplha;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setEdgeAlpha(this.fromID, this.toID, this.alpha);\n\t}\n}\n\nexport class UndoSetPosition extends UndoBlock {\n\tconstructor(id, x, y) {\n\t\tsuper();\n\t\tthis.objectID = id;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class EventListener {\n\tconstructor() {\n\t\tthis.events = [];\n\t}\n\n\tremoveListener(kind, scope, func) {\n\t\tif (this.events[kind] == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet scopeFunctions = null;\n\t\tlet i;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions == null) {\n\t\t\treturn;\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\tscopeFunctions.functions.splice(i, 1);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\taddListener(kind, scope, func) {\n\t\tif (this.events[kind] === undefined) {\n\t\t\tthis.events[kind] = [];\n\t\t}\n\t\tlet i;\n\t\tlet scopeFunctions = null;\n\t\tfor (i = 0; i < this.events[kind].length; i++) {\n\t\t\tif (this.events[kind][i].scope === scope) {\n\t\t\t\tscopeFunctions = this.events[kind][i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (scopeFunctions === null) {\n\t\t\tthis.events[kind].push({ scope: scope, functions: [] });\n\t\t\tscopeFunctions = this.events[kind][this.events[kind].length - 1];\n\t\t}\n\t\tfor (i = 0; i < scopeFunctions.functions.length; i++) {\n\t\t\tif (scopeFunctions.functions[i] === func) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tscopeFunctions.functions.push(func);\n\t}\n\n\tfireEvent(kind, event) {\n\t\t// TODO:  Should add a deep clone here ...\n\t\tif (this.events[kind] !== undefined) {\n\t\t\tfor (let i = 0; i < this.events[kind].length; i++) {\n\t\t\t\tconst objects = this.events[kind][i];\n\t\t\t\tconst functs = objects.functions;\n\t\t\t\tconst scope = objects.scope;\n\t\t\t\tfor (let j = 0; j < functs.length; j++) {\n\t\t\t\t\tconst func = functs[j];\n\t\t\t\t\tfunc.call(scope, event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nexport default class AnimatedObject {\n\tconstructor() {\n\t\tthis.objectID = -1;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\n\t\tthis.backgroundColor = '#FFFFFF';\n\t\tthis.foregroundColor = '#000000';\n\t\tthis.highlighted = false;\n\n\t\tthis.label = '';\n\t\tthis.labelColor = '#000000';\n\n\t\tthis.layer = 0;\n\t\tthis.alpha = 1.0;\n\t\tthis.minHeightDiff = 3;\n\t\tthis.range = 5;\n\n\t\tthis.highlightIndex = -1;\n\t\tthis.highlightIndexDirty = true;\n\n\t\tthis.addedToScene = true;\n\t}\n\n\tsetBackgroundColor(newColor) {\n\t\tthis.backgroundColor = newColor;\n\t}\n\n\tsetNull() {}\n\n\tgetNull() {\n\t\treturn false;\n\t}\n\n\tsetAlpha(newAlpha) {\n\t\tthis.alpha = newAlpha;\n\t}\n\n\tgetAlpha() {\n\t\treturn this.alpha;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.labelColor = newColor;\n\t}\n\n\tgetHighlight() {\n\t\treturn this.highlighted;\n\t}\n\n\tgetWidth() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tgetHeight() {\n\t\t// TODO:  Do we want to throw here?  Should always override this ...\n\t\treturn 0;\n\t}\n\n\tsetHighlight(value, color) {\n\t\tthis.highlighted = value;\n\t\tthis.highlightColor = color || '#ff0000';\n\t}\n\n\tcenterX() {\n\t\treturn this.x;\n\t}\n\n\tsetWidth() {\n\t\tthrow new Error('setWidth() should be implemented in a base class');\n\t}\n\n\tcenterY() {\n\t\treturn this.y;\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\treturn [otherObject.right() + this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\treturn [otherObject.left() - this.getWidth() / 2, otherObject.centerY()];\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.top() - this.getHeight() / 2];\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\treturn [otherObject.centerX(), otherObject.bottom() + this.getHeight() / 2];\n\t}\n\n\talignLeft(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.right() + this.getWidth() / 2;\n\t}\n\n\talignRight(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\t//  (See AnimatedLabel, for instance)\n\t\tthis.y = otherObject.centerY();\n\t\tthis.x = otherObject.left() - this.getWidth() / 2;\n\t}\n\n\talignTop(otherObject) {\n\t\t// Assuming centering.  Overridden method could modify if not centered\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.top() - this.getHeight() / 2;\n\t}\n\n\talignBottom(otherObject) {\n\t\tthis.x = otherObject.centerX();\n\t\tthis.y = otherObject.bottom() + this.getHeight() / 2;\n\t}\n\n\tgetClosestCardinalPoint(fromX, fromY) {\n\t\tlet xDelta;\n\t\tlet yDelta;\n\t\tlet xPos;\n\t\tlet yPos;\n\n\t\tif (fromX < this.left()) {\n\t\t\txDelta = this.left() - fromX;\n\t\t\txPos = this.left();\n\t\t} else if (fromX > this.right()) {\n\t\t\txDelta = fromX - this.right();\n\t\t\txPos = this.right();\n\t\t} else {\n\t\t\txDelta = 0;\n\t\t\txPos = this.centerX();\n\t\t}\n\n\t\tif (fromY < this.top()) {\n\t\t\tyDelta = this.top() - fromY;\n\t\t\tyPos = this.top();\n\t\t} else if (fromY > this.bottom()) {\n\t\t\tyDelta = fromY - this.bottom();\n\t\t\tyPos = this.bottom();\n\t\t} else {\n\t\t\tyDelta = 0;\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\tif (yDelta > xDelta) {\n\t\t\txPos = this.centerX();\n\t\t} else {\n\t\t\tyPos = this.centerY();\n\t\t}\n\n\t\treturn [xPos, yPos];\n\t}\n\n\tcentered() {\n\t\treturn false;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 7.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * this.range - 2)) - this.range + 1);\n\t\t\tthis.highlightDiff = delta + this.minHeightDiff;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tgetHeadPointerAttachPos() {\n\t\treturn [this.x, this.y];\n\t}\n\n\tidentifier() {\n\t\treturn this.objectID;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tgetHighlightIndex() {\n\t\treturn this.highlightIndex;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from \"./AnimatedObject.js\";\nimport { UndoBlock } from \"./UndoFunctions.js\";\n\nconst MIN_WIDTH = 10;\nconst EDGE_POINTER_DISPLACEMENT = 5;\n\nexport default class AnimatedBTreeNode extends AnimatedObject {\n\tconstructor(objectID, widthPerElement, h, numLabels, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = [];\n\t\tthis.labelColors = [];\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t}\n\t}\n\n\tgetNumElements() {\n\t\treturn this.numLabels;\n\t}\n\n\tgetWidth() {\n\t\tif (this.numLabels > 0) {\n\t\t\treturn this.widthPerElement * this.numLabels;\n\t\t} else {\n\t\t\treturn MIN_WIDTH;\n\t\t}\n\t}\n\n\tsetNumElements(newNumElements) {\n\t\tif (this.numLabels < newNumElements) {\n\t\t\tfor (let i = this.numLabels; i < newNumElements; i++) {\n\t\t\t\tthis.labels[i] = \"\";\n\t\t\t\tthis.labelColors[i] = this.foregroundColor;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t} else if (this.numLabels > newNumElements) {\n\t\t\tfor (let i = newNumElements; i < this.numLabels; i++) {\n\t\t\t\tthis.labels[i] = null;\n\t\t\t}\n\t\t\tthis.numLabels = newNumElements;\n\t\t}\n\t}\n\n\tleft() {\n\t\treturn this.x - this.getWidth() / 2.0;\n\t}\n\n\tright() {\n\t\treturn this.x + this.getWidth() / 2.0;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tdraw(context) {\n\t\tlet startX;\n\n\t\tstartX = this.left();\n\t\tif (isNaN(startX)) {\n\t\t\tstartX = 0;\n\t\t}\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = \"#FF0000\";\n\t\t\tcontext.fillStyle = \"#FF0000\";\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY - this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.getWidth() + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX - this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY);\n\t\tcontext.lineTo(startX + this.getWidth(), startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = \"center\";\n\t\tcontext.textBaseline = \"middle\";\n\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tconst labelX =\n\t\t\t\tthis.x -\n\t\t\t\t(this.widthPerElement * this.numLabels) / 2 +\n\t\t\t\tthis.widthPerElement / 2 +\n\t\t\t\ti * this.widthPerElement;\n\t\t\tconst labelY = this.y;\n\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], labelX, labelY);\n\t\t}\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tsetForegroundColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tthis.labelColor[i] = newColor;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.left() + EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else if (anchor === this.numLabels) {\n\t\t\treturn [this.right() - EDGE_POINTER_DISPLACEMENT, this.y];\n\t\t} else {\n\t\t\treturn [this.left() + anchor * this.widthPerElement, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromY < this.y - this.h / 2) {\n\t\t\treturn [this.x, this.y - this.h / 2];\n\t\t} else if (this.fromY > this.y + this.h / 2) {\n\t\t\treturn [this.x, this.y + this.h / 2];\n\t\t} else if (fromX < this.x - this.getWidth() / 2) {\n\t\t\treturn [this.x - this.getWidth() / 2, this.y];\n\t\t} else {\n\t\t\treturn [this.x + this.getWidth() / 2, this.y];\n\t\t}\n\t}\n\n\tgetTextColor(textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\treturn this.labelColors[textIndex];\n\t}\n\n\tgetText(index) {\n\t\tindex = index || 0;\n\t\treturn this.labels[index];\n\t}\n\n\tsetTextColor(color, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labelColors[textIndex] = color;\n\t}\n\n\tsetText(newText, textIndex) {\n\t\ttextIndex = textIndex || 0;\n\t\tthis.labels[textIndex] = newText;\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.numLabels,\n\t\t\tthis.labels,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.labelColors,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteBTreeNode extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tnumLabels,\n\t\tlabels,\n\t\tx,\n\t\ty,\n\t\twidthPerElement,\n\t\th,\n\t\tlabelColors,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.numLabels = numLabels;\n\t\tthis.labels = labels;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.widthPerElement = widthPerElement;\n\t\tthis.h = h;\n\t\tthis.labelColors = labelColors;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addBTreeNode(\n\t\t\tthis.objectID,\n\t\t\tthis.widthPerElement,\n\t\t\tthis.h,\n\t\t\tthis.numLabels,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tfor (let i = 0; i < this.numLabels; i++) {\n\t\t\tworld.setText(this.objectID, this.labels[i], i);\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject';\nimport { UndoBlock } from './UndoFunctions';\n\nexport default class AnimatedCircle extends AnimatedObject {\n\tconstructor(objectID, label) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.label = label;\n\n\t\tthis.radius = 20;\n\t\tthis.thickness = 3;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getHeadPointerAttachPos(fromX, fromY);\n\t}\n\n\tgetWidth() {\n\t\treturn this.radius * 2;\n\t}\n\n\tsetWidth(newWidth) {\n\t\tthis.radius = newWidth / 2;\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst xVec = fromX - this.x;\n\t\tconst yVec = fromY - this.y;\n\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\t\tif (len === 0) return [this.x, this.y];\n\t\treturn [this.x + (xVec / len) * this.radius, this.y + (yVec / len) * this.radius];\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\tthis.highlightIndex = hlIndex;\n\t\tthis.highlightIndexDirty = true;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.fillStyle = this.highlightColor;\n\t\t\tcontext.beginPath();\n\t\t\tcontext.arc(this.x, this.y, this.radius + this.highlightDiff, 0, Math.PI * 2, true);\n\t\t\tcontext.closePath();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\tcontext.fillStyle = this.backgroundColor;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = 1.2;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.fill();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillStyle = this.foregroundColor;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\t\tthis.leftWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(0, this.highlightIndex)\n\t\t\t\t).width;\n\t\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1)\n\t\t\t\t).width;\n\t\t\t\tthis.textWidth = context.measureText(this.label).width;\n\t\t\t\tthis.highlightIndexDirty = false;\n\t\t\t}\n\t\t\tif (this.highlightIndex !== -1 && this.highlightIndex < this.label.length) {\n\t\t\t\tconst startingXForHighlight = this.x - this.textWidth / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t}\n\t\t} else if (strList.length % 2 === 0) {\n\t\t\tconst mid = strList.length / 2;\n\t\t\tfor (let i = 0; i < strList.length / 2; i++) {\n\t\t\t\tcontext.fillText(strList[mid - i - 1], this.x, this.y - (i + 0.5) * 12);\n\t\t\t\tcontext.fillText(strList[mid + i], this.x, this.y + (i + 0.5) * 12);\n\t\t\t}\n\t\t} else {\n\t\t\tconst mid = (strList.length - 1) / 2;\n\t\t\tcontext.fillText(strList[mid], this.x, this.y);\n\t\t\tfor (let i = 0; i < mid; i++) {\n\t\t\t\tcontext.fillText(strList[mid - (i + 1)], this.x, this.y - (i + 1) * 12);\n\t\t\t\tcontext.fillText(strList[mid + (i + 1)], this.x, this.y + (i + 1) * 12);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.radius,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircle extends UndoBlock {\n\tconstructor(objectID, label, x, y, foregroundColor, backgroundColor, layer, radius, highlighted, highlightColor) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.layer = layer;\n\t\tthis.radius = radius;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircleObject(this.objectID, this.label);\n\t\tworld.setWidth(this.objectID, this.radius * 2);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.foregroundColor);\n\t\tworld.setBackgroundColor(this.objectID, this.backgroundColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from \"./AnimatedObject.js\";\nimport { UndoBlock } from \"./UndoFunctions.js\";\n\nexport default class AnimatedCircularlyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosX = this.x;\n\t\tthis.labelPosY = this.y;\n\t}\n\n\tgetTailPointerAttachPos() {\n\t\treturn [this.x + this.w / 2.0, this.y];\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tif (fromX < this.x) {\n\t\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t\t} else {\n\t\t\treturn [this.x, this.bottom()]; // Curved pointer coming from the right, connect to bottom\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = \"#FF0000\";\n\t\t\tcontext.fillStyle = \"#FF0000\";\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.lineWidth = 1;\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nullPointer) {\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\tcontext.textAlign = \"center\";\n\t\tcontext.font = \"12px Arial\";\n\t\tcontext.textBaseline = \"middle\";\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteCircularlyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteCircularlyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addCircularlyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedDoublyLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, linkPercent, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.prevNullPointer = false;\n\t\tthis.nextNullPointer = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tsetPrevNull(np) {\n\t\tif (this.prevNullPointer !== np) {\n\t\t\tthis.prevNullPointer = np;\n\t\t}\n\t}\n\n\tsetNextNull(np) {\n\t\tif (this.nextNullPointer !== np) {\n\t\t\tthis.nextNullPointer = np;\n\t\t}\n\t}\n\n\tgetLeftNull() {\n\t\treturn this.prevNullPointer;\n\t}\n\n\tgetRightNull() {\n\t\treturn this.nextNullPointer;\n\t}\n\n\tleft() {\n\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2.0;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2.0;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.left() + this.w * (this.linkPercent * 2);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (anchor === 0) {\n\t\t\treturn [this.x + this.w / 2.0, this.y - this.h * 0.2];\n\t\t} else {\n\t\t\treturn [this.left() + (this.w * this.linkPercent) / 2, this.y + this.h * 0.2];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\tconst closest = this.getClosestCardinalPoint(fromX, fromY);\n\t\tif (closest[1] === this.y) {\n\t\t\tif (closest[0] === this.left()) {\n\t\t\t\treturn [closest[0], this.y - this.h * 0.2];\n\t\t\t} else {\n\t\t\t\treturn [closest[0], this.y + this.h * 0.2];\n\t\t\t}\n\t\t} else {\n\t\t\treturn [closest[0], closest[1]];\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\t// Highlighted edges\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\tcontext.fillStyle = '#FF0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\n\t\t// Node edges\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.lineWidth = 1;\n\t\t// Left inner line between node and pointer area\n\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.prevNullPointer) {\n\t\t\t// Left null marker\n\t\t\tcontext.moveTo(this.left(), startY);\n\t\t\tcontext.lineTo(this.left() + this.w * this.linkPercent, startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Right inner line between node and pointer area\n\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\tstartY = this.top();\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tif (this.nextNullPointer) {\n\t\t\t// Right null marker\n\t\t\tcontext.moveTo(this.right() - this.w * this.linkPercent, startY);\n\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t}\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\n\t\t// Label\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColors = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColors;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteDoublyLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.prevNullPointer,\n\t\t\tthis.nextNullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n\n}\n\nclass UndoDeleteDoublyLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColor,\n\t\tlayer,\n\t\tpnp,\n\t\tnnp,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.prevNullPointer = pnp;\n\t\tthis.nextNullPointer = nnp;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addDoublyLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setPrevNull(this.objectID, this.prevNullPointer);\n\t\tworld.setNextNull(this.objectID, this.nextNullPointer);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// \"Class\" animatedCircle\n\nimport AnimatedObject from \"./AnimatedObject.js\";\nimport { UndoBlock } from \"./UndoFunctions.js\";\n\nexport default class AnimatedHighlightCircle extends AnimatedObject {\n\tconstructor(objectID, foregroundColor, radius) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.radius = radius;\n\t\tthis.thickness = 4;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.lineWidth = this.thickness;\n\t\tcontext.beginPath();\n\t\tcontext.arc(this.x, this.y, this.radius, 0, Math.PI * 2, true);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteHighlightCircle(\n\t\t\tthis.objectID,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.radius,\n\t\t\tthis.layer,\n\t\t\tthis.alpha,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteHighlightCircle extends UndoBlock {\n\tconstructor(objectID, x, y, foregroundColor, radius, layer, alpha, highlighted, highlightColor) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.radius = radius;\n\t\tthis.layer = layer;\n\t\tthis.alpha = alpha;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addHighlightCircleObject(this.objectID, this.foregroundColor, this.radius);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setAlpha(this.objectID, this.alpha);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedLabel extends AnimatedObject {\n\tconstructor(objectID, label, centered, initialWidth) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.textWidth = initialWidth || 0;\n\n\t\tthis.label = label;\n\t\tthis.labelColor = '#000000';\n\t\tthis.highlighted = false;\n\t\tthis.centered = centered;\n\n\t\tthis.leftWidth = -1;\n\t\tthis.centerWidth = -1;\n\t\tthis.highlightIndex = -1;\n\t}\n\n\tcentered() {\n\t\treturn this.centered;\n\t}\n\n\tdraw(context) {\n\t\tif(!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.font = '12px Arial';\n\n\t\tlet startingXForHighlight = this.x;\n\n\t\tif (this.highlightIndex >= this.label.length) {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t\tif (this.highlightIndexDirty && this.highlightIndex !== -1) {\n\t\t\tthis.leftWidth = context.measureText(this.label.substring(0, this.highlightIndex)).width;\n\t\t\tthis.centerWidth = context.measureText(\n\t\t\t\tthis.label.substring(this.highlightIndex, this.highlightIndex + 1)\n\t\t\t).width;\n\t\t\tthis.highlightIndexDirty = false;\n\t\t}\n\n\t\tif (this.centered) {\n\t\t\tif (this.highlightIndex !== -1) {\n\t\t\t\tstartingXForHighlight = this.x - this.width / 2;\n\t\t\t\tcontext.textAlign = 'left';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t} else {\n\t\t\t\tcontext.textAlign = 'center';\n\t\t\t\tcontext.textBaseline = 'middle';\n\t\t\t}\n\t\t} else {\n\t\t\tcontext.textAlign = 'left';\n\t\t\tcontext.textBaseline = 'top';\n\t\t}\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#FFAAAA';\n\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\tcontext.lineWidth = this.highlightDiff;\n\t\t\tcontext.strokeText(this.label, this.x, this.y);\n\t\t}\n\t\tcontext.strokeStyle = this.labelColor;\n\t\tcontext.fillStyle = this.labelColor;\n\t\tcontext.lineWidth = 2;\n\t\tconst strList = this.label.split('\\n');\n\t\tif (strList.length === 1) {\n\t\t\tif (this.highlightIndex === -1) {\n\t\t\t\tcontext.fillText(this.label, this.x, this.y);\n\t\t\t} else {\n\t\t\t\tconst leftStr = this.label.substring(0, this.highlightIndex);\n\t\t\t\tconst highlightStr = this.label.substring(\n\t\t\t\t\tthis.highlightIndex,\n\t\t\t\t\tthis.highlightIndex + 1\n\t\t\t\t);\n\t\t\t\tconst rightStr = this.label.substring(this.highlightIndex + 1);\n\t\t\t\tcontext.fillText(leftStr, startingXForHighlight, this.y);\n\t\t\t\tcontext.strokeStyle = '#FF0000';\n\t\t\t\tcontext.fillStyle = '#FF0000';\n\t\t\t\tcontext.fillText(highlightStr, startingXForHighlight + this.leftWidth, this.y);\n\n\t\t\t\tcontext.strokeStyle = this.labelColor;\n\t\t\t\tcontext.fillStyle = this.labelColor;\n\t\t\t\tcontext.fillText(\n\t\t\t\t\trightStr,\n\t\t\t\t\tstartingXForHighlight + this.leftWidth + this.centerWidth,\n\t\t\t\t\tthis.y\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tconst offset = this.centered ? (1.0 - strList.length) / 2.0 : 0;\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\tcontext.fillText(strList[i], this.x, this.y + offset + i * 12);\n\t\t\t}\n\t\t}\n\t\tcontext.closePath();\n\t}\n\n\tgetAlignLeftPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.left() - this.textWidth / 2, (this.y = otherObject.centerY())];\n\t\t} else {\n\t\t\treturn [otherObject.left() - this.textWidth, otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignLeft(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.left() - this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.left() - this.textWidth;\n\t\t}\n\t}\n\n\talignRight(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.centerY();\n\t\t\tthis.x = otherObject.right() + this.textWidth / 2;\n\t\t} else {\n\t\t\tthis.y = otherObject.centerY() - 5;\n\t\t\tthis.x = otherObject.right();\n\t\t}\n\t}\n\n\tgetAlignRightPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.right() + this.textWidth / 2, otherObject.centerY()];\n\t\t} else {\n\t\t\treturn [otherObject.right(), otherObject.centerY() - 5];\n\t\t}\n\t}\n\n\talignTop(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.top() - 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.top() - 10;\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignTopPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.top() - 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.top() - 10];\n\t\t}\n\t}\n\n\talignBottom(otherObject) {\n\t\tif (this.centered) {\n\t\t\tthis.y = otherObject.bottom() + 5;\n\t\t\tthis.x = otherObject.centerX();\n\t\t} else {\n\t\t\tthis.y = otherObject.bottom();\n\t\t\tthis.x = otherObject.centerX() - this.textWidth / 2;\n\t\t}\n\t}\n\n\tgetAlignBottomPos(otherObject) {\n\t\tif (this.centered) {\n\t\t\treturn [otherObject.centerX(), otherObject.bottom() + 5];\n\t\t} else {\n\t\t\treturn [otherObject.centerX() - this.textWidth / 2, otherObject.bottom()];\n\t\t}\n\t}\n\n\tgetWidth() {\n\t\treturn this.textWidth;\n\t}\n\n\tgetHeight() {\n\t\treturn 10; // HACK!  HACK!  HACK!  HACK!\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tcenterX() {\n\t\tif (this.centered) {\n\t\t\treturn this.x;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.centered) {\n\t\t\treturn this.y;\n\t\t} else {\n\t\t\treturn this.y + 5;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.centered) {\n\t\t\treturn this.y - 5; //TODO: Un-Hardwire\n\t\t} else {\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.centered) {\n\t\t\treturn this.y + 5; // TODO: + height / 2;\n\t\t} else {\n\t\t\treturn this.y + 10; // TODO: + hieght;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.centered) {\n\t\t\treturn this.x + this.textWidth / 2; // TODO: + width / 2;\n\t\t} else {\n\t\t\treturn this.x + this.textWidth; // TODO: + width;\n\t\t}\n\t}\n\n\tleft() {\n\t\tif (this.centered) {\n\t\t\treturn this.x - this.textWidth / 2;\n\t\t} else {\n\t\t\treturn this.x; // TODO:  - a little?\n\t\t}\n\t}\n\n\tsetHighlightIndex(hlIndex) {\n\t\t// Only allow highlight index for labels that don't have End-Of-Line\n\t\tif (this.label.indexOf('\\n') === -1 && this.label.length > hlIndex) {\n\t\t\tthis.highlightIndex = hlIndex;\n\t\t\tthis.highlightIndexDirty = true;\n\t\t} else {\n\t\t\tthis.highlightIndex = -1;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetText(newText, textIndex, initialWidth) {\n\t\tthis.label = newText;\n\t\tif (initialWidth != null) {\n\t\t\tthis.textWidth = initialWidth;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLabel(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.centered,\n\t\t\tthis.labelColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlightIndex,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteLabel extends UndoBlock {\n\tconstructor(objectID, label, x, y, centered, labelColor, layer, highlightIndex, highlighted, highlightColor) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.centered = centered;\n\t\tthis.labelColor = labelColor;\n\t\tthis.layer = layer;\n\t\tthis.highlightIndex = highlightIndex;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLabelObject(this.objectID, this.label, this.centered);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setForegroundColor(this.objectID, this.labelColor);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n\n// This class handles links between vertices in graphs, pointers in linked lists, and so on.\n\nconst LINE_MAX_HEIGHT_DIFF = 5;\nconst LINE_MIN_HEIGHT_DIFF = 3;\nconst LINE_RANGE = LINE_MAX_HEIGHT_DIFF - LINE_MIN_HEIGHT_DIFF + 1;\n\nexport default class AnimatedLine {\n\tconstructor(fromID, toID, color, curve, directed, edgeLabel, anchorPoint) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\n\t\tthis.foregroundColor = color;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.highlighted = false;\n\t\tthis.highlightDiff = 0;\n\n\t\tthis.dirty = false;\n\t\tthis.directed = directed;\n\t\tthis.anchorPoint = anchorPoint;\n\n\t\tthis.alpha = 1.0;\n\t\tthis.arrowHeight = 8;\n\t\tthis.arrowWidth = 4;\n\t\tthis.curve = curve;\n\t}\n\n\tcolor() {\n\t\treturn this.foregroundColor;\n\t}\n\n\tsetColor(newColor) {\n\t\tthis.foregroundColor = newColor;\n\t\tthis.dirty = true;\n\t}\n\n\tsetHighlight(highlightVal) {\n\t\tthis.highlighted = highlightVal;\n\t}\n\n\tpulseHighlight(frameNum) {\n\t\tif (this.highlighted) {\n\t\t\tconst frameMod = frameNum / 14.0;\n\t\t\tconst delta = Math.abs((frameMod % (2 * LINE_RANGE - 2)) - LINE_RANGE + 1);\n\t\t\tthis.highlightDiff = delta + LINE_MIN_HEIGHT_DIFF;\n\t\t\tthis.dirty = true;\n\t\t}\n\t}\n\n\thasNode(n) {\n\t\treturn this.fromID === n || this.toID === n;\n\t}\n\n\tsign(n) {\n\t\tif (n > 0) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tdrawArrow(penSize, color, context) {\n\t\tcontext.strokeStyle = color;\n\t\tcontext.fillStyle = color;\n\t\tcontext.lineWidth = penSize;\n\n\t\tconst fromPos = this.fromID.getTailPointerAttachPos(\n\t\t\tthis.toID.x,\n\t\t\tthis.toID.y,\n\t\t\tthis.anchorPoint\n\t\t);\n\t\tconst toPos = this.toID.getHeadPointerAttachPos(this.fromID.x, this.fromID.y);\n\n\t\tconst deltaX = toPos[0] - fromPos[0];\n\t\tconst deltaY = toPos[1] - fromPos[1];\n\t\tconst midX = deltaX / 2.0 + fromPos[0];\n\t\tconst midY = deltaY / 2.0 + fromPos[1];\n\t\tconst controlX = midX - deltaY * this.curve;\n\n\t\tconst controlY = midY + deltaX * this.curve;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(fromPos[0], fromPos[1]);\n\t\tcontext.quadraticCurveTo(controlX, controlY, toPos[0], toPos[1]);\n\t\tcontext.stroke();\n\n\t\t// Position of the edge label:  First, we will place it right along the\n\t\t// middle of the curve (or the middle of the line, for curve == 0)\n\t\tlet labelPosX = 0.25 * fromPos[0] + 0.5 * controlX + 0.25 * toPos[0];\n\t\tlet labelPosY = 0.25 * fromPos[1] + 0.5 * controlY + 0.25 * toPos[1];\n\n\t\t// Next, we push the edge position label out just a little in the direction of\n\t\t// the curve, so that the label doesn't intersect the cuve (as long as the label\n\t\t// is only a few characters, that is)\n\t\tconst midLen = Math.sqrt(deltaY * deltaY + deltaX * deltaX);\n\t\tif (midLen !== 0) {\n\t\t\tlabelPosX += ((-deltaY * this.sign(this.curve)) / midLen) * 10;\n\t\t\tlabelPosY += ((deltaX * this.sign(this.curve)) / midLen) * 10;\n\t\t}\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.fillText(this.edgeLabel, labelPosX, labelPosY);\n\n\t\tif (this.directed) {\n\t\t\tlet xVec = controlX - toPos[0];\n\t\t\tlet yVec = controlY - toPos[1];\n\t\t\tconst len = Math.sqrt(xVec * xVec + yVec * yVec);\n\n\t\t\tif (len > 0) {\n\t\t\t\txVec = xVec / len;\n\t\t\t\tyVec = yVec / len;\n\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight - yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight + xVec * this.arrowWidth\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(\n\t\t\t\t\ttoPos[0] + xVec * this.arrowHeight + yVec * this.arrowWidth,\n\t\t\t\t\ttoPos[1] + yVec * this.arrowHeight - xVec * this.arrowWidth\n\t\t\t\t);\n\t\t\t\tcontext.lineTo(toPos[0], toPos[1]);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t\tcontext.fill();\n\t\t\t}\n\t\t}\n\t}\n\n\tdraw(context) {\n\t\tcontext.globalAlpha = this.alpha;\n\n\t\tif (this.highlighted) this.drawArrow(this.highlightDiff, '#FF0000', context);\n\t\tthis.drawArrow(1, this.foregroundColor, context);\n\t}\n\n\tcreateUndoConnect() {\n\t\treturn new UndoConnect(\n\t\t\tthis.fromID.objectID,\n\t\t\tthis.toID.objectID,\n\t\t\ttrue,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.curve,\n\t\t\tthis.directed,\n\t\t\tthis.edgeLabel,\n\t\t\tthis.anchorPoint,\n\t\t\tthis.highlighted\n\t\t);\n\t}\n}\n\nexport class UndoConnect {\n\tconstructor(fromID, toID, createConnection, color, curve, directed, edgeLabel, anchorPoint) {\n\t\tthis.fromID = fromID;\n\t\tthis.toID = toID;\n\t\tthis.createConnection = createConnection;\n\t\tthis.color = color;\n\t\tthis.curve = curve;\n\t\tthis.directed = directed;\n\t\tthis.edgeLabel = edgeLabel;\n\t\tthis.anchorPoint = anchorPoint;\n\t}\n\n\tundoInitialStep(world) {\n\t\tif (this.createConnection) {\n\t\t\tworld.connectEdge(\n\t\t\t\tthis.fromID,\n\t\t\t\tthis.toID,\n\t\t\t\tthis.color,\n\t\t\t\tthis.curve,\n\t\t\t\tthis.directed,\n\t\t\t\tthis.edgeLabel,\n\t\t\t\tthis.anchorPoint\n\t\t\t);\n\t\t} else {\n\t\t\tworld.disconnect(this.fromID, this.toID);\n\t\t}\n\t}\n\n\taddUndoAnimation() {\n\t\treturn false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from \"./AnimatedObject.js\";\nimport { UndoBlock } from \"./UndoFunctions.js\";\n\nexport default class AnimatedLinkedListNode extends AnimatedObject {\n\tconstructor(objectID, labels, w, h, linkPercent, vertical, linkPosEnd, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.nullPointer = false;\n\n\t\tthis.labels = labels;\n\t\tthis.labelPosX = [0];\n\t\tthis.labelPosY = [0];\n\t\tthis.labelColors = [foregroundColor];\n\t}\n\n\tleft() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x - (this.w * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.x - (this.w * (this.linkPercent + 1)) / 2;\n\t\t}\n\t}\n\n\tsetNull(np) {\n\t\tif (this.nullPointer !== np) {\n\t\t\tthis.nullPointer = np;\n\t\t}\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tright() {\n\t\tif (this.vertical) {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.x + (this.w * (this.linkPercent + 1)) / 2;\n\t\t} else {\n\t\t\treturn this.x + (this.w * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y - (this.h * (1 - this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y - (this.h * (1 + this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (!this.vertical) {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else if (this.linkPosEnd) {\n\t\t\treturn this.y + (this.h * (1 + this.linkPercent)) / 2;\n\t\t} else {\n\t\t\treturn this.y + (this.h * (1 - this.linkPercent)) / 2;\n\t\t}\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x, this.y + this.h / 2.0];\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\treturn [this.x, this.y - this.h / 2.0];\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\treturn [this.x + this.w / 2.0, this.y];\n\t\t} else { // !this.vertical && !this.linkPosEnd\n\t\t\treturn [this.x - this.w / 2.0, this.y];\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tstartX = this.left();\n\t\tstartY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = \"#ff0000\";\n\t\t\tcontext.fillStyle = \"#ff0000\";\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tif (this.vertical) {\n\t\t\tstartX = this.left();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartY = this.y + this.h * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX ,startY);\n\t\t\t\tcontext.lineTo(startX + this.w, startY);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t} else {\n\t\t\tstartY = this.top();\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tstartX = this.x + this.w * (1 - this.linkPercent) * (i / this.labels.length - 0.5);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(startX ,startY);\n\t\t\t\tcontext.lineTo(startX, startY + this.h);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t}\n\n\t\tcontext.lineWidth = 1;\n\t\tif (this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.bottom() - this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.startX + this.w, this.bottom());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (this.vertical && !this.linkPosEnd) {\n\t\t\tstartX = this.left();\n\t\t\tstartY = this.top() + this.h * this.linkPercent;\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX + this.w, startY);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(startX + this.w, this.top());\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else if (!this.vertical && this.linkPosEnd) {\n\t\t\tstartX = this.right() - this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.right(), startY + this.h);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t} else { // !vertical && !linkPosEnd\n\t\t\tstartX = this.left() + this.w * this.linkPercent;\n\t\t\tstartY = this.top();\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY + this.h);\n\t\t\tcontext.lineTo(startX, startY);\n\t\t\tif (this.nullPointer) {\n\t\t\t\tcontext.lineTo(this.left(), startY);\n\t\t\t}\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.textAlign = \"center\";\n\t\tcontext.font = \"12px Arial\";\n\t\tcontext.textBaseline = \"middle\";\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.vertical) {\n\t\t\tthis.labelPosX[0] = this.x;\n\t\t\tthis.labelPosY[0] = this.y + this.h * (1 - this.linkPercent) / 2 * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosX[i] = this.x;\n\t\t\t\tthis.labelPosY[i] = this.labelPosY[i-1] + this.h * (1 - this.linkPercent) / this.labels.length;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.labelPosY[0] = this.y;\n\t\t\tthis.labelPosX[0] = this.x + this.w * (1 - this.linkPercent) / 2 * (1 / this.labels.length - 1);\n\t\t\tfor (let i = 1; i < this.labels.length; i++) {\n\t\t\t\tthis.labelPosY[i] = this.y;\n\t\t\t\tthis.labelPosX[i] = this.labelPosX[i-1] + this.w * (1 - this.linkPercent) / this.labels.length;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tcontext.fillStyle = this.labelColors[i];\n\t\t\tcontext.fillText(this.labels[i], this.labelPosX[i], this.labelPosY[i]); \n\t\t}\n\t}\n\n\tsetTextColor(color, index) {\n\t\tthis.labelColors[index] = color;\n\t}\n\n\tgetTextColor(index) {\n\t\treturn this.labelColors[index];\n\t}\n\n\tgetText(index) {\n\t\treturn this.labels[index];\n\t}\n\n\tsetText(newText, index) {\n\t\tthis.labels[index] = newText;\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteLinkedList(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.labelColors,\n\t\t\tthis.layer,\n\t\t\tthis.nullPointer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteLinkedList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabels,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlinkPercent,\n\t\tvertical,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlabelColors,\n\t\tlayer,\n\t\tnullPointer,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.labels = labels;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.linkPercent = linkPercent;\n\t\tthis.vertical = vertical;\n\t\tthis.linkPosEnd = linkPosEnd;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.labelColors = labelColors;\n\t\tthis.layer = layer;\n\t\tthis.nullPointer = nullPointer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addLinkedListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.labels,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.linkPercent,\n\t\t\tthis.vertical,\n\t\t\tthis.linkPosEnd,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setNull(this.objectID, this.nullPointer);\n\t\tfor (let i = 0; i < this.labels.length; i++) {\n\t\t\tworld.setTextColor(this.objectID, this.labelColors[i], i);\n\t\t}\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.a\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Values for xJust / yJust:  \"center\", \"left\", \"right\", \"top\", \"bottom\"\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nexport default class AnimatedRectangle extends AnimatedObject {\n\tconstructor(objectID, label, w, h, xJustify, yJustify, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.label = label;\n\n\t\tthis.nullPointer = false;\n\t}\n\n\tsetNull(np) {\n\t\tthis.nullPointer = np;\n\t}\n\n\tgetNull() {\n\t\treturn this.nullPointer;\n\t}\n\n\tleft() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x - this.w / 2.0;\n\t\t} else { // right\n\t\t\treturn this.x - this.w;\n\t\t}\n\t}\n\n\tcenterX() {\n\t\tif (this.xJustify === 'center') {\n\t\t\treturn this.x;\n\t\t} else if (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else { // right\n\t\t\treturn this.x - this.w / 2.0;\n\t\t}\n\t}\n\n\tcenterY() {\n\t\tif (this.yJustify === 'center') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else { // bottom\n\t\t\treturn this.y - this.w / 2.0;\n\t\t}\n\t}\n\n\ttop() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y - this.h / 2.0;\n\t\t} else { // bottom\n\t\t\treturn this.y - this.h;\n\t\t}\n\t}\n\n\tbottom() {\n\t\tif (this.yJustify === 'top') {\n\t\t\treturn this.y + this.h;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\treturn this.y + this.h / 2.0;\n\t\t} else { // bottom\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tright() {\n\t\tif (this.xJustify === 'left') {\n\t\t\treturn this.x + this.w;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\treturn this.x + this.w / 2.0;\n\t\t} else { // right\n\t\t\treturn this.x;\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Default\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t\tcase 1: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 2: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 3: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 4: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tif(!this.addedToScene) return;\n\n\t\tcontext.globalAlpha = this.alpha;\n\t\tcontext.lineWidth = 2;\n\n\t\tlet startX;\n\t\tlet startY;\n\n\t\tif (this.xJustify === 'left') {\n\t\t\tstartX = this.x;\n\t\t} else if (this.xJustify === 'center') {\n\t\t\tstartX = this.x - this.w / 2.0;\n\t\t} else if (this.xJustify === 'right') {\n\t\t\tstartX = this.x - this.w;\n\t\t}\n\t\tif (this.yJustify === 'top') {\n\t\t\tstartY = this.y;\n\t\t} else if (this.yJustify === 'center') {\n\t\t\tstartY = this.y - this.h / 2.0;\n\t\t} else if (this.yJustify === 'bottom') {\n\t\t\tstartY = this.y - this.h;\n\t\t}\n\n\t\tcontext.lineWidth = 2;\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.lineWidth = 1.2;\n\t\tif (this.nullPointer) {\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX, startY);\n\t\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t}\n\n\t\tcontext.fillStyle = this.foregroundColor;\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\t\tcontext.fillText(this.label, this.x, this.y);\n\t}\n\n\tsetText(newText, textIndex) {\n\t\tthis.label = newText;\n\t\t// TODO:  setting text position?\n\t}\n\n\tsetHighlight(value) {\n\t\tthis.highlighted = value;\n\t}\n\n\tcreateUndoDelete() {\n\t\t// TODO: Add color?\n\t\treturn new UndoDeleteRectangle(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteRectangle extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tx,\n\t\ty,\n\t\tw,\n\t\th,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.xJustify = xJustify;\n\t\tthis.yJustify = yJustify;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addRectangleObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.xJustify,\n\t\t\tthis.yJustify,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport AnimatedObject from './AnimatedObject.js';\nimport { UndoBlock } from './UndoFunctions.js';\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class AnimatedSkipListNode extends AnimatedObject {\n\tconstructor(objectID, label, w, h, backgroundColor, foregroundColor) {\n\t\tsuper();\n\n\t\tthis.objectID = objectID;\n\n\t\tthis.w = w;\n\t\tthis.h = h;\n\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.highlighted = false;\n\n\t\tthis.label = label;\n\t\tthis.labelPosX = 0;\n\t\tthis.labelPosY = 0;\n\t\tthis.labelColor = foregroundColor;\n\t}\n\n\tleft() {\n\t\treturn this.x - this.w / 2;\n\t}\n\n\tright() {\n\t\treturn this.x + this.w / 2;\n\t}\n\n\ttop() {\n\t\treturn this.y - this.h / 2;\n\t}\n\n\tbottom() {\n\t\treturn this.y + this.h / 2;\n\t}\n\n\tresetTextPosition() {\n\t\tthis.labelPosY = this.y;\n\t\tthis.labelPosX = this.x;\n\t}\n\n\tgetTailPointerAttachPos(fromX, fromY, anchor) {\n\t\tswitch (anchor) {\n\t\t\tcase 0: // Top\n\t\t\t\treturn [this.x, this.top()];\n\t\t\tcase 1: // Bottom\n\t\t\t\treturn [this.x, this.bottom()];\n\t\t\tcase 2: // Left\n\t\t\t\treturn [this.left(), this.y];\n\t\t\tcase 3: // Right\n\t\t\t\treturn [this.right(), this.y];\n\t\t\tdefault:\n\t\t\t\treturn this.getClosestCardinalPoint(fromX, fromY);\n\t\t}\n\t}\n\n\tgetHeadPointerAttachPos(fromX, fromY) {\n\t\treturn this.getClosestCardinalPoint(fromX, fromY); // Normal anchor\n\t}\n\n\tsetWidth(w) {\n\t\tthis.w = w;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHeight(h) {\n\t\tthis.h = h;\n\t\tthis.resetTextPosition();\n\t}\n\n\tgetWidth() {\n\t\treturn this.w;\n\t}\n\n\tgetHeight() {\n\t\treturn this.h;\n\t}\n\n\tdraw(context) {\n\t\tconst startX = this.left();\n\t\tconst startY = this.top();\n\n\t\tif (this.highlighted) {\n\t\t\tcontext.strokeStyle = '#ff0000';\n\t\t\tcontext.fillStyle = '#ff0000';\n\n\t\t\tcontext.beginPath();\n\t\t\tcontext.moveTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(startX + this.w + this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.lineTo(\n\t\t\t\tstartX + this.w + this.highlightDiff,\n\t\t\t\tstartY + this.h + this.highlightDiff\n\t\t\t);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY + this.h + this.highlightDiff);\n\t\t\tcontext.lineTo(startX - this.highlightDiff, startY - this.highlightDiff);\n\t\t\tcontext.closePath();\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t}\n\t\tcontext.strokeStyle = this.foregroundColor;\n\t\tcontext.fillStyle = this.backgroundColor;\n\n\t\tcontext.beginPath();\n\t\tcontext.moveTo(startX, startY);\n\t\tcontext.lineTo(startX + this.w, startY);\n\t\tcontext.lineTo(startX + this.w, startY + this.h);\n\t\tcontext.lineTo(startX, startY + this.h);\n\t\tcontext.lineTo(startX, startY);\n\t\tcontext.closePath();\n\t\tcontext.stroke();\n\t\tcontext.fill();\n\n\t\tcontext.textAlign = 'center';\n\t\tcontext.font = '12px Arial';\n\t\tcontext.textBaseline = 'middle';\n\t\tcontext.lineWidth = 2;\n\n\t\tthis.resetTextPosition();\n\t\tcontext.fillStyle = this.labelColor;\n\t\tif (this.label === NINF || this.label === PINF) {\n\t\t\tcontext.font = '18px sans-serif';\n\t\t}\n\t\tcontext.fillText(this.label, this.labelPosX, this.labelPosY);\n\t}\n\n\tsetTextColor(color) {\n\t\tthis.labelColor = color;\n\t}\n\n\tgetTextColor() {\n\t\treturn this.labelColor;\n\t}\n\n\tgetText() {\n\t\treturn this.label;\n\t}\n\n\tsetText(newText) {\n\t\tthis.label = newText;\n\t\tthis.resetTextPosition();\n\t}\n\n\tsetHighlight(value) {\n\t\tif (value !== this.highlighted) {\n\t\t\tthis.highlighted = value;\n\t\t}\n\t}\n\n\tcreateUndoDelete() {\n\t\treturn new UndoDeleteSkipList(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.labelColor,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor,\n\t\t\tthis.layer,\n\t\t\tthis.highlighted,\n\t\t\tthis.highlightColor\n\t\t);\n\t}\n}\n\nclass UndoDeleteSkipList extends UndoBlock {\n\tconstructor(\n\t\tobjectID,\n\t\tlabel,\n\t\tw,\n\t\th,\n\t\tx,\n\t\ty,\n\t\tlabelColor,\n\t\tbackgroundColor,\n\t\tforegroundColor,\n\t\tlayer,\n\t\thighlighted,\n\t\thighlightColor\n\t) {\n\t\tsuper();\n\t\tthis.objectID = objectID;\n\t\tthis.label = label;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.labelColor = labelColor;\n\t\tthis.backgroundColor = backgroundColor;\n\t\tthis.foregroundColor = foregroundColor;\n\t\tthis.layer = layer;\n\t\tthis.highlighted = highlighted;\n\t\tthis.highlightColor = highlightColor;\n\t}\n\n\tundoInitialStep(world) {\n\t\tworld.addSkipListObject(\n\t\t\tthis.objectID,\n\t\t\tthis.label,\n\t\t\tthis.w,\n\t\t\tthis.h,\n\t\t\tthis.backgroundColor,\n\t\t\tthis.foregroundColor\n\t\t);\n\t\tworld.setTextColor(this.objectID, this.labelColor);\n\t\tworld.setNodePosition(this.objectID, this.x, this.y);\n\t\tworld.setLayer(this.objectID, this.layer);\n\t\tworld.setHighlight(this.objectID, this.highlighted, this.highlightColor);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n\n// Object Manager\n//\n// Manage all of our animated objects.  Control any animated object should occur through\n// this interface (not language enforced, because enforcing such things in Javascript is\n// problematic.)\n//\n// This class is only accessed through:\n//\n//  AnimationMain\n//  Undo objects (which are themselves controlled by AnimationMain)\n\nimport AnimatedBTreeNode from './AnimatedBTreeNode';\nimport AnimatedCircle from './AnimatedCircle';\nimport AnimatedCircularlyLinkedListNode from './AnimatedCircularlyLinkedListNode';\nimport AnimatedDoublyLinkedListNode from './AnimatedDoublyLinkedListNode';\nimport AnimatedHighlightCircle from './AnimatedHighlightCircle';\nimport AnimatedLabel from './AnimatedLabel';\nimport AnimatedLine from './AnimatedLine';\nimport AnimatedLinkedListNode from './AnimatedLinkedListNode';\nimport AnimatedRectangle from './AnimatedRectangle';\nimport AnimatedSkipListNode from './AnimatedSkipListNode';\n\nexport default class ObjectManager {\n\tconstructor(canvasRef) {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t\tthis.activeLayers = [];\n\t\tthis.activeLayers[0] = true;\n\t\tthis.ctx = canvasRef.current.getContext('2d');\n\t\tthis.framenum = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.statusReport = new AnimatedLabel(-1, 'XXX', false, 30);\n\t\tthis.statusReport.x = 30;\n\t}\n\n\tdraw() {\n\t\tthis.framenum++;\n\t\tif (this.framenum > 1000) this.framenum = 0;\n\n\t\tthis.ctx.clearRect(0, 0, this.width, this.height); // clear canvas\n\t\tthis.statusReport.y = this.height - 15;\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\t!this.nodes[i].highlighted &&\n\t\t\t\tthis.nodes[i].addedToScene &&\n\t\t\t\t!this.nodes[i].alwaysOnTop\n\t\t\t) {\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (\n\t\t\t\tthis.nodes[i] != null &&\n\t\t\t\tthis.nodes[i].highlighted &&\n\t\t\t\t!this.nodes[i].alwaysOnTop &&\n\t\t\t\tthis.nodes[i].addedToScene\n\t\t\t) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (this.nodes[i] != null && this.nodes[i].alwaysOnTop && this.nodes[i].addedToScene) {\n\t\t\t\tthis.nodes[i].pulseHighlight(this.framenum);\n\t\t\t\tthis.nodes[i].draw(this.ctx);\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < this.edges.length; i++) {\n\t\t\tif (this.edges[i] != null) {\n\t\t\t\tfor (j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j].addedToScene) {\n\t\t\t\t\t\tthis.edges[i][j].pulseHighlight(this.framenum);\n\t\t\t\t\t\tthis.edges[i][j].draw(this.ctx);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.statusReport.draw(this.ctx);\n\t}\n\n\tupdate() {}\n\n\tsetLayers(shown, layers) {\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = shown;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\taddHighlightCircleObject(objectID, objectColor, radius) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addHighlightCircleObject: object with same ID (' + String(objectID) + ') already exists!'\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedHighlightCircle(objectID, objectColor, radius);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetEdgeAlpha(fromID, toID, alphaVal) {\n\t\tlet oldAlpha = 1.0;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldAlpha = this.edges[fromID][i].alpha;\n\t\t\t\t\tthis.edges[fromID][i].alpha = alphaVal;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldAlpha;\n\t}\n\n\tsetAlpha(nodeID, alphaVal) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setAlpha(alphaVal);\n\t\t}\n\t}\n\n\tgetAlpha(nodeID) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getAlpha();\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tgetTextColor(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\treturn this.nodes[nodeID].getTextColor(index);\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tsetTextColor(nodeID, color, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setTextColor(color, index);\n\t\t}\n\t}\n\n\tsetHighlightIndex(nodeID, index) {\n\t\tif (this.nodes[nodeID] != null && this.nodes[nodeID] !== undefined) {\n\t\t\tthis.nodes[nodeID].setHighlightIndex(index);\n\t\t}\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.activeLayers = [];\n\t\tfor (let i = 0; i < layers.length; i++) {\n\t\t\tthis.activeLayers[layers[i]] = true;\n\t\t}\n\t\tthis.resetLayers();\n\t}\n\n\tresetLayers() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.nodes.length; i++) {\n\t\t\tif (this.nodes[i] != null && this.nodes[i] !== undefined) {\n\t\t\t\tthis.nodes[i].addedToScene = this.activeLayers[this.nodes[i].layer] === true;\n\t\t\t}\n\t\t}\n\t\tfor (i = this.edges.length - 1; i >= 0; i--) {\n\t\t\tif (this.edges[i] != null && this.edges[i] !== undefined) {\n\t\t\t\tfor (let j = 0; j < this.edges[i].length; j++) {\n\t\t\t\t\tif (this.edges[i][j] != null && this.edges[i][j] !== undefined) {\n\t\t\t\t\t\tthis.edges[i][j].addedToScene =\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].fromID.layer] === true &&\n\t\t\t\t\t\t\tthis.activeLayers[this.edges[i][j].toID.layer] === true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetLayer(objectID, layer) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].layer = layer;\n\t\t\tif (this.activeLayers[layer]) {\n\t\t\t\tthis.nodes[objectID].addedToScene = true;\n\t\t\t} else {\n\t\t\t\tthis.nodes[objectID].addedToScene = false;\n\t\t\t}\n\t\t\tif (this.edges[objectID] != null && this.edges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.edges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.edges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.backEdges[objectID] != null && this.backEdges[objectID] !== undefined) {\n\t\t\t\tfor (let i = 0; i < this.backEdges[objectID].length; i++) {\n\t\t\t\t\tconst nextEdge = this.backEdges[objectID][i];\n\t\t\t\t\tif (nextEdge != null && nextEdge !== undefined) {\n\t\t\t\t\t\tnextEdge.addedToScene =\n\t\t\t\t\t\t\tnextEdge.fromID.addedToScene && nextEdge.toID.addedToScene;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAllObjects() {\n\t\tthis.nodes = [];\n\t\tthis.edges = [];\n\t\tthis.backEdges = [];\n\t}\n\n\tsetForegroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setForegroundColor(color);\n\t\t}\n\t}\n\n\tsetBackgroundColor(objectID, color) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthis.nodes[objectID].setBackgroundColor(color);\n\t\t}\n\t}\n\n\tsetHighlight(nodeID, val, color) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHighlight(val, color);\n\t}\n\n\tgetHighlight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlight();\n\t}\n\n\tgetHighlightIndex(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn false;\n\t\t}\n\t\treturn this.nodes[nodeID].getHighlightIndex();\n\t}\n\n\tsetWidth(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setWidth(val);\n\t}\n\n\tsetHeight(nodeID, val) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].setHeight(val);\n\t}\n\n\tgetHeight(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getHeight();\n\t}\n\n\tgetWidth(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn -1;\n\t\t}\n\t\treturn this.nodes[nodeID].getWidth();\n\t}\n\n\tbackgroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].backgroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tforegroundColor(objectID) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\treturn this.nodes[objectID].foregroundColor;\n\t\t} else {\n\t\t\treturn '#000000';\n\t\t}\n\t}\n\n\tdisconnect(objectIDfrom, objectIDto) {\n\t\tlet undo = null;\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectIDfrom] != null) {\n\t\t\tlen = this.edges[objectIDfrom].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[objectIDfrom][i] != null &&\n\t\t\t\t\tthis.edges[objectIDfrom][i].toID === this.nodes[objectIDto]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.edges[objectIDfrom][i];\n\t\t\t\t\tundo = deleted.createUndoConnect();\n\t\t\t\t\tthis.edges[objectIDfrom][i] = this.edges[objectIDfrom][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.edges[objectIDfrom].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (this.backEdges[objectIDto] != null) {\n\t\t\tlen = this.backEdges[objectIDto].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.backEdges[objectIDto][i] != null &&\n\t\t\t\t\tthis.backEdges[objectIDto][i].fromID === this.nodes[objectIDfrom]\n\t\t\t\t) {\n\t\t\t\t\tdeleted = this.backEdges[objectIDto][i];\n\t\t\t\t\t// Note:  Don't need to remove this child, did it above on the regular edge\n\t\t\t\t\tthis.backEdges[objectIDto][i] = this.backEdges[objectIDto][len - 1];\n\t\t\t\t\tlen -= 1;\n\t\t\t\t\tthis.backEdges[objectIDto].pop();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undo;\n\t}\n\n\tdeleteIncident(objectID) {\n\t\tconst undoStack = [];\n\t\tlet len;\n\t\tlet deleted;\n\t\tif (this.edges[objectID] != null) {\n\t\t\tlen = this.edges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.edges[objectID][i];\n\t\t\t\tconst node2ID = deleted.toID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.backEdges[node2ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.backEdges[node2ID][j] === deleted) {\n\t\t\t\t\t\tthis.backEdges[node2ID][j] = this.backEdges[node2ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.backEdges[node2ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.edges[objectID] = null;\n\t\t}\n\t\tif (this.backEdges[objectID] != null) {\n\t\t\tlen = this.backEdges[objectID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tdeleted = this.backEdges[objectID][i];\n\t\t\t\tconst node1ID = deleted.fromID.identifier();\n\t\t\t\tundoStack.push(deleted.createUndoConnect());\n\n\t\t\t\tlet len2 = this.edges[node1ID].length;\n\t\t\t\tfor (let j = len2 - 1; j >= 0; j--) {\n\t\t\t\t\tif (this.edges[node1ID][j] === deleted) {\n\t\t\t\t\t\tthis.edges[node1ID][j] = this.edges[node1ID][len2 - 1];\n\t\t\t\t\t\tlen2 -= 1;\n\t\t\t\t\t\tthis.edges[node1ID].pop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.backEdges[objectID] = null;\n\t\t}\n\t\treturn undoStack;\n\t}\n\n\tremoveObject(objectID) {\n\t\tconst oldObject = this.nodes[objectID];\n\t\tif (objectID === this.nodes.length - 1) {\n\t\t\tthis.nodes.pop();\n\t\t} else {\n\t\t\tthis.nodes[objectID] = null;\n\t\t}\n\t\treturn oldObject;\n\t}\n\n\tgetObject(objectID) {\n\t\tif (this.nodes[objectID] == null || this.nodes[objectID] === undefined) {\n\t\t\tthrow new Error('getObject:Object with ID (' + String(objectID) + ') does not exist');\n\t\t}\n\t\treturn this.nodes[objectID];\n\t}\n\n\taddCircleObject(objectID, objectLabel) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error(\n\t\t\t\t'addCircleObject: object with same ID (' + String(objectID) + ') already exists!'\n\t\t\t);\n\t\t}\n\t\tconst newNode = new AnimatedCircle(objectID, objectLabel);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNodeX(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('Getting x position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].x;\n\t}\n\n\tgetTextWidth(text) {\n\t\t// TODO:  Need to make fonts more flexible, and less hardwired.\n\t\tthis.ctx.font = '10px sans-serif';\n\t\tconst strList = text.split('\\n');\n\t\tlet width = 0;\n\t\tif (strList.length === 1) {\n\t\t\twidth = this.ctx.measureText(text).width;\n\t\t} else {\n\t\t\tfor (let i = 0; i < strList.length; i++) {\n\t\t\t\twidth = Math.max(width, this.ctx.measureText(strList[i]).width);\n\t\t\t}\n\t\t}\n\n\t\treturn width;\n\t}\n\n\tsetText(nodeID, text, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('setting text of an object that does not exist');\n\t\t}\n\t\tthis.nodes[nodeID].setText(text, index, this.getTextWidth(text));\n\t}\n\n\tgetText(nodeID, index) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting text of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].getText(index);\n\t}\n\n\tgetNodeY(nodeID) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\tthrow new Error('getting y position of an object that does not exist');\n\t\t}\n\t\treturn this.nodes[nodeID].y;\n\t}\n\n\tconnectEdge(objectIDfrom, objectIDto, color, curve, directed, lab, connectionPoint) {\n\t\tconst fromObj = this.nodes[objectIDfrom];\n\t\tconst toObj = this.nodes[objectIDto];\n\t\tif (fromObj == null || toObj == null) {\n\t\t\tthrow new Error(\"Tried to connect two nodes, one didn't exist!\");\n\t\t}\n\t\tconst l = new AnimatedLine(fromObj, toObj, color, curve, directed, lab, connectionPoint);\n\t\tif (this.edges[objectIDfrom] == null) {\n\t\t\tthis.edges[objectIDfrom] = [];\n\t\t}\n\t\tif (this.backEdges[objectIDto] == null) {\n\t\t\tthis.backEdges[objectIDto] = [];\n\t\t}\n\t\tl.addedToScene = fromObj.addedToScene && toObj.addedToScene;\n\t\tthis.edges[objectIDfrom].push(l);\n\t\tthis.backEdges[objectIDto].push(l);\n\t}\n\n\tsetNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNull(nullVal);\n\t\t}\n\t}\n\n\tsetPrevNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setPrevNull(nullVal);\n\t\t}\n\t}\n\n\tsetNextNull(objectID, nullVal) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthis.nodes[objectID].setNextNull(nullVal);\n\t\t}\n\t}\n\n\tgetNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetLeftNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getLeftNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tgetRightNull(objectID) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\treturn this.nodes[objectID].getRightNull();\n\t\t}\n\t\treturn false; // TODO:  Error here?\n\t}\n\n\tsetEdgeColor(\n\t\tfromID,\n\t\ttoID,\n\t\tcolor // returns old color\n\t) {\n\t\tlet oldColor = '#000000';\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldColor = this.edges[fromID][i].color();\n\t\t\t\t\tthis.edges[fromID][i].setColor(color);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldColor;\n\t}\n\n\talignTop(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignTop(this.nodes[id2]);\n\t}\n\n\talignLeft(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignLeft(this.nodes[id2]);\n\t}\n\n\talignRight(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignRight(this.nodes[id2]);\n\t}\n\n\tgetAlignRightPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignRightPos(this.nodes[id2]);\n\t}\n\n\tgetAlignLeftPos(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\treturn this.nodes[id1].getAlignLeftPos(this.nodes[id2]);\n\t}\n\n\talignBottom(id1, id2) {\n\t\tif (\n\t\t\tthis.nodes[id1] == null ||\n\t\t\tthis.nodes[id1] === undefined ||\n\t\t\tthis.nodes[id2] == null ||\n\t\t\tthis.nodes[id2] === undefined\n\t\t) {\n\t\t\tthrow new Error(\n\t\t\t\t\"Tring to align two nodes, one doesn't exist: \" + String(id1) + ',' + String(id2)\n\t\t\t);\n\t\t}\n\t\tthis.nodes[id1].alignBottom(this.nodes[id2]);\n\t}\n\n\tsetEdgeHighlight(\n\t\tfromID,\n\t\ttoID,\n\t\tval // returns old color\n\t) {\n\t\tlet oldHighlight = false;\n\t\tif (this.edges[fromID] != null && this.edges[fromID] !== undefined) {\n\t\t\tconst len = this.edges[fromID].length;\n\t\t\tfor (let i = len - 1; i >= 0; i--) {\n\t\t\t\tif (\n\t\t\t\t\tthis.edges[fromID][i] != null &&\n\t\t\t\t\tthis.edges[fromID][i] !== undefined &&\n\t\t\t\t\tthis.edges[fromID][i].toID === this.nodes[toID]\n\t\t\t\t) {\n\t\t\t\t\toldHighlight = this.edges[fromID][i].highlighted;\n\t\t\t\t\tthis.edges[fromID][i].setHighlight(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn oldHighlight;\n\t}\n\n\taddLabelObject(objectID, objectLabel, centering) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addLabelObject: object already exists!');\n\t\t}\n\n\t\tconst newLabel = new AnimatedLabel(\n\t\t\tobjectID,\n\t\t\tobjectLabel,\n\t\t\tcentering,\n\t\t\tthis.getTextWidth(objectLabel)\n\t\t);\n\t\tthis.nodes[objectID] = newLabel;\n\t}\n\n\taddLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tverticalOrientation,\n\t\tlinkPosEnd,\n\t\tbackgroundColor,\n\t\tforegroundColor\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tverticalOrientation,\n\t\t\tlinkPosEnd,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddDoublyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addDoublyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedDoublyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddCircularlyLinkedListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tlinkPer,\n\t\tbackgroundColor,\n\t\tforegroundColor\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addCircularlyLinkedListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedCircularlyLinkedListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tlinkPer,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddSkipListObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\tbackgroundColor,\n\t\tforegroundColor\n\t) {\n\t\tif (this.nodes[objectID] != null) {\n\t\t\tthrow new Error('addSkipListObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedSkipListNode(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tgetNumElements(objectID) {\n\t\treturn this.nodes[objectID].getNumElements();\n\t}\n\n\tsetNumElements(objectID, numElems) {\n\t\tthis.nodes[objectID].setNumElements(numElems);\n\t}\n\n\taddBTreeNode(objectID, widthPerElem, height, numElems, backgroundColor, foregroundColor) {\n\t\tbackgroundColor = backgroundColor === undefined ? '#FFFFFF' : backgroundColor;\n\t\tforegroundColor = foregroundColor === undefined ? '#FFFFFF' : foregroundColor;\n\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addBTreeNode: object with same ID already exists!');\n\t\t}\n\n\t\tconst newNode = new AnimatedBTreeNode(\n\t\t\tobjectID,\n\t\t\twidthPerElem,\n\t\t\theight,\n\t\t\tnumElems,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\taddRectangleObject(\n\t\tobjectID,\n\t\tnodeLabel,\n\t\twidth,\n\t\theight,\n\t\txJustify,\n\t\tyJustify,\n\t\tbackgroundColor,\n\t\tforegroundColor\n\t) {\n\t\tif (this.nodes[objectID] != null && this.nodes[objectID] !== undefined) {\n\t\t\tthrow new Error('addRectangleObject: object with same ID already exists!');\n\t\t}\n\t\tconst newNode = new AnimatedRectangle(\n\t\t\tobjectID,\n\t\t\tnodeLabel,\n\t\t\twidth,\n\t\t\theight,\n\t\t\txJustify,\n\t\t\tyJustify,\n\t\t\tbackgroundColor,\n\t\t\tforegroundColor\n\t\t);\n\t\tthis.nodes[objectID] = newNode;\n\t}\n\n\tsetNodePosition(nodeID, newX, newY) {\n\t\tif (this.nodes[nodeID] == null || this.nodes[nodeID] === undefined) {\n\t\t\t// TODO:  Error here?\n\t\t\treturn;\n\t\t}\n\t\tif (newX === undefined || newY === undefined) {\n\t\t\treturn;\n\t\t}\n\t\tthis.nodes[nodeID].x = newX;\n\t\tthis.nodes[nodeID].y = newY;\n\t\t/* Don't need to dirty anything, since we repaint everything every frame\n\t\t (TODO:  Revisit if we do conditional redraws) */\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// Global timer used for doing animation callbacks.\n//  TODO:  Make this an instance variable of Animation Manager.\n\n/* global canvas */\n\nimport {\n\tUndoCreate,\n\tUndoHighlight,\n\tUndoHighlightEdge,\n\tUndoMove,\n\tUndoSetAlpha,\n\tUndoSetBackgroundColor,\n\tUndoSetEdgeAlpha,\n\tUndoSetEdgeColor,\n\tUndoSetForegroundColor,\n\tUndoSetHeight,\n\tUndoSetHighlightIndex,\n\tUndoSetNextNull,\n\tUndoSetNull,\n\tUndoSetNumElements,\n\tUndoSetPosition,\n\tUndoSetPrevNull,\n\tUndoSetText,\n\tUndoSetTextColor,\n\tUndoSetWidth,\n} from './UndoFunctions.js';\nimport EventListener from './CustomEvents.js';\nimport ObjectManager from './ObjectManager.js';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport SingleAnimation from './SingleAnimation.js';\nimport { Slider } from '@material-ui/core';\nimport { UndoConnect } from './AnimatedLine.js';\n\n\n// Utility function to read a cookie\nfunction getCookie(cookieName) {\n\tlet i, x, y;\n\tconst cookies = document.cookie.split(';');\n\tfor (i = 0; i < cookies.length; i++) {\n\t\tx = cookies[i].substr(0, cookies[i].indexOf('='));\n\t\ty = cookies[i].substr(cookies[i].indexOf('=') + 1);\n\t\tx = x.replace(/^\\s+|\\s+$/g, '');\n\t\tif (x === cookieName) {\n\t\t\treturn unescape(y);\n\t\t}\n\t}\n}\n\n// Utility function to write a cookie\nfunction setCookie(cookieName, value, expireDays) {\n\tconst exDate = new Date();\n\texDate.setDate(exDate.getDate() + expireDays);\n\tdocument.cookie = cookieName + '=' + value;\n}\n\nconst ANIMATION_SPEED_DEFAULT = 75;\n\n// TODO:  Move these out of global space into animation manager?\n\nfunction controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nfunction returnSubmit(field, func, maxSize, intOnly) {\n\tif (maxSize !== undefined) {\n\t\tfield.size = maxSize;\n\t}\n\treturn function(event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\n\t\tif (keyASCII === 13) {\n\t\t\tfunc();\n\t\t\treturn false;\n\t\t} else if (\n\t\t\tkeyASCII === 59 ||\n\t\t\tkeyASCII === 45 ||\n\t\t\tkeyASCII === 46 ||\n\t\t\tkeyASCII === 190 ||\n\t\t\tkeyASCII === 173\n\t\t) {\n\t\t\treturn false;\n\t\t} else if (\n\t\t\t(maxSize !== undefined && field.value.length >= maxSize) ||\n\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\n\t\t) {\n\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t}\n\t\treturn true;\n\t};\n}\n\nfunction addControlToAnimationBar(animBarRef, type, name, callback) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', name);\n\tif (type === 'Button') {\n\t\telement.onclick = callback;\n\t} else if (type === 'Text') {\n\t\telement.onkeydown = callback;\n\t}\n\n\tconst tableEntry = document.createElement('td');\n\n\ttableEntry.appendChild(element);\n\n\tanimBarRef.current.appendChild(tableEntry);\n\treturn element;\n}\n\nfunction addDivisorToAnimationBar(animBarRef) {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tanimBarRef.current.appendChild(divisorLeft);\n\tanimBarRef.current.appendChild(divisorRight);\n}\n\nexport default class AnimationManager extends EventListener {\n\tconstructor(canvasRef, animBarRef) {\n\t\tsuper();\n\n\t\tthis.objectManager = new ObjectManager(canvasRef);\n\t\t// Holder for all animated objects.\n\t\t// All animation is done by manipulating objects in\n\t\t// this container\n\t\tthis.animatedObjects = this.objectManager;\n\n\t\t// Control variables for stopping / starting animation\n\t\tthis.animationPaused = false;\n\t\tthis.awaitingStep = false;\n\t\tthis.currentlyAnimating = false;\n\n\t\t// Array holding the code for the animation.  This is\n\t\t// an array of strings, each of which is an animation command\n\t\t// currentAnimation is an index into this array\n\t\tthis.animationSteps = [];\n\t\tthis.currentAnimation = 0;\n\n\t\tthis.previousAnimationSteps = [];\n\n\t\t// Control variables for where we are in the current animation block.\n\t\t// currFrame holds the frame number of the current animation block,\n\t\t// while animationBlockLength holds the length of the current animation\n\t\t// block (in frame numbers).\n\t\tthis.currFrame = 0;\n\t\tthis.animationBlockLength = 0;\n\n\t\t//  The animation block that is currently running.  Array of singleAnimations\n\t\tthis.currentBlock = null;\n\n\t\t////////////////////////////////////\n\t\t// Variables for handling undo.\n\t\t////////////////////////////////////\n\t\t//  A stack of UndoBlock objects (subclassed, UndoBlock is an abstract base class)\n\t\t//  each of which can undo a single animation element\n\t\tthis.undoStack = [];\n\t\tthis.doingUndo = false;\n\n\t\t// A stack containing the beginning of each animation block, as an index\n\t\t// into the animationSteps array\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\n\t\tthis.animationBlockLength = 10;\n\n\t\tthis.paused = false;\n\n\t\tthis.canvas = canvasRef;\n\n\t\tthis.skipBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Skip Back', () => this.skipBack());\n\t\tthis.stepBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Step Back', () => this.stepBack());\n\t\tthis.playPauseBackButton = addControlToAnimationBar(animBarRef, 'Button', 'Pause', () => this.doPlayPause());\n\t\tthis.playPauseBackButton.setAttribute('style', 'width: 80px');\n\t\tthis.stepForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Step Forward',\n\t\t\t() => this.step()\n\t\t);\n\t\tthis.skipForwardButton = addControlToAnimationBar(\n\t\t\tanimBarRef,\n\t\t\t'Button',\n\t\t\t'Skip Forward',\n\t\t\t() => this.skipForward()\n\t\t);\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tconst element = document.createElement('div');\n\t\telement.setAttribute('display', 'inline-block');\n\t\telement.setAttribute('float', 'left');\n\n\t\tlet speed = getCookie('VisualizationSpeed');\n\t\tif (speed == null || speed === '') {\n\t\t\tspeed = ANIMATION_SPEED_DEFAULT;\n\t\t} else {\n\t\t\tspeed = parseInt(speed);\n\t\t}\n\n\t\tconst slider = (\n\t\t\t<Slider\n\t\t\t\tdefaultValue={speed}\n\t\t\t\tonChange={(e, val) => {\n\t\t\t\t\tthis.setSpeed(val);\n\t\t\t\t\tsetCookie('VisualizationSpeed', String(val), 30);\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\n\t\tlet tableEntry = document.createElement('td');\n\n\t\tconst controlBar = document.getElementById('GeneralAnimationControls');\n\n\t\tconst newTable = document.createElement('table');\n\n\t\tlet midLevel = document.createElement('tr');\n\t\tlet bottomLevel = document.createElement('td');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tReactDOM.render(slider, bottomLevel);\n\t\tnewTable.appendChild(midLevel);\n\n\t\tmidLevel = document.createElement('tr');\n\t\tbottomLevel = document.createElement('td');\n\t\tbottomLevel.align = 'center';\n\t\tlet txtNode = document.createTextNode('Animation Speed');\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tbottomLevel.appendChild(txtNode);\n\t\tnewTable.appendChild(midLevel);\n\n\t\ttableEntry.appendChild(newTable);\n\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.setSpeed(speed);\n\n\t\telement.setAttribute('style', 'width:200px');\n\n\t\taddDivisorToAnimationBar(animBarRef);\n\n\t\tlet width = getCookie('VisualizationWidth');\n\t\twidth = width == null || width === '' ? 1500 : parseInt(width);\n\n\t\tlet height = getCookie('VisualizationHeight');\n\t\theight = height == null || height === '' ? 505 : parseInt(height);\n\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\n\t\ttableEntry = document.createElement('td');\n\t\ttxtNode = document.createTextNode('w:');\n\t\ttableEntry.appendChild(txtNode);\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.widthEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.width, () =>\n\t\t\treturnSubmit(this.widthEntry, this.changeSize.bind(this), 4, true)\n\t\t);\n\t\tthis.widthEntry.size = 4;\n\n\t\ttableEntry = document.createElement('td');\n\t\ttxtNode = document.createTextNode('h:');\n\t\ttableEntry.appendChild(txtNode);\n\t\tcontrolBar.appendChild(tableEntry);\n\n\t\tthis.heightEntry = addControlToAnimationBar(animBarRef, 'Text', canvas.height, () =>\n\t\t\treturnSubmit(this.heightEntry, this.changeSize.bind(this), 4, true)\n\t\t);\n\n\t\tthis.heightEntry.size = 4;\n\t\tthis.sizeButton = addControlToAnimationBar(animBarRef, 'Button', 'Change Canvas Size', () =>\n\t\t\tthis.changeSize()\n\t\t);\n\n\t\tthis.addListener('AnimationStarted', this, this.animStarted);\n\t\tthis.addListener('AnimationEnded', this, this.animEnded);\n\t\tthis.addListener('AnimationWaiting', this, this.animWaiting);\n\t\tthis.addListener('AnimationUndoUnavailable', this, this.animUndoUnavailable);\n\t\tthis.objectManager.width = canvas.width;\n\t\tthis.objectManager.height = canvas.height;\n\t}\n\n\tlerp(from, to, percent) {\n\t\treturn (to - from) * percent + from;\n\t}\n\n\t// Pause / unpause animation\n\tsetPaused(pausedValue) {\n\t\tthis.animationPaused = pausedValue;\n\t\tif (!this.animationPaused) {\n\t\t\tthis.step();\n\t\t}\n\t}\n\n\tparseBool(str) {\n\t\tconst uppercase = str.toUpperCase();\n\t\tconst returnVal = !(\n\t\t\tuppercase === 'False' ||\n\t\t\tuppercase === 'f' ||\n\t\t\tuppercase === ' 0' ||\n\t\t\tuppercase === '0' ||\n\t\t\tuppercase === ''\n\t\t);\n\t\treturn returnVal;\n\t}\n\n\tparseColor(clr) {\n\t\tif (clr.charAt(0) === '#') {\n\t\t\treturn clr;\n\t\t} else if (clr.substring(0, 2) === '0x') {\n\t\t\treturn '#' + clr.substring(2);\n\t\t}\n\t}\n\n\t// Set the speed of the animation, from 0 (slow) to 100 (fast)\n\tsetSpeed(newSpeed) {\n\t\tthis.animationBlockLength = Math.floor((100 - newSpeed) / 2);\n\t}\n\n\tchangeSize() {\n\t\tconst width = parseInt(this.widthEntry.value);\n\t\tconst height = parseInt(this.heightEntry.value);\n\n\t\tif (width > 100) {\n\t\t\tcanvas.width = width;\n\t\t\tthis.animatedObjects.width = width;\n\t\t\tsetCookie('VisualizationWidth', String(width), 30);\n\t\t}\n\t\tif (height > 100) {\n\t\t\tcanvas.height = height;\n\t\t\tthis.animatedObjects.height = height;\n\t\t\tsetCookie('VisualizationHeight', String(height), 30);\n\t\t}\n\t\tthis.widthEntry.value = canvas.width;\n\t\tthis.heightEntry.value = canvas.height;\n\n\t\tthis.animatedObjects.draw();\n\t\tthis.fireEvent('CanvasSizeChanged', { width: canvas.width, height: canvas.height });\n\t}\n\n\tstartNextBlock() {\n\t\tthis.awaitingStep = false;\n\t\tthis.currentBlock = [];\n\t\tthis.undoBlock = [];\n\t\tif (this.currentAnimation === this.animationSteps.length) {\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\treturn;\n\t\t}\n\t\tthis.undoAnimationStepIndices.push(this.currentAnimation);\n\n\t\tthis.foundBreak = false;\n\t\tthis.anyAnimations = false;\n\n\t\twhile (this.currentAnimation < this.animationSteps.length && !this.foundBreak) {\n\t\t\tconst [ act, params ] = this.animationSteps[this.currentAnimation];\n\t\t\tact.call(this, params);\n\t\t\tthis.currentAnimation++;\n\t\t}\n\t\tthis.currFrame = 0;\n\n\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t// then set the current frame to the end of the animation, so that we will\n\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t// animate as normal.\n\t\tif (\n\t\t\t(!this.anyAnimations && this.animationPaused) ||\n\t\t\t(!this.anyAnimations && this.currentAnimation === this.animationSteps.length)\n\t\t) {\n\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t}\n\n\t\tthis.undoStack.push(this.undoBlock);\n\t}\n\n\t//  Start a new animation.  The input parameter commands is an array of strings,\n\t//  which represents the animation to start\n\tstartNewAnimation(commands) {\n\t\tthis.stopTimer();\n\t\tif (this.animationSteps !== null) {\n\t\t\tthis.previousAnimationSteps.push(this.animationSteps);\n\t\t\tthis.undoAnimationStepIndicesStack.push(this.undoAnimationStepIndices);\n\t\t}\n\t\tif (commands === undefined || commands.length === 0) {\n\t\t\tthis.animationSteps = [[act.step, []]];\n\t\t} else {\n\t\t\tthis.animationSteps = commands;\n\t\t}\n\t\tthis.undoAnimationStepIndices = [];\n\t\tthis.currentAnimation = 0;\n\t\tthis.startNextBlock();\n\t\tthis.currentlyAnimating = true;\n\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\tthis.startTimer();\n\t}\n\n\t// Step backwards one step.  A no-op if the animation is not currently paused\n\tstepBack() {\n\t\tif (this.awaitingStep && this.undoStack !== null && this.undoStack.length !== 0) {\n\t\t\t//  TODO:  Get events working correctly!\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.stopTimer();\n\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t} else if (\n\t\t\t!this.currentlyAnimating &&\n\t\t\tthis.animationPaused &&\n\t\t\tthis.undoAnimationStepIndices !== null\n\t\t) {\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\tthis.undoLastBlock();\n\t\t\t// Re-kick the timer.  The timer may or may not be running at this point,\n\t\t\t// so to be safe we'll kill it and start it again.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t// Step forwards one step.  A no-op if the animation is not currently paused\n\tstep() {\n\t\tif (this.awaitingStep) {\n\t\t\tthis.startNextBlock();\n\t\t\tthis.fireEvent('AnimationStarted', 'NoData');\n\t\t\tthis.currentlyAnimating = true;\n\t\t\t// Re-kick the timer.  The timer should be going now, but we've had some difficulty with\n\t\t\t// it timing itself out, so we'll be safe and kick it now.\n\t\t\tthis.stopTimer();\n\t\t\tthis.startTimer();\n\t\t}\n\t}\n\n\t/// WARNING:  Could be dangerous to call while an animation is running ...\n\tclearHistory() {\n\t\tthis.undoStack = [];\n\t\tthis.undoAnimationStepIndices = null;\n\t\tthis.previousAnimationSteps = [];\n\t\tthis.undoAnimationStepIndicesStack = [];\n\t\tthis.animationSteps = null;\n\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\tthis.stopTimer();\n\t\tthis.animatedObjects.update();\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tskipBack() {\n\t\tlet keepUndoing =\n\t\t\tthis.undoAnimationStepIndices !== null && this.undoAnimationStepIndices.length !== 0;\n\t\tif (keepUndoing) {\n\t\t\tlet i;\n\t\t\tfor (i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\tobjectID,\n\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\tthis.currentBlock[i].toY\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (this.doingUndo) {\n\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\twhile (keepUndoing) {\n\t\t\t\tthis.undoLastBlock();\n\t\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tkeepUndoing = this.finishUndoBlock(this.undoStack.pop());\n\t\t\t}\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.clearHistory();\n\t\tthis.animatedObjects.clearAllObjects();\n\t\tthis.animatedObjects.draw();\n\t\tthis.stopTimer();\n\t}\n\n\tskipForward() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.animatedObjects.runFast = true;\n\t\t\twhile (\n\t\t\t\tthis.animationSteps !== null &&\n\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t) {\n\t\t\t\tfor (let i = 0; this.currentBlock !== null && i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tthis.finishUndoBlock(this.undoStack.pop());\n\t\t\t\t}\n\t\t\t\tthis.startNextBlock();\n\t\t\t\tfor (let i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tobjectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.doingUndo = false;\n\n\t\t\tthis.animatedObjects.runFast = false;\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\t\t}\n\t}\n\n\tfinishUndoBlock(undoBlock) {\n\t\tfor (let i = undoBlock.length - 1; i >= 0; i--) {\n\t\t\tundoBlock[i].undoInitialStep(this.animatedObjects);\n\t\t}\n\t\tthis.doingUndo = false;\n\n\t\t// If we are at the final end of the animation ...\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\tthis.awaitingStep = false;\n\t\t\tthis.currentlyAnimating = false;\n\t\t\tthis.undoAnimationStepIndices = this.undoAnimationStepIndicesStack.pop();\n\t\t\tthis.animationSteps = this.previousAnimationSteps.pop();\n\t\t\tthis.fireEvent('AnimationEnded', 'NoData');\n\t\t\tthis.fireEvent('AnimationUndo', 'NoData');\n\t\t\tthis.currentBlock = [];\n\t\t\tif (this.undoStack == null || this.undoStack.length === 0) {\n\t\t\t\tthis.currentlyAnimating = false;\n\t\t\t\tthis.awaitingStep = false;\n\t\t\t\tthis.fireEvent('AnimationUndoUnavailable', 'NoData');\n\t\t\t}\n\n\t\t\tthis.stopTimer();\n\t\t\tthis.animatedObjects.update();\n\t\t\tthis.animatedObjects.draw();\n\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tundoLastBlock() {\n\t\tif (this.undoAnimationStepIndices.length === 0) {\n\t\t\t// Nothing on the undo stack.  Return\n\t\t\treturn;\n\t\t}\n\t\tif (this.undoAnimationStepIndices.length > 0) {\n\t\t\tthis.doingUndo = true;\n\t\t\tlet anyAnimations = false;\n\t\t\tthis.currentAnimation = this.undoAnimationStepIndices.pop();\n\t\t\tthis.currentBlock = [];\n\t\t\tconst undo = this.undoStack[this.undoStack.length - 1];\n\t\t\tlet i;\n\t\t\tfor (i = undo.length - 1; i >= 0; i--) {\n\t\t\t\tconst animateNext = undo[i].addUndoAnimation(this.currentBlock);\n\t\t\t\tanyAnimations = anyAnimations || animateNext;\n\t\t\t}\n\t\t\tthis.currFrame = 0;\n\n\t\t\t// Hack:  If there are not any animations, and we are currently paused,\n\t\t\t// then set the current frame to the end of the animation, so that we will\n\t\t\t// advance immediately upon the next step button.  If we are not paused, then\n\t\t\t// animate as normal.\n\t\t\tif (!anyAnimations && this.animationPaused) {\n\t\t\t\tthis.currFrame = this.animationBlockLength;\n\t\t\t}\n\t\t\tthis.currentlyAnimating = true;\n\t\t}\n\t}\n\n\tsetLayer(shown, layers) {\n\t\tthis.animatedObjects.setLayer(shown, layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tsetAllLayers(layers) {\n\t\tthis.animatedObjects.setAllLayers(layers);\n\t\t// Drop in an extra draw call here, just in case we are not\n\t\t// in the middle of an update loop when this changes\n\t\tthis.animatedObjects.draw();\n\t}\n\n\tupdate() {\n\t\tif (this.currentlyAnimating) {\n\t\t\tthis.currFrame = this.currFrame + 1;\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < this.currentBlock.length; i++) {\n\t\t\t\tif (\n\t\t\t\t\tthis.currFrame === this.animationBlockLength ||\n\t\t\t\t\t(this.currFrame === 1 && this.animationBlockLength === 0)\n\t\t\t\t) {\n\t\t\t\t\tthis.animatedObjects.setNodePosition(\n\t\t\t\t\t\tthis.currentBlock[i].objectID,\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tthis.currentBlock[i].toY\n\t\t\t\t\t);\n\t\t\t\t} else if (this.currFrame < this.animationBlockLength) {\n\t\t\t\t\tconst objectID = this.currentBlock[i].objectID;\n\t\t\t\t\tconst percent = 1 / (this.animationBlockLength - this.currFrame);\n\t\t\t\t\tconst newX = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeX(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toX,\n\t\t\t\t\t\tpercent\n\t\t\t\t\t);\n\t\t\t\t\tconst newY = this.lerp(\n\t\t\t\t\t\tthis.animatedObjects.getNodeY(objectID),\n\t\t\t\t\t\tthis.currentBlock[i].toY,\n\t\t\t\t\t\tpercent\n\t\t\t\t\t);\n\t\t\t\t\tthis.animatedObjects.setNodePosition(objectID, newX, newY);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.currFrame >= this.animationBlockLength) {\n\t\t\t\tif (this.doingUndo) {\n\t\t\t\t\tif (this.finishUndoBlock(this.undoStack.pop())) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.animationPaused &&\n\t\t\t\t\t\tthis.currentAnimation < this.animationSteps.length\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.awaitingStep = true;\n\t\t\t\t\t\tthis.fireEvent('AnimationWaiting', 'NoData');\n\t\t\t\t\t\tthis.currentBlock = [];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.startNextBlock();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.animatedObjects.update();\n\t\t}\n\t}\n\n\tanimWaiting() {\n\t\tthis.stepForwardButton.disabled = false;\n\t\tif (this.skipBackButton.disabled === false) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Paused');\n\t\tthis.objectManager.statusReport.setForegroundColor('#FF0000');\n\t}\n\n\tanimStarted() {\n\t\tthis.skipForwardButton.disabled = false;\n\t\tthis.skipBackButton.disabled = false;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t\tthis.objectManager.statusReport.setText('Animation Running');\n\t\tthis.objectManager.statusReport.setForegroundColor('#009900');\n\t}\n\n\tanimEnded() {\n\t\tthis.skipForwardButton.disabled = true;\n\t\tthis.stepForwardButton.disabled = true;\n\t\tif (this.skipBackButton.disabled === false && this.paused) {\n\t\t\tthis.stepBackButton.disabled = false;\n\t\t}\n\t\tthis.objectManager.statusReport.setText('Animation Completed');\n\t\tthis.objectManager.statusReport.setForegroundColor('#000000');\n\t}\n\n\tanimUndoUnavailable() {\n\t\tthis.skipBackButton.disabled = true;\n\t\tthis.stepBackButton.disabled = true;\n\t}\n\n\ttimeout() {\n\t\t// We need to set the timeout *first*, otherwise if we\n\t\t// try to clear it later, we get behavior we don't want ...\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t\tthis.update();\n\t\tthis.objectManager.draw();\n\t}\n\n\tdoPlayPause() {\n\t\tthis.paused = !this.paused;\n\t\tif (this.paused) {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Play');\n\t\t\tif (this.skipBackButton.disabled === false) {\n\t\t\t\tthis.stepBackButton.disabled = false;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.playPauseBackButton.setAttribute('value', 'Pause');\n\t\t}\n\t\tthis.setPaused(this.paused);\n\t}\n\n\tstartTimer() {\n\t\tthis.timer = setTimeout(() => this.timeout(), 30);\n\t}\n\n\tstopTimer() {\n\t\tclearInterval(this.timer);\n\t}\n}\n\nexport const act = {\n\tstep() {\n\t\tthis.foundBreak = true;\n\t},\n\tmove(params) { // id, x, y\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tparams[1],\n\t\t\tparams[2]\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY\n\t\t\t)\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n\tdelete(params) { // id\n\t\tconst removedEdges = this.animatedObjects.deleteIncident(params[0]);\n\t\tif (removedEdges.length > 0) {\n\t\t\tthis.undoBlock = this.undoBlock.concat(removedEdges);\n\t\t}\n\t\tconst obj = this.animatedObjects.getObject(params[0]);\n\t\tif (obj !== null) {\n\t\t\tthis.undoBlock.push(obj.createUndoDelete());\n\t\t\tthis.animatedObjects.removeObject(params[0]);\n\t\t}\n\t},\n\tconnect(params) { // fromID, toID | color, curve, directed, label, anchorPos\n\t\tparams[2] = params[2] || \"#000000\";\n\t\tparams[3] = params[3] || 0.0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tparams[5] = params[5] === undefined ? \"\" : params[5];\n\t\tparams[6] = params[6] || 0;\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[4],\n\t\t\tString(params[5]),\n\t\t\tparams[6]\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectNext(params) { // fromID, toID\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t\"#000000\",\n\t\t\t0.0,\n\t\t\ttrue,\n\t\t\t\"\",\n\t\t\t0\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectPrev(params) { // fromID, toID\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t\"#000000\",\n\t\t\t0.0,\n\t\t\ttrue,\n\t\t\t\"\",\n\t\t\t1\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectCurve(params) { // fromID, toID, curve\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t\"#000000\",\n\t\t\tparams[2],\n\t\t\ttrue,\n\t\t\t\"\",\n\t\t\t1\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tconnectSkipList(params) { // fromID, toID, anchorPos\n\t\tthis.animatedObjects.connectEdge(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\t\"#000000\",\n\t\t\t0.0,\n\t\t\tfalse,\n\t\t\t\"\",\n\t\t\tparams[2]\n\t\t);\n\t\tthis.undoBlock.push(new UndoConnect(params[0], params[1], false));\n\t},\n\tdisconnect(params) { // fromID, toID\n\t\tconst undoConnect = this.animatedObjects.disconnect(params[0], params[1]);\n\t\tif (undoConnect !== null) this.undoBlock.push(undoConnect);\n\t},\n\tcreateCircle(params) { // id, label | x, y\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tthis.animatedObjects.addCircleObject(params[0], String(params[1]));\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3])\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateHighlightCircle(params) { // id, color | x, y, radius\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] === undefined ? 20 : params[4];\n\t\tthis.animatedObjects.addHighlightCircleObject(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[4]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparseInt(params[0]),\n\t\t\tparseInt(params[2]),\n\t\t\tparseInt(params[3])\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateRectangle(params) { // id, label, w, h | x, y, xJustify, yJustify, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || \"center\";\n\t\tparams[7] = params[7] || \"center\";\n\t\tparams[8] = params[8] || \"#FFFFFF\";\n\t\tparams[9] = params[9] || \"#000000\";\n\t\tthis.animatedObjects.addRectangleObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLabel(params) { // id, label | x, y, centered\n\t\tparams[2] = params[2] || 0;\n\t\tparams[3] = params[3] || 0;\n\t\tparams[4] = params[4] !== false && params[4] !== 0;\n\t\tthis.animatedObjects.addLabelObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[4]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[2],\n\t\t\tparams[3]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateLinkedListNode(params) { // id, label, w, h | x, y, linkPercent, vertical, linkPosEnd, bgColor, fgColor\n\t\tparams[1] = Array.isArray(params[1]) ? params[1].map(x => String(x)) : [String(params[1])];\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] !== false && params[7] !== 0;\n\t\tparams[8] = params[8] || false;\n\t\tparams[9] = params[9] || \"#FFFFFF\";\n\t\tparams[10] = params[10] || \"#000000\";\n\t\tthis.animatedObjects.addLinkedListObject(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8],\n\t\t\tparams[9],\n\t\t\tparams[10]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateDoublyLinkedListNode(params) { // id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || \"#FFFFFF\";\n\t\tparams[8] = params[8] || \"#000000\";\n\t\tthis.animatedObjects.addDoublyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateCircularlyLinkedListNode(params) { // id, label, w, h | x, y, linkPercent, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] === undefined ? 0.25 : params[6];\n\t\tparams[7] = params[7] || \"#FFFFFF\";\n\t\tparams[8] = params[8] || \"#000000\";\n\t\tthis.animatedObjects.addCircularlyLinkedListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7],\n\t\t\tparams[8]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateSkipListNode(params) { // id, label, w, h | x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || \"#FFFFFF\";\n\t\tparams[7] = params[7] || \"#000000\";\n\t\tthis.animatedObjects.addSkipListObject(\n\t\t\tparams[0],\n\t\t\tString(params[1]),\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tcreateBTreeNode(params) { // id, widthPerElement, height, numLabels, x, y, bgColor, fgColor\n\t\tparams[4] = params[4] || 0;\n\t\tparams[5] = params[5] || 0;\n\t\tparams[6] = params[6] || \"#FFFFFF\";\n\t\tparams[7] = params[7] || \"#000000\";\n\t\tthis.animatedObjects.addBTreeNode(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2],\n\t\t\tparams[3],\n\t\t\tparams[6],\n\t\t\tparams[7]\n\t\t);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[4],\n\t\t\tparams[5]\n\t\t);\n\t\tthis.undoBlock.push(new UndoCreate(params[0]));\n\t},\n\tsetText(params) { // id, text | textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldText = this.animatedObjects.getText(params[0], params[2]);\n\t\tthis.animatedObjects.setText(params[0], String(params[1]), params[2]);\n\t\tif (oldText !== undefined) {\n\t\t\tthis.undoBlock.push(new UndoSetText(params[0], oldText, params[2]));\n\t\t}\n\t},\n\tsetTextColor(params) { // id, color, textIndex\n\t\tparams[2] = params[2] || 0;\n\t\tconst oldColor = this.animatedObjects.getTextColor(params[0], params[2]);\n\t\tthis.animatedObjects.setTextColor(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2]\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetTextColor(params[0], oldColor, params[2]));\n\t},\n\tsetForegroundColor(params) { // id, color\n\t\tconst oldColor = this.animatedObjects.foregroundColor(params[0]);\n\t\tthis.animatedObjects.setForegroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetForegroundColor(params[0], oldColor));\n\t},\n\tsetBackgroundColor(params) { // id, color\n\t\tconst oldColor = this.animatedObjects.backgroundColor(params[0]);\n\t\tthis.animatedObjects.setBackgroundColor(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetBackgroundColor(params[0], oldColor));\n\t},\n\tsetHighlight(params) { // id, highlight, color\n\t\tthis.animatedObjects.setHighlight(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoHighlight(params[0], !params[1], params[2]));\n\t},\n\tsetAlpha(params) { // id, alpha\n\t\tconst oldAlpha = this.animatedObjects.getAlpha(params[0]);\n\t\tthis.animatedObjects.setAlpha(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetAlpha(params[0], oldAlpha));\n\t},\n\tsetEdgeColor(params) { // fromID, toID, newColor\n\t\tconst oldColor = this.animatedObjects.setEdgeColor(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeColor(params[0], params[1], oldColor));\n\t},\n\tsetEdgeAlpha(params) { // fromID, toID, alpha\n\t\tconst oldAlpha = this.animatedObjects.setEdgeAlpha(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoSetEdgeAlpha(params[0], params[1], oldAlpha));\n\t},\n\tsetEdgeHighlight(params) { // fromID, toID, highlight\n\t\tconst oldHighlight = this.animatedObjects.setEdgeHighlight(params[0], params[1], params[2]);\n\t\tthis.undoBlock.push(new UndoHighlightEdge(params[0], params[1], oldHighlight));\n\t},\n\tsetHeight(params) { // id, height\n\t\tconst oldHeight = this.animatedObjects.getHeight(params[0]);\n\t\tthis.animatedObjects.setHeight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetHeight(params[0], oldHeight));\n\t},\n\tsetWidth(params) { // id, width\n\t\tconst oldWidth = this.animatedObjects.getWidth(params[0]);\n\t\tthis.animatedObjects.setWidth(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetWidth(params[0], oldWidth));\n\t},\n\tsetLayer(params) { // id, height\n\t\tthis.animatedObjects.setLayer(params[0], params[1]);\n\t\t//TODO: Add undo information here\n\t},\n\tsetNull(params) { // id, null\n\t\tconst oldNull = this.animatedObjects.getNull(params[0]);\n\t\tthis.animatedObjects.setNull(\n\t\t\tparams[0],\n\t\t\tparams[1]\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetNull(params[0], oldNull));\n\t},\n\tsetPrevNull(params) { // id, null\n\t\tconst oldNull = this.animatedObjects.getLeftNull(params[0]);\n\t\tthis.animatedObjects.setPrevNull(\n\t\t\tparams[0],\n\t\t\tparams[1]\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetPrevNull(params[0], oldNull));\n\t},\n\tsetNextNull(params) { // id, null\n\t\tconst oldNull = this.animatedObjects.getRightNull(params[0]);\n\t\tthis.animatedObjects.setNextNull(\n\t\t\tparams[0],\n\t\t\tparams[1]\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetNextNull(params[0], oldNull));\n\t},\n\tsetNumElements(params) { // id, numElements\n\t\tconst oldElem = this.animatedObjects.getObject(params[0]);\n\t\tthis.undoBlock.push(new UndoSetNumElements(oldElem, params[1]));\n\t\tthis.animatedObjects.setNumElements(\n\t\t\tparams[0],\n\t\t\tparams[1]\n\t\t);\n\t},\n\tsetPosition(params) { // id, x, y\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.setNodePosition(\n\t\t\tparams[0],\n\t\t\tparams[1],\n\t\t\tparams[2]\n\t\t);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tsetHighlightIndex(params) {\n\t\tconst oldIndex = this.animatedObjects.getHighlightIndex(params[0]);\n\t\tthis.undoBlock.push(new UndoSetHighlightIndex(params[0], oldIndex));\n\t\tthis.animatedObjects.setHighlightIndex(params[0], params[1]);\n\t},\n\talignRight(params) { // id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignRight(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignLeft(params) { // id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignLeft(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignTop(params) { // id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignTop(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\talignBottom(params) { // id, otherID\n\t\tconst oldX = this.animatedObjects.getNodeX(params[0]);\n\t\tconst oldY = this.animatedObjects.getNodeY(params[0]);\n\t\tthis.animatedObjects.alignBottom(params[0], params[1]);\n\t\tthis.undoBlock.push(new UndoSetPosition(params[0], oldX, oldY));\n\t},\n\tmoveToAlignRight(params) { // id, otherID\n\t\tconst newXY = this.animatedObjects.getAlignRightPos(params[0], params[1]);\n\t\tconst nextAnim = new SingleAnimation(\n\t\t\tparams[0],\n\t\t\tthis.animatedObjects.getNodeX(params[0]),\n\t\t\tthis.animatedObjects.getNodeY(params[0]),\n\t\t\tnewXY[0],\n\t\t\tnewXY[1]\n\t\t);\n\t\tthis.currentBlock.push(nextAnim);\n\t\tthis.undoBlock.push(\n\t\t\tnew UndoMove(\n\t\t\t\tnextAnim.objectID,\n\t\t\t\tnextAnim.toX,\n\t\t\t\tnextAnim.toY,\n\t\t\t\tnextAnim.fromX,\n\t\t\t\tnextAnim.fromY\n\t\t\t)\n\t\t);\n\t\tthis.anyAnimations = true;\n\t},\n}","import React from 'react';\n\nconst Footer = () => (\n    <div className=\"footer\">\n        Copyright 2019 <a href=\"https://rodrigodlpontes.github.io/website/\">Rodrigo Pontes</a>,\n        Copyright 2011 <a href=\"http://www.cs.usfca.edu/galles\">David Galles</a>\n    </div>\n)\n\nexport default Footer;","import { Link } from 'react-router-dom';\nimport React from 'react';\n\nclass Header extends React.Component {\n    \n\tstate = { menuVisible: null };\n\n    render() {\n        const menuClass = {null: '', true: 'show', false: 'hide'};\n\n        return (\n            <React.Fragment>\n                <div className=\"header\">\n                    <button\n                        className={this.state.menuVisible ? 'selected' : ''}\n                        onClick={this.toggleMenu}\n                    ></button>\n                    <h1>CS1332 Data Structures and Algorithms Visualizations</h1>\n                </div>\n                <div className={`menu ${menuClass[this.state.menuVisible]}`}>\n                    <ul>\n                        <li>\n                            <Link to=\"/\" onClick={this.toggleMenu}>Home</Link>\n                        </li>\n                        <li>\n                            <Link to=\"/about\" onClick={this.toggleMenu}>About</Link>\n                        </li>\n                        <li>\n                            <a href=\"https://github.com/RodrigoDLPontes/visualization-tool\">Source Code</a>\n                        </li>\n                    </ul>\n                </div>\n            </React.Fragment>\n        );\n    }\n\n\ttoggleMenu = () => this.setState(state => ({ menuVisible: !state.menuVisible }));\n}\n\nexport default Header;","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { act } from '../anim/AnimationMain';\n\nexport function addLabelToAlgorithmBar(labelName, group) {\n\tconst element = document.createElement('p');\n\telement.appendChild(document.createTextNode(labelName));\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\t// Append the element in page (in span)\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addCheckboxToAlgorithmBar(boxLabel, checked, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', 'checkbox');\n\telement.setAttribute('id', boxLabel);\n\telement.setAttribute('name', boxLabel);\n\telement.setAttribute('value', boxLabel);\n\tchecked && element.setAttribute('checked', 'true');\n\n\tconst label = document.createElement('label');\n\tlabel.setAttribute('for', boxLabel);\n\tconst txtNode = document.createTextNode(boxLabel);\n\tlabel.appendChild(txtNode);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\t\ttableEntry.appendChild(label);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tconst span = document.createElement('span');\n\t\tspan.appendChild(element);\n\t\tspan.appendChild(label);\n\n\t\tgroup.appendChild(span);\n\t\tspan.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addRadioButtonGroupToAlgorithmBar(buttonNames, groupName, group) {\n\tconst buttonList = [];\n\tconst newTable = document.createElement('table');\n\n\tfor (let i = 0; i < buttonNames.length; i++) {\n\t\tconst midLevel = document.createElement('tr');\n\t\tconst bottomLevel = document.createElement('td');\n\n\t\tconst button = document.createElement('input');\n\t\tbutton.setAttribute('type', 'radio');\n\t\tbutton.setAttribute('name', groupName);\n\t\tbutton.setAttribute('id', buttonNames[i]);\n\t\tbutton.setAttribute('value', buttonNames[i]);\n\t\tbottomLevel.appendChild(button);\n\t\tmidLevel.appendChild(bottomLevel);\n\t\tconst label = document.createElement('label');\n\t\tlabel.setAttribute('for', buttonNames[i]);\n\t\tconst txtNode = document.createTextNode(' ' + buttonNames[i]);\n\t\tlabel.appendChild(txtNode);\n\t\tbottomLevel.appendChild(label);\n\t\tnewTable.appendChild(midLevel);\n\t\tbuttonList.push(button);\n\t}\n\n\tif (!group) {\n\t\tconst topLevelTableEntry = document.createElement('td');\n\t\ttopLevelTableEntry.appendChild(newTable);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(topLevelTableEntry);\n\t} else {\n\t\tgroup.appendChild(newTable);\n\t\tnewTable.setAttribute('class', 'groupChild');\n\t}\n\n\treturn buttonList;\n}\n\nexport function addControlToAlgorithmBar(type, value, group) {\n\tconst element = document.createElement('input');\n\n\telement.setAttribute('type', type);\n\telement.setAttribute('value', value);\n\n\tif (!group) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(element);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tgroup.appendChild(element);\n\t\telement.setAttribute('class', 'groupChild');\n\t}\n\n\treturn element;\n}\n\nexport function addDivisorToAlgorithmBar() {\n\tconst divisorLeft = document.createElement('td');\n\tdivisorLeft.setAttribute('class', 'divisorLeft');\n\n\tconst divisorRight = document.createElement('td');\n\tdivisorRight.setAttribute('class', 'divisorRight');\n\n\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\tcontrolBar.appendChild(divisorLeft);\n\tcontrolBar.appendChild(divisorRight);\n}\n\nexport function addGroupToAlgorithmBar(horizontal, parentGroup) {\n\tconst group = document.createElement('div');\n\n\tgroup.setAttribute('class', horizontal ? 'hgroup' : 'vgroup');\n\n\tif (!parentGroup) {\n\t\tconst tableEntry = document.createElement('td');\n\t\ttableEntry.appendChild(group);\n\n\t\tconst controlBar = document.getElementById('AlgorithmSpecificControls');\n\t\tcontrolBar.appendChild(tableEntry);\n\t} else {\n\t\tparentGroup.appendChild(group);\n\t}\n\n\treturn group;\n}\n\nexport default class Algorithm {\n\tconstructor(am, w, h) {\n\t\tif (am == null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.animationManager = am;\n\t\tam.addListener('AnimationStarted', this, this.disableUI);\n\t\tam.addListener('AnimationEnded', this, this.enableUI);\n\t\tam.addListener('AnimationUndo', this, this.undo);\n\t\tthis.canvasWidth = w;\n\t\tthis.canvasHeight = h;\n\n\t\tthis.actionHistory = [];\n\t\tthis.recordAnimation = true;\n\t\tthis.commands = [];\n\t}\n\n\taddCodeToCanvasBase(code, start_x, start_y, line_height, standard_color, layer) {\n\t\tlayer = typeof layer !== 'undefined' ? layer : 0;\n\t\tconst codeID = Array(code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < code.length; i++) {\n\t\t\tcodeID[i] = new Array(code[i].length);\n\t\t\tfor (j = 0; j < code[i].length; j++) {\n\t\t\t\tcodeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tcodeID[i][j],\n\t\t\t\t\tcode[i][j],\n\t\t\t\t\tstart_x,\n\t\t\t\t\tstart_y + i * line_height,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, codeID[i][j], standard_color);\n\t\t\t\tthis.cmd(act.setLayer, codeID[i][j], layer);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, codeID[i][j], codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn codeID;\n\t}\n\n\tsetCodeAlpha(code, newAlpha) {\n\t\tfor (let i = 0; i < code.length; i++) {\n\t\t\tfor (let j = 0; j < code[i].length; j++) {\n\t\t\t\tthis.cmd(act.setAlpha, code[i][j], newAlpha);\n\t\t\t}\n\t\t}\n\t}\n\n\tcmd(act, ...params) {\n\t\t// Helper method to add command to stack\n\t\tif (this.recordAnimation) {\n\t\t\tthis.commands.push([act, params]);\n\t\t}\n\t}\n\n\tclearHistory() {\n\t\tthis.actionHistory = [];\n\t}\n\n\tundo() {\n\t\t// Remove the last action (the one that we are going to undo)\n\t\tthis.actionHistory.pop();\n\t\t// Clear out our data structure.  Be sure to implement reset in\n\t\t// every AlgorithmAnimation subclass!\n\t\tthis.reset();\n\t\t//  Redo all actions from the beginning, throwing out the animation\n\t\t//  commands (the animation manager will update the animation on its own).\n\t\t//  Note that if you do something non-deterministic, you might cause problems!\n\t\t//  Be sure if you do anything non-deterministic (that is, calls to a random\n\t\t//  number generator) you clear out the undo stack here and in the animation\n\t\t//  manager.\n\n\t\t//  If this seems horribly inefficient -- it is! However, it seems to work well\n\t\t//  in practice, and you get undo for free for all algorithms, which is a non-trivial\n\t\t//  gain.\n\t\tconst len = this.actionHistory.length;\n\t\tthis.recordAnimation = false;\n\t\tfor (let i = 0; i < len; i++) {\n\t\t\tthis.actionHistory[i][0](this.actionHistory[i][1]);\n\t\t}\n\t\tthis.recordAnimation = true;\n\t}\n\n\timplementAction(func, ...args) {\n\t\tconst next = [func, args];\n\t\tthis.actionHistory.push(next);\n\t\tconst retVal = func(...args);\n\t\tthis.animationManager.startNewAnimation(retVal);\n\t}\n\n\tnormalizeNumber(input, maxLen) {\n\t\tconst isAllDigits = str => !/\\D/.test(str);\n\t\tif (!isAllDigits(input) || input === '') {\n\t\t\treturn input;\n\t\t}\n\t\treturn input.substr(-maxLen);\n\t}\n\n\treturnSubmit(field, funct, maxsize, intOnly) {\n\t\tif (maxsize !== undefined) {\n\t\t\tfield.size = maxsize;\n\t\t}\n\t\treturn function(event) {\n\t\t\tlet keyASCII = 0;\n\t\t\tif (window.event) {\n\t\t\t\t// IE\n\t\t\t\tkeyASCII = event.keyCode;\n\t\t\t} else if (event.which) {\n\t\t\t\t// Netscape/Firefox/Opera\n\t\t\t\tkeyASCII = event.which;\n\t\t\t}\n\n\t\t\tif (keyASCII === 13 && funct != null) {\n\t\t\t\tfunct();\n\t\t\t} else if (\n\t\t\t\tkeyASCII === 190 ||\n\t\t\t\tkeyASCII === 59 ||\n\t\t\t\tkeyASCII === 173 ||\n\t\t\t\tkeyASCII === 189\n\t\t\t) {\n\t\t\t\treturn false;\n\t\t\t} else if (\n\t\t\t\t(maxsize !== undefined && field.value.length >= maxsize) ||\n\t\t\t\t(intOnly && (keyASCII < 48 || keyASCII > 57))\n\t\t\t) {\n\t\t\t\tif (!controlKey(keyASCII)) return false;\n\t\t\t}\n\t\t};\n\t}\n\n\t// Abstract methods - these should be implemented in the base class\n\n\t// eslint-disable-next-line no-unused-vars\n\tsizeChanged(newWidth, newHeight) {\n\t\tthrow new Error('sizeChanged() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tdisableUI(event) {\n\t\tthrow new Error('disableUI() should be implemented in base class');\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\tenableUI(event) {\n\t\tthrow new Error('enableUI() should be implemented in base class');\n\t}\n\n\treset() {\n\t\tthrow new Error('reset() should be implemented in base class');\n\t}\n}\n\nexport function controlKey(keyASCII) {\n\treturn (\n\t\tkeyASCII === 8 ||\n\t\tkeyASCII === 9 ||\n\t\tkeyASCII === 37 ||\n\t\tkeyASCII === 38 ||\n\t\tkeyASCII === 39 ||\n\t\tkeyASCII === 40 ||\n\t\tkeyASCII === 46\n\t);\n}\n\nAlgorithm.prototype.returnSubmitFloat = function(field, funct, maxsize) {\n\tif (maxsize !== undefined) {\n\t\tfield.size = maxsize;\n\t}\n\treturn function(event) {\n\t\tlet keyASCII = 0;\n\t\tif (window.event) {\n\t\t\t// IE\n\t\t\tkeyASCII = event.keyCode;\n\t\t} else if (event.which) {\n\t\t\t// Netscape/Firefox/Opera\n\t\t\tkeyASCII = event.which;\n\t\t}\n\t\t// Submit on return\n\t\tif (keyASCII === 13) {\n\t\t\tfunct();\n\t\t}\n\t\t// Control keys (arrows, del, etc) are always OK\n\t\telse if (controlKey(keyASCII)) {\n\t\t\treturn;\n\t\t}\n\t\t// - (minus sign) only OK at beginning of number\n\t\t//  (For now we will allow anywhere -- hard to see where the beginning of the\n\t\t//   number is ...)\n\t\t//else if (keyASCII == 109 && field.value.length  == 0)\n\t\telse if (keyASCII === 109) {\n\t\t\treturn;\n\t\t}\n\t\t// Digis are OK if we have enough space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII >= 48 &&\n\t\t\tkeyASCII <= 57\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// . (Decimal point) is OK if we haven't had one yet, and there is space\n\t\telse if (\n\t\t\t(maxsize !== undefined || field.value.length < maxsize) &&\n\t\t\tkeyASCII === 190 &&\n\t\t\tfield.value.indexOf('.') === -1\n\t\t) {\n\t\t\treturn;\n\t\t}\n\t\t// Nothing else is OK\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t};\n};\n\nAlgorithm.prototype.addReturnSubmit = function(field, action) {\n\tfield.onkeydown = this.returnSubmit(field, action, 4, false);\n};\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class AVL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * AVL.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.cmd(act.createLabel, 0, '', AVL.EXPLANITORY_TEXT_X, AVL.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor'\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tlet findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tfindValue = this.normalizeNumber(findValue, 4);\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, AVL.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += AVL.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = AVL.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += AVL.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searchiing for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tAVL.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t' Searching for ' + value + ' : < Empty Tree > (Element not found)'\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, ' Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, ' Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tconst heightLabelID = this.nextIndex++;\n\t\t\tconst bfLabelID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, AVL.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, AVL.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, AVL.BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.createLabel, heightLabelID, 0, 30 - 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, heightLabelID, AVL.HEIGHT_LABEL_COLOR);\n\n\t\t\tthis.cmd(act.createLabel, bfLabelID, 0, 30 + 20, AVL.STARTING_Y - 20);\n\t\t\tthis.cmd(act.setForegroundColor, bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new AVLNode(data, treeNodeID, heightLabelID, bfLabelID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, AVL.LINK_COLOR);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tbalance(curr) {\n\t\tcurr.updateHeightAndBF();\n\t\tthis.cmd(act.setText, curr.heightLabelID, curr.height);\n\t\tthis.cmd(act.setText, curr.bfLabelID, curr.bf);\n\t\tthis.cmd(act.setText, 0, 'Adjusting height and balance factor after recursive call');\n\t\tthis.cmd(act.step);\n\n\t\tif (curr.bf < -1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor < -1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.right != null && curr.right.bf > 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor > 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Right-left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.right = this.singleRotateRight(curr.right);\n\t\t\t} else {\n\t\t\t\tif (curr.right != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Right child balance factor <= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No right child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.right.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateLeft(curr);\n\t\t} else if (curr.bf > 1) {\n\t\t\tthis.cmd(act.setText, 0, 'Balance factor > 1');\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tif (curr.left != null && curr.left.bf < 0) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor < 0');\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Left-right rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t\tcurr.left = this.singleRotateLeft(curr.left);\n\t\t\t} else {\n\t\t\t\tif (curr.left != null) {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'Left child balance factor >= 0');\n\t\t\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HIGHLIGHT_LABEL_COLOR);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, 'No left child');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, 0, 'Left rotation');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setTextColor, curr.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tthis.cmd(act.setTextColor, curr.left.bfLabelID, AVL.HEIGHT_LABEL_COLOR);\n\t\t\tcurr = this.singleRotateRight(curr);\n\t\t}\n\t\treturn curr;\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\tconst A = tree.left;\n\t\tconst t2 = A.right;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\tA.parent = B.parent;\n\t\tif (this.treeRoot === B) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tthis.resizeTree();\n\t\treturn A;\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst t2 = B.left;\n\n\t\t// this.cmd(act.setText, 0, 'Single Rotate Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, AVL.LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\tB.parent = A.parent;\n\t\tif (this.treeRoot === A) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, AVL.LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, AVL.LINK_COLOR);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\t\tthis.cmd(act.setHighlight, A.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, B.graphicID, 0);\n\t\tA.updateHeightAndBF();\n\t\tthis.cmd(act.setText, A.heightLabelID, A.height);\n\t\tthis.cmd(act.setText, A.bfLabelID, A.bf);\n\t\tB.updateHeightAndBF();\n\t\tthis.cmd(act.setText, B.heightLabelID, B.height);\n\t\tthis.cmd(act.setText, B.bfLabelID, B.bf);\n\n\t\tthis.resizeTree();\n\t\treturn B;\n\t}\n\n\tgetHeight(tree) {\n\t\tif (tree == null) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn tree.height;\n\t}\n\n\tresetHeight(tree) {\n\t\tif (tree != null) {\n\t\t\tconst newHeight = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\tif (tree.height !== newHeight) {\n\t\t\t\ttree.height = Math.max(this.getHeight(tree.left), this.getHeight(tree.right)) + 1;\n\t\t\t\tthis.cmd(act.setText, tree.heightLabelID, newHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tthis.cmd(act.step);\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tcurr = this.balance(curr);\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, AVL.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t} else {\n\t\t\t\ttree.heightLabelX = xPosition - 20;\n\t\t\t\ttree.bfLabelX = xPosition + 20;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\ttree.heightLabelY = tree.y - 20;\n\t\t\ttree.bfLabelY = tree.y - 20;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + AVL.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + AVL.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.cmd(act.move, tree.heightLabelID, tree.heightLabelX, tree.heightLabelY);\n\t\t\tthis.cmd(act.move, tree.bfLabelID, tree.bfLabelX, tree.bfLabelY);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), AVL.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), AVL.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.cmd(act.delete, curr.heightLabelID);\n\t\t\tthis.cmd(act.delete, curr.bfLabelID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass AVLNode {\n\tconstructor(val, id, hid, bfid, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.heightLabelID = hid;\n\t\tthis.bfLabelID = bfid;\n\t\tthis.height = 0;\n\t\tthis.bf = 0;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tupdateHeightAndBF() {\n\t\tconst h = node => (node == null ? -1 : node.height);\n\t\tconst l = h(this.left);\n\t\tconst r = h(this.right);\n\t\tthis.height = Math.max(l, r) + 1;\n\t\tthis.bf = l - r;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n\n// Various constants\n\nAVL.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nAVL.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nAVL.HIGHLIGHT_COLOR = '#007700';\nAVL.HEIGHT_LABEL_COLOR = '#007700';\n\nAVL.LINK_COLOR = '#00B000';\nAVL.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nAVL.FOREGROUND_COLOR = '#007700';\nAVL.BACKGROUND_COLOR = '#DDFFDD';\nAVL.PRINT_COLOR = AVL.FOREGROUND_COLOR;\n\nAVL.WIDTH_DELTA = 50;\nAVL.HEIGHT_DELTA = 50;\nAVL.STARTING_Y = 50;\n\nAVL.FIRST_PRINT_POS_X = 50;\nAVL.PRINT_VERTICAL_GAP = 20;\nAVL.PRINT_HORIZONTAL_GAP = 50;\nAVL.EXPLANITORY_TEXT_X = 10;\nAVL.EXPLANITORY_TEXT_Y = 10;\n","/* eslint-disable lines-between-class-members */\n// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRRAY_ELEMS_PER_LINE = 15;\nconst ARRAY_LINE_SPACING = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 10;\n\nexport default class ArrayList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front', addBottomHorizontalGroup);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back', addBottomHorizontalGroup);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index', addBottomHorizontalGroup);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index', removeTopHorizontalGroup);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front', removeBottomHorizontalGroup);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back', removeBottomHorizontalGroup);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayData[i] = 0;\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\n\t\tthis.size = 0;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.size = 0;\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayData[i] = 0;\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.highlight1ID = this.nextIndex++;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\tthis.size < SIZE\n\t\t) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tconst presentID = this.nextIndex + i;\n\t\t\tthis.cmd(act.createLabel, presentID, this.arrayData[i + 1], xpos, ypos);\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.cmd(act.move, presentID, xpos + ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tconst presentID = this.nextIndex + i;\n\t\t\tthis.cmd(act.setText, this.arrayID[i + 1], this.arrayData[i + 1]);\n\t\t\tthis.cmd(act.delete, presentID);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.nextIndex += this.size - index;\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlight1ID,\n\t\t\t'#0000FF',\n\t\t\tPUSH_ELEMENT_X,\n\t\t\tPUSH_ELEMENT_Y\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (parseInt(index) % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(parseInt(index) / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING +\n\t\t\tARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos);\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.size = this.size + 1;\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tconst xpos = (index % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos = Math.floor(index / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', xpos, ypos);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[index], '');\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos - 100);\n\t\tthis.cmd(act.move, labPopValID, xpos, ypos - 100);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tconst presentID = this.nextIndex + i;\n\t\t\tthis.cmd(act.createLabel, presentID, this.arrayData[i], xpos, ypos);\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t\tthis.cmd(act.move, presentID, xpos - ARRAY_ELEM_WIDTH, ypos);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index + 1; i < this.size; i++) {\n\t\t\tconst presentID = this.nextIndex + i;\n\t\t\tthis.cmd(act.setText, this.arrayID[i - 1], this.arrayData[i]);\n\t\t\tthis.cmd(act.delete, presentID);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\n\t\tthis.size = this.size - 1;\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}","const LARGE_ALLOWED = [[false, true, true, false, true, false, false, true, false, false, false, false, false, false, true, false, false, false],\n\t\t\t\t\t\t\t\t\t[true, false, true, false, true, true,  false, false, false, false, false, false, false, false, false, false, false, false],\n\t\t\t\t\t\t\t\t\t[true, true, false, true,  false, true, true,  false, false, false, false, false, false, false, false, false, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, true, false, false,false, true, false, false, false, true, false, false,  false, false, false, false, true],\n\t\t\t\t\t\t\t\t\t[true, true, false, false,  false, true, false, true, true, false, false, false, false, false, false, false,  false,  false],\n\t\t\t\t\t\t\t\t\t[false, true, true, false, true, false, true,   false, true, true, false, false, false, false, false, false,  false,  false],\n\t\t\t\t\t\t\t\t\t[false, false, true, true, false, true, false, false, false, true, true, false, false, false, false, false,  false,  false],\n\t\t\t\t\t\t\t\t\t[true, false, false, false, true, false, false, false, true, false, false, true, false, false, true, false, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, true, true, false, true, false, true, false, true, true, false,   false, false, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, true, true, false, true, false, true, false, true, true,  false,  false, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, true, false,  false, true, false, false, true, false, false, false, true, false, false, false, true],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, true, true, false, false, false, true, false, true, true, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, true, true, false, true, false, true, false, true, true, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, true, true, false, true, false, false, false, true, true],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, true, false, false, false, true, false, false, false, true, false, false],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, false, true, true, false, true, false, true, true],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, false, false, true, true, false, true, false, true],\n\t\t\t\t\t\t\t\t\t[false, false, false, false, false, false, false, false, false, false, true, false, false, true, false, true, true, false]];\n\nconst LARGE_CURVE  = [[0, 0, -0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.25, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.25],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[-0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.4],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0.25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.4, 0, 0]]\n\n\n\nconst LARGE_X_POS_LOGICAL = [600, 700, 800, 900,\n\t\t\t\t\t\t\t\t\t\t650, 750, 850,\n\t\t\t\t\t\t\t\t\t\t600, 700, 800, 900,\n\t\t\t\t\t\t\t\t\t\t650, 750, 850,\n\t\t\t\t\t\t\t\t\t\t600, 700, 800, 900];\n\n\nconst LARGE_Y_POS_LOGICAL = [50, 50, 50, 50,\n\t\t\t\t\t\t\t\t\t\t150, 150, 150,\n\t\t\t\t\t\t\t\t\t\t250, 250, 250, 250,\n\t\t\t\t\t\t\t\t\t\t350, 350, 350,\n\t\t\t\t\t\t\t\t\t\t450,  450, 450, 450];\n\n\nconst SMALL_ALLLOWED = [[false, true,  true,  true,  true,  false, false, false],\n\t\t\t\t\t\t\t\t\t[true,  false, true,  true,  false, true,  true,  false],\n\t\t\t\t\t\t\t\t\t[true,  true,  false, false, true,  true,  true,  false],\n\t\t\t\t\t\t\t\t\t[true,  true,  false, false, false, true,  false, true],\n\t\t\t\t\t\t\t\t\t[true,  false, true,  false, false,  false, true,  true],\n\t\t\t\t\t\t\t\t\t[false, true,  true,  true,  false, false, true,  true],\n\t\t\t\t\t\t\t\t\t[false, true,  true,  false, true,  true,  false, true],\n\t\t\t\t\t\t\t\t\t[false, false, false, true,  true,  true,  true,  false]];\n\nconst SMALL_CURVE = [[0, 0.001, 0, 0.5, -0.5, 0, 0, 0],\n\t\t\t\t\t\t\t\t[0, 0, 0, 0.001, 0, 0.001, -0.2, 0],\n\t\t\t\t\t\t\t\t[0, 0.001, 0, 0, 0, 0.2, 0, 0],\n\t\t\t\t\t\t\t\t[-0.5, 0, 0, 0, 0, 0.001, 0, 0.5],\n\t\t\t\t\t\t\t\t[0.5, 0, 0, 0, 0, 0, 0, -0.5],\n\t\t\t\t\t\t\t\t[0, 0, -0.2, 0, 0, 0, 0.001, 0.001],\n\t\t\t\t\t\t\t\t[0, 0.2, 0, 0, 0, 0, 0, 0],\n                                [0, 0, 0, -0.5, 0.5, 0, 0, 0]];\n                                \n                                \nconst SMALL_X_POS_LOGICAL = [800, 725, 875, 650, 950, 725, 875, 800];\nconst SMALL_Y_POS_LOGICAL = [25, 125, 125, 225, 225, 325, 325, 425];\n\nexport { LARGE_ALLOWED, LARGE_CURVE, LARGE_X_POS_LOGICAL, LARGE_Y_POS_LOGICAL, SMALL_X_POS_LOGICAL, SMALL_Y_POS_LOGICAL, SMALL_ALLLOWED, SMALL_CURVE };","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\n// TODO:  UNDO (all the way) is BROKEN.  Redo reset ...\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport {\n\tLARGE_ALLOWED,\n\tLARGE_CURVE,\n\tLARGE_X_POS_LOGICAL,\n\tLARGE_Y_POS_LOGICAL,\n\tSMALL_ALLLOWED,\n\tSMALL_CURVE,\n\tSMALL_X_POS_LOGICAL,\n\tSMALL_Y_POS_LOGICAL,\n} from './util/GraphUtil.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SMALL_ADJ_MATRIX_X_START = 700;\nconst SMALL_ADJ_MATRIX_Y_START = 45;\nconst SMALL_ADJ_MATRIX_WIDTH = 30;\nconst SMALL_ADJ_MATRIX_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_X_START = 600;\nconst SMALL_ADJ_LIST_Y_START = 30;\n\nconst SMALL_ADJ_LIST_ELEM_WIDTH = 80;\nconst SMALL_ADJ_LIST_ELEM_HEIGHT = 30;\n\nconst SMALL_ADJ_LIST_HEIGHT = 36;\nconst SMALL_ADJ_LIST_WIDTH = 36;\n\nconst SMALL_ADJ_LIST_SPACING_AFTER_LIST = 15;\nconst SMALL_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nconst LARGE_ADJ_MATRIX_X_START = 575;\nconst LARGE_ADJ_MATRIX_Y_START = 40;\nconst LARGE_ADJ_MATRIX_WIDTH = 23;\nconst LARGE_ADJ_MATRIX_HEIGHT = 23;\n\nconst LARGE_ADJ_LIST_X_START = 600;\nconst LARGE_ADJ_LIST_Y_START = 30;\n\nconst LARGE_ADJ_LIST_ELEM_WIDTH = 80;\nconst LARGE_ADJ_LIST_ELEM_HEIGHT = 20;\n\nconst LARGE_ADJ_LIST_HEIGHT = 25;\nconst LARGE_ADJ_LIST_WIDTH = 20;\n\nconst LARGE_ADJ_LIST_SPACING_AFTER_LIST = 25;\nconst LARGE_ADJ_LIST_SPACING_BETWEEN_NODES = 15;\n\nexport const VERTEX_INDEX_COLOR = '#0000FF';\nexport const EDGE_COLOR = '#000000';\n\nexport const SMALL_SIZE = 8;\nexport const LARGE_SIZE = 18;\n\nexport default class Graph extends Algorithm {\n\tconstructor(am, w, h, dir, dag, costs) {\n\t\tsuper(am, w, h);\n\t\tdir = dir === undefined ? true : dir;\n\t\tdag = dag === undefined ? false : dag;\n\t\tcosts = costs === undefined ? false : costs;\n\n\t\tthis.nextIndex = 0;\n\n\t\tthis.currentLayer = 1;\n\t\tthis.directed = dir;\n\t\tthis.isDAG = dag;\n\t\tthis.showEdgeCosts = costs;\n\t\tthis.currentLayer = 1;\n\t\tthis.addControls();\n\n\t\tthis.setup_small();\n\t}\n\n\taddControls(addDirection) {\n\t\tif (addDirection == null) {\n\t\t\taddDirection = true;\n\t\t}\n\t\tthis.newGraphButton = addControlToAlgorithmBar('Button', 'New Graph');\n\t\tthis.newGraphButton.onclick = this.newGraphCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tif (addDirection) {\n\t\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t\t['Undirected Graph', 'Directed Graph'],\n\t\t\t\t'GraphType'\n\t\t\t);\n\t\t\tthis.undirectedGraphButton = radioButtonList[0];\n\t\t\tthis.undirectedGraphButton.onclick = this.directedGraphCallback.bind(this, false);\n\t\t\tthis.undirectedGraphButton.checked = !this.directed;\n\t\t\tthis.directedGraphButton = radioButtonList[1];\n\t\t\tthis.directedGraphButton.onclick = this.directedGraphCallback.bind(this, true);\n\t\t\tthis.directedGraphButton.checked = this.directed;\n\n\t\t\taddDivisorToAlgorithmBar();\n\t\t}\n\n\t\tlet radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Small Graph', 'Large Graph'],\n\t\t\t'GraphSize'\n\t\t);\n\t\tthis.smallGraphButton = radioButtonList[0];\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.largeGraphButton = radioButtonList[1];\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t\tthis.smallGraphButton.checked = true;\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tradioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Logical Representation',\n\t\t\t\t'Adjacency List Representation',\n\t\t\t\t'Adjacency Matrix Representation',\n\t\t\t],\n\t\t\t'GraphRepresentation'\n\t\t);\n\t\tthis.logicalButton = radioButtonList[0];\n\t\tthis.logicalButton.onclick = this.graphRepChangedCallback.bind(this, 1);\n\t\tthis.adjacencyListButton = radioButtonList[1];\n\t\tthis.adjacencyListButton.onclick = this.graphRepChangedCallback.bind(this, 2);\n\t\tthis.adjacencyMatrixButton = radioButtonList[2];\n\t\tthis.adjacencyMatrixButton.onclick = this.graphRepChangedCallback.bind(this, 3);\n\t\tthis.logicalButton.checked = true;\n\t}\n\n\tdirectedGraphCallback(newDirected) {\n\t\tif (newDirected !== this.directed) {\n\t\t\tthis.directed = newDirected;\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup();\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tnewGraphCallback() {\n\t\tthis.animationManager.resetAll();\n\t\tthis.setup();\n\t}\n\n\tgraphRepChangedCallback(newLayer) {\n\t\tthis.animationManager.setAllLayers([0, newLayer]);\n\t\tthis.currentLayer = newLayer;\n\t}\n\n\trecolorGraph() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.setEdgeColor(i, j, EDGE_COLOR);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thighlightEdge(i, j, highlightVal) {\n\t\tthis.cmd(act.setHighlight, this.adj_list_edges[i][j], highlightVal);\n\t\tthis.cmd(act.setHighlight, this.adj_matrixID[i][j], highlightVal);\n\t\tthis.cmd(act.setEdgeHighlight, this.circleID[i], this.circleID[j], highlightVal);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeHighlight, this.circleID[j], this.circleID[i], highlightVal);\n\t\t}\n\t}\n\n\tsetEdgeColor(i, j, color) {\n\t\tthis.cmd(act.setForegroundColor, this.adj_list_edges[i][j], color);\n\t\tthis.cmd(act.setTextColor, this.adj_matrixID[i][j], color);\n\t\tthis.cmd(act.setEdgeColor, this.circleID[i], this.circleID[j], color);\n\t\tif (!this.directed) {\n\t\t\tthis.cmd(act.setEdgeColor, this.circleID[j], this.circleID[i], color);\n\t\t}\n\t}\n\n\tclearEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[i], this.circleID[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trebuildEdges() {\n\t\tthis.clearEdges();\n\t\tthis.buildEdges();\n\t}\n\n\tbuildEdges() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tconst edgeLabel = this.showEdgeCosts ? String(this.adj_matrix[i][j]) : '';\n\t\t\t\t\tif (this.directed) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t\tthis.adj_matrix[j][i] >= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tedgeLabel\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (i < j) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tedgeLabel\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetup_small() {\n\t\tthis.allowed = SMALL_ALLLOWED;\n\t\tthis.curve = SMALL_CURVE;\n\t\tthis.x_pos_logical = SMALL_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = SMALL_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = SMALL_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = SMALL_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = SMALL_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = SMALL_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = SMALL_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = SMALL_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = SMALL_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = SMALL_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = SMALL_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = SMALL_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = SMALL_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = SMALL_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = SMALL_SIZE;\n\t\tthis.setup();\n\t}\n\n\tsetup_large() {\n\t\tthis.allowed = LARGE_ALLOWED;\n\t\tthis.curve = LARGE_CURVE;\n\t\tthis.x_pos_logical = LARGE_X_POS_LOGICAL;\n\t\tthis.y_pos_logical = LARGE_Y_POS_LOGICAL;\n\t\tthis.adj_matrix_x_start = LARGE_ADJ_MATRIX_X_START;\n\t\tthis.adj_matrix_y_start = LARGE_ADJ_MATRIX_Y_START;\n\t\tthis.adj_matrix_width = LARGE_ADJ_MATRIX_WIDTH;\n\t\tthis.adj_matrix_height = LARGE_ADJ_MATRIX_HEIGHT;\n\t\tthis.adj_list_x_start = LARGE_ADJ_LIST_X_START;\n\t\tthis.adj_list_y_start = LARGE_ADJ_LIST_Y_START;\n\t\tthis.adj_list_elem_width = LARGE_ADJ_LIST_ELEM_WIDTH;\n\t\tthis.adj_list_elem_height = LARGE_ADJ_LIST_ELEM_HEIGHT;\n\t\tthis.adj_list_height = LARGE_ADJ_LIST_HEIGHT;\n\t\tthis.adj_list_width = LARGE_ADJ_LIST_WIDTH;\n\t\tthis.adj_list_spacing_after_list = LARGE_ADJ_LIST_SPACING_AFTER_LIST;\n\t\tthis.adj_list_spacing_between_nodes = LARGE_ADJ_LIST_SPACING_BETWEEN_NODES;\n\t\tthis.size = LARGE_SIZE;\n\t\tthis.setup();\n\t}\n\n\tadjustCurveForDirectedEdges(curve, bidirectional) {\n\t\tif (!this.directed || !bidirectional || Math.abs(curve) > 0.01) {\n\t\t\treturn curve;\n\t\t} else {\n\t\t\treturn 0.1;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\t\tthis.circleID = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.circleID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleID[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tthis.x_pos_logical[i],\n\t\t\t\tthis.y_pos_logical[i]\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.circleID[i], VERTEX_INDEX_COLOR, 0);\n\n\t\t\tthis.cmd(act.setLayer, this.circleID[i], 1);\n\t\t}\n\n\t\tthis.adj_matrix = new Array(this.size);\n\t\tthis.adj_matrixID = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_matrix[i] = new Array(this.size);\n\t\t\tthis.adj_matrixID[i] = new Array(this.size);\n\t\t}\n\n\t\tlet edgePercent;\n\t\tif (this.size === SMALL_SIZE) {\n\t\t\tif (this.directed) {\n\t\t\t\tedgePercent = 0.4;\n\t\t\t} else {\n\t\t\t\tedgePercent = 0.5;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.directed) {\n\t\t\t\tedgePercent = 0.35;\n\t\t\t} else {\n\t\t\t\tedgePercent = 0.6;\n\t\t\t}\n\t\t}\n\n\t\tif (this.directed) {\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.allowed[i][j] &&\n\t\t\t\t\t\tMath.random() <= edgePercent &&\n\t\t\t\t\t\t(i < j ||\n\t\t\t\t\t\t\tMath.abs(this.curve[i][j]) < 0.01 ||\n\t\t\t\t\t\t\tthis.adj_matrixID[j][i] === -1) &&\n\t\t\t\t\t\t(!this.isDAG || i < j)\n\t\t\t\t\t) {\n\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.buildEdges();\n\t\t} else {\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tfor (let j = i + 1; j < this.size; j++) {\n\t\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\t\tthis.adj_matrixID[j][i] = this.nextIndex++;\n\n\t\t\t\t\tif (this.allowed[i][j] && Math.random() <= edgePercent) {\n\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = Math.floor(Math.random() * 9) + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.adj_matrix[i][j] = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.adj_matrix[j][i] = this.adj_matrix[i][j];\n\t\t\t\t\t\tlet edgeLabel;\n\t\t\t\t\t\tif (this.showEdgeCosts) {\n\t\t\t\t\t\t\tedgeLabel = String(this.adj_matrix[i][j]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tedgeLabel = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[i],\n\t\t\t\t\t\t\tthis.circleID[j],\n\t\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t\tthis.curve[i][j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tedgeLabel\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.adj_matrix[i][j] = -1;\n\t\t\t\t\t\tthis.adj_matrix[j][i] = -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.buildEdges();\n\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tthis.adj_matrix[i][i] = -1;\n\t\t\t}\n\t\t}\n\n\t\t// Create Adj List\n\n\t\tthis.buildAdjList();\n\n\t\t// Create Adj Matrix\n\n\t\tthis.buildAdjMatrix();\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.clearHistory();\n\t}\n\n\tresetAll() {}\n\n\tbuildAdjMatrix() {\n\t\tthis.adj_matrix_index_x = new Array(this.size);\n\t\tthis.adj_matrix_index_y = new Array(this.size);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_matrix_index_x[i] = this.nextIndex++;\n\t\t\tthis.adj_matrix_index_y[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_x[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tthis.adj_matrix_x_start + i * this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start - this.adj_matrix_height\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_x[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_matrix_index_y[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_matrix_index_y[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_x[i], 3);\n\t\t\tthis.cmd(act.setLayer, this.adj_matrix_index_y[i], 3);\n\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.adj_matrixID[i][j] = this.nextIndex++;\n\t\t\t\tlet lab;\n\t\t\t\tif (this.adj_matrix[i][j] < 0) {\n\t\t\t\t\tlab = '';\n\t\t\t\t} else {\n\t\t\t\t\tlab = String(this.adj_matrix[i][j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.adj_matrixID[i][j],\n\t\t\t\t\tlab,\n\t\t\t\t\tthis.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_height,\n\t\t\t\t\tthis.adj_matrix_x_start + j * this.adj_matrix_width,\n\t\t\t\t\tthis.adj_matrix_y_start + i * this.adj_matrix_height\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setLayer, this.adj_matrixID[i][j], 3);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAdjList() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.adj_list_list[i], 'RAL1');\n\t\t\tthis.cmd(act.delete, this.adj_list_index[i], 'RAL2');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\n\t\t\t\t\tthis.cmd(act.delete, this.adj_list_edges[i][j], 'RAL3');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildAdjList() {\n\t\tthis.adj_list_index = new Array(this.size);\n\t\tthis.adj_list_list = new Array(this.size);\n\t\tthis.adj_list_edges = new Array(this.size);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_edges[i] = new Array(this.size);\n\t\t\tthis.adj_list_index[i] = this.nextIndex++;\n\t\t\tthis.adj_list_list[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.adj_list_list[i],\n\t\t\t\t'',\n\t\t\t\tthis.adj_list_width,\n\t\t\t\tthis.adj_list_height,\n\t\t\t\tthis.adj_list_x_start,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_list[i], 2);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.adj_list_index[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.adj_list_index[i], VERTEX_INDEX_COLOR);\n\t\t\tthis.cmd(act.setLayer, this.adj_list_index[i], 2);\n\t\t\tlet lastElem = this.adj_list_list[i];\n\t\t\tlet nextXPos =\n\t\t\t\tthis.adj_list_x_start +\n\t\t\t\tthis.adj_list_width +\n\t\t\t\tthis.adj_list_spacing_after_list +\n\t\t\t\tthis.adj_list_spacing_between_nodes;\n\t\t\tlet hasEdges = false;\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] > 0) {\n\t\t\t\t\thasEdges = true;\n\t\t\t\t\tthis.adj_list_edges[i][j] = this.nextIndex++;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLinkedListNode,\n\t\t\t\t\t\tthis.adj_list_edges[i][j],\n\t\t\t\t\t\t[String.fromCharCode(65 + j), this.adj_matrix[i][j]],\n\t\t\t\t\t\tthis.adj_list_elem_width,\n\t\t\t\t\t\tthis.adj_list_elem_height,\n\t\t\t\t\t\tnextXPos,\n\t\t\t\t\t\tthis.adj_list_y_start + i * this.adj_list_height,\n\t\t\t\t\t\t0.25,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t1\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setNull, this.adj_list_edges[i][j], 1);\n\t\t\t\t\tthis.cmd(act.setTextColor, this.adj_list_edges[i][j], VERTEX_INDEX_COLOR, 0);\n\t\t\t\t\tthis.cmd(act.setLayer, this.adj_list_edges[i][j], 2);\n\n\t\t\t\t\tnextXPos = nextXPos + this.adj_list_elem_width + this.adj_list_spacing_between_nodes;\n\t\t\t\t\tthis.cmd(act.connect, lastElem, this.adj_list_edges[i][j]);\n\t\t\t\t\tthis.cmd(act.setNull, lastElem, 0);\n\t\t\t\t\tlastElem = this.adj_list_edges[i][j];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!hasEdges) {\n\t\t\t\tthis.cmd(act.setNull, this.adj_list_list[i], 1);\n\t\t\t}\n\t\t}\n\t}\n\n\t// Should be overwritten in child\n\treset() {\n\t\tthrow new Error('reset() should be implemented in child');\n\t}\n\n\tdisableUI() {\n\t\tthis.newGraphButton.disabled = true;\n\t\tif (this.directedGraphButton != null)\n\t\t\tthis.directedGraphButton.disabled = true;\n\t\tif (this.undirectedGraphButton != null)\n\t\t\tthis.undirectedGraphButton.disabled = true;\n\t\tthis.smallGraphButton.disabled = true;\n\t\tthis.largeGraphButton.disabled = true;\n\t}\n\n\tenableUI() {\n\t\tthis.newGraphButton.disabled = false;\n\t\tif (this.directedGraphButton != null)\n\t\t\tthis.directedGraphButton.disabled = false;\n\t\tif (this.undirectedGraphButton != null)\n\t\t\tthis.undirectedGraphButton.disabled = false;\n\t\tthis.smallGraphButton.disabled = false;\n\t\tthis.largeGraphButton.disabled = false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst TERMINATION_MSG_X = 25;\nconst TERMINATION_MSG_Y = 15;\n\nconst AUX_ARRAY_WIDTH = 25;\nconst AUX_ARRAY_HEIGHT = 25;\nconst AUX_ARRAY_START_Y = 50;\n\nconst VISITED_START_X = 475;\n\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\nconst BFS_TREE_COLOR = '#0000FF';\nconst BFS_QUEUE_HEAD_COLOR = '#0000FF';\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 70;\nconst LIST_SPACING = 20;\n\nconst CURRENT_VERTEX_LABEL_X = 25; \nconst CURRENT_VERTEX_LABEL_Y = 110;\nconst CURRENT_VERTEX_X = 115; \nconst CURRENT_VERTEX_Y = 116;\n\nconst QUEUE_START_X = 30;\nconst QUEUE_START_Y = 170;\nconst QUEUE_SPACING = 30;\n\nconst CHECKMARK = '\\u2713';\n\nexport default class BFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, false);\n\t\tthis.showEdgeCosts = false;\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run BFS');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visitedID = new Array(this.size);\n\t\tthis.visitedIndexID = new Array(this.size);\n\n\t\tthis.visited = [];\n\t\tthis.queueID = [];\n\t\tthis.listID = [];\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.visitedID[i] = this.nextIndex++;\n\t\t\tthis.visitedIndexID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.visitedID[i],\n\t\t\t\t'',\n\t\t\t\tAUX_ARRAY_WIDTH,\n\t\t\t\tAUX_ARRAY_HEIGHT,\n\t\t\t\tVISITED_START_X,\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.visitedIndexID[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.visitedIndexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.terminationLabelID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.terminationLabelID,\n\t\t\t'',\n\t\t\tTERMINATION_MSG_X,\n\t\t\tTERMINATION_MSG_Y,\n\t\t\t0\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited:',\n\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 30,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Queue:',\n\t\t\tQUEUE_START_X - 5,\n\t\t\tQUEUE_START_Y - 30,\n\t\t\t0\n\t\t);\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.messageID = [];\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tthis.implementAction(this.doBFS.bind(this), startvalue);\n\t\t\t}\n\t\t}\n\t}\n\n\tdoBFS(startVetex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.queue = new Array(this.size);\n\t\tthis.queueID = new Array(this.size);\n\t\tthis.listID = [];\n\t\tlet head = 0;\n\t\tlet tail = 0;\n\t\tlet queueSize = 0;\n\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.rebuildEdges();\n\t\tthis.messageID = [];\n\n\t\tthis.cmd(act.setText, this.terminationLabelID, '');\n\t\tlet vertex = startVetex;\n\t\tthis.visited[vertex] = true;\n\t\tthis.cmd(act.setText, this.visitedID[vertex], CHECKMARK);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], \"#99CCFF\");\n\t\tthis.queue[tail] = vertex;\n\t\tthis.queueID[tail] = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.queueID[tail],\n\t\t\tString.fromCharCode(65 + vertex),\n\t\t\tQUEUE_START_X,\n\t\t\tQUEUE_START_Y\n\t\t);\n\t\tqueueSize++;\n\t\ttail = (tail + 1) % this.size;\n\t\tthis.cmd(act.step);\n\n\t\twhile (queueSize > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.queue[head];\n\n\t\t\tthis.cmd(act.setTextColor, this.queueID[head], BFS_QUEUE_HEAD_COLOR);\n\t\t\tthis.cmd(act.move, this.queueID[head], CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\t\t\tfor (let i = 1; i < queueSize; i++) {\n\t\t\t\tconst nextQueueIndex = (i + head) % this.size;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.queueID[nextQueueIndex],\n\t\t\t\t\tQUEUE_START_X + (i - 1) * QUEUE_SPACING,\n\t\t\t\t\tQUEUE_START_Y\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tString.fromCharCode(65 + vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleL,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.x_pos_logical[vertex],\n\t\t\t\tthis.y_pos_logical[vertex]\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleL, 1);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleAL,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\tthis.adj_list_y_start + vertex * this.adj_list_height\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleAL, 2);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleAM,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start + vertex * this.adj_matrix_height\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleAM, 3);\n\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.cmd(act.setText, this.visitedID[neighbor], CHECKMARK);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], \"#99CCFF\")\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[vertex], this.circleID[neighbor]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[vertex],\n\t\t\t\t\t\t\tthis.circleID[neighbor],\n\t\t\t\t\t\t\tBFS_TREE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[vertex][neighbor],\n\t\t\t\t\t\t\t\tthis.adj_matrix[neighbor][vertex] >= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.directed,\n\t\t\t\t\t\t\t''\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.queue[tail] = neighbor;\n\t\t\t\t\t\tthis.queueID[tail] = this.nextIndex++;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.queueID[tail],\n\t\t\t\t\t\t\tString.fromCharCode(65 + neighbor),\n\t\t\t\t\t\t\tQUEUE_START_X + (queueSize - 1) * QUEUE_SPACING,\n\t\t\t\t\t\t\tQUEUE_START_Y\n\t\t\t\t\t\t);\n\t\t\t\t\t\ttail = (tail + 1) % this.size;\n\t\t\t\t\t\tqueueSize++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, this.queueID[head]);\n\t\t\thead = (head + 1) % this.size;\n\t\t\tqueueSize--;\n\n\t\t\tthis.cmd(act.delete, this.highlightCircleL);\n\t\t\tthis.cmd(act.delete, this.highlightCircleAM);\n\t\t\tthis.cmd(act.delete, this.highlightCircleAL);\n\t\t}\n\n\t\tif (queueSize > 0) {\n\t\t\tthis.cmd(act.setText, this.terminationLabelID, 'All vertices have been visited, done.');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.terminationLabelID, 'Queue is empty, done.');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], \"#FFFFFF\");\n\t\t\tthis.cmd(act.setText, this.visitedID[i], '');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t}\n\n\tenableUI(event) {\n\t\tthis.startField.disabled = false;\n\t\tthis.startButton.disabled = false;\n\n\t\tsuper.enableUI(event);\n\t}\n\n\tdisableUI(event) {\n\t\tthis.startField.disabled = true;\n\t\tthis.startButton.disabled = true;\n\n\t\tsuper.disableUI(event);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class BST extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.first_print_pos_y = h - 2 * BST.PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\t\tthis.startingX = w / 2;\n\t\tthis.addControls();\n\t\tthis.nextIndex = 1;\n\t\tthis.commands = [];\n\t\tthis.edges = [];\n\t\tthis.cmd(act.createLabel, 0, '', BST.EXPLANITORY_TEXT_X, BST.EXPLANITORY_TEXT_Y, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst predSuccButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Predecessor', 'Successor'],\n\t\t\t'Predecessor/Successor'\n\t\t);\n\n\t\tthis.predButton = predSuccButtonList[0];\n\t\tthis.succButton = predSuccButtonList[1];\n\t\tthis.predButton.onclick = () => (this.predSucc = 'pred');\n\t\tthis.succButton.onclick = () => (this.predSucc = 'succ');\n\t\tthis.succButton.checked = true;\n\t\tthis.predSucc = 'succ';\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t\tthis.edges = [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tsizeChanged(newWidth) {\n\t\tthis.startingX = newWidth / 2;\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) this.cmd(act.delete, i);\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, BST.PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += BST.PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = BST.FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += BST.PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tthis.doFind(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Found:' + value);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.left, value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t' Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tBST.HIGHLIGHT_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.doFind(tree.right, value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)'\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t}\n\t}\n\n\tremakeTree(curr) {\n\t\tif (curr == null) return;\n\t\tif (curr.left != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.left.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.left);\n\t\t}\n\t\tif (curr.right != null) {\n\t\t\tthis.cmd(act.connect, curr.graphicID, curr.right.graphicID, BST.LINK_COLOR);\n\t\t\tthis.remakeTree(curr.right);\n\t\t}\n\t}\n\n\tadd(data) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + data);\n\t\tthis.treeRoot = this.addH(data, this.treeRoot);\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\taddH(data, curr) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, 'Null found, inserting new node');\n\t\t\tconst treeNodeID = this.nextIndex++;\n\t\t\tthis.cmd(act.createCircle, treeNodeID, data, 30, BST.STARTING_Y);\n\n\t\t\tthis.cmd(act.setForegroundColor, treeNodeID, BST.FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, treeNodeID, BST.BACKGROUND_COLOR);\n\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn new BSTNode(data, treeNodeID, 0, 0);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking at left subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.addH(data, curr.left);\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking at right subtree`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.addH(data, curr.right);\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.resizeTree();\n\t\t\tconst connected = this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tconnected && this.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, `${data} == ${curr.data}. Ignoring duplicate!`);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tconnectSmart(id1, id2) {\n\t\tif (!this.edges.some(e => e[0] === id1 && e[1] === id2)) {\n\t\t\tthis.cmd(act.connect, id1, id2, BST.LINK_COLOR);\n\t\t\tthis.edges.push([id1, id2]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tdeleteNode(curr) {\n\t\tthis.cmd(act.delete, curr.graphicID);\n\t}\n\n\tremove(data) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, 0, `Deleting ${data}`);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, ' ');\n\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeRoot = this.removeH(this.treeRoot, data);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.resizeTree();\n\t\treturn this.commands;\n\t}\n\n\tremoveH(curr, data) {\n\t\tif (curr == null) {\n\t\t\tthis.cmd(act.setText, 0, `${data} not found in the tree`);\n\t\t\treturn;\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1);\n\t\tif (data < curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} < ${curr.data}. Looking left`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.left = this.removeH(curr.left, data);\n\t\t\tif (curr.left != null) {\n\t\t\t\tcurr.left.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else if (data > curr.data) {\n\t\t\tthis.cmd(act.setText, 0, `${data} > ${curr.data}. Looking right`);\n\t\t\tthis.cmd(act.step);\n\t\t\tcurr.right = this.removeH(curr.right, data);\n\t\t\tif (curr.right != null) {\n\t\t\t\tcurr.right.parent = curr;\n\t\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t} else {\n\t\t\tif (curr.left == null && curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Element to delete is a leaf node');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn null;\n\t\t\t} else if (curr.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with right child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.right;\n\t\t\t} else if (curr.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, `One-child case, replace with left child`);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.deleteNode(curr);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\treturn curr.left;\n\t\t\t} else {\n\t\t\t\tconst dummy = [];\n\t\t\t\tif (this.predSucc === 'succ') {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with successor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.right = this.removeSucc(curr.right, dummy);\n\t\t\t\t\tcurr.right && this.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, 0, `Two-child case, replace data with predecessor`);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tcurr.left = this.removePred(curr.left, dummy);\n\t\t\t\t\tcurr.left && this.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\t\t}\n\t\t\t\tthis.resizeTree();\n\t\t\t\tcurr.data = dummy[0];\n\t\t\t\tthis.cmd(act.setText, curr.graphicID, curr.data);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0);\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn curr;\n\t}\n\n\tremoveSucc(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.left == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No left child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.right;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Left child exists, look left');\n\t\tcurr.left = this.removeSucc(curr.left, dummy);\n\t\tif (curr.left != null) {\n\t\t\tcurr.left.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.left.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, \"#0000ff\");\n\t\treturn curr;\n\t}\n\n\tremovePred(curr, dummy) {\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 1, '#0000ff');\n\t\tthis.cmd(act.step);\n\t\tif (curr.right == null) {\n\t\t\tthis.cmd(act.setText, 0, 'No right child, replace with right child');\n\t\t\tthis.cmd(act.step);\n\t\t\tdummy.push(curr.data);\n\t\t\tthis.deleteNode(curr);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, '');\n\t\t\treturn curr.left;\n\t\t}\n\t\tthis.cmd(act.setText, 0, 'Right child exists, look right');\n\t\tthis.cmd(act.step);\n\t\tcurr.right = this.removePred(curr.right, dummy);\n\t\tif (curr.right != null) {\n\t\t\tcurr.right.parent = curr;\n\t\t\tthis.connectSmart(curr.graphicID, curr.right.graphicID);\n\t\t\tthis.resizeTree();\n\t\t}\n\t\tthis.cmd(act.setHighlight, curr.graphicID, 0, \"#0000ff\");\n\t\treturn curr;\n\t}\n\n\tresizeTree() {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, BST.STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + BST.HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + BST.HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), BST.WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), BST.WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n}\n\n// Various constants\n\nBST.HIGHLIGHT_LABEL_COLOR = '#FF0000';\nBST.HIGHLIGHT_LINK_COLOR = '#FF0000';\n\nBST.HIGHLIGHT_COLOR = '#007700';\nBST.HEIGHT_LABEL_COLOR = '#007700';\n\nBST.LINK_COLOR = '#00B000';\nBST.HIGHLIGHT_CIRCLE_COLOR = '#007700';\nBST.FOREGROUND_COLOR = '#007700';\nBST.BACKGROUND_COLOR = '#DDFFDD';\nBST.PRINT_COLOR = BST.FOREGROUND_COLOR;\n\nBST.WIDTH_DELTA = 50;\nBST.HEIGHT_DELTA = 50;\nBST.STARTING_Y = 50;\n\nBST.FIRST_PRINT_POS_X = 50;\nBST.PRINT_VERTICAL_GAP = 20;\nBST.PRINT_HORIZONTAL_GAP = 50;\nBST.EXPLANITORY_TEXT_X = 10;\nBST.EXPLANITORY_TEXT_Y = 10;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_MAX = 990;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nconst MIN_MAX_DEGREE = 4;\n\nconst HEIGHT_DELTA = 50;\nconst NODE_SPACING = 3;\nconst STARTING_Y = 30;\nconst WIDTH_PER_ELEM = 40;\nconst NODE_HEIGHT = 20;\n\nconst MESSAGE_X = 5;\nconst MESSAGE_Y = 10;\n\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nexport default class BTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\n\t\tthis.starting_x = w / 2;\n\n\t\tthis.preemptiveSplit = false;\n\n\t\tthis.addControls();\n\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\n\t\tthis.max_degree = 4;\n\n\t\tthis.messageID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.messageID, '', MESSAGE_X, MESSAGE_Y, 0);\n\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\tthis.moveLabel2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.commands = [];\n\n\t\tthis.first_print_pos_y = h - 3 * PRINT_VERTICAL_GAP;\n\n\t\tthis.xPosOfNextLabel = 100;\n\t\tthis.yPosOfNextLabel = 200;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 3;\n\t\tthis.max_degree = 4;\n\t\tthis.max_keys = 3;\n\t\tthis.min_keys = 1;\n\t\tthis.split_index = 1;\n\t\t// NOTE: The order of these last two this.commands matters!\n\t\tthis.treeRoot = null;\n\t\tthis.ignoreInputs = true;\n\t\tthis.ignoreInputs = false;\n\t}\n\n\tenableUI() {\n\t\tlet i;\n\t\tfor (i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tmaxDegreeChangedHandler(newMaxDegree) {\n\t\tif (this.max_degree !== newMaxDegree) {\n\t\t\tthis.implementAction(this.changeDegree.bind(this), newMaxDegree);\n\t\t\tthis.animationManager.skipForward();\n\t\t\tthis.animationManager.clearHistory();\n\t\t}\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(this.deleteField.value, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearTree.bind(this));\n\t}\n\n\tpremtiveSplitCallback() {\n\t\tif (this.preemptiveSplit !== this.premptiveSplitBox.checked) {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.changePreemtiveSplit.bind(this),\n\t\t\t\tthis.premptiveSplitBox.checked\n\t\t\t);\n\t\t}\n\t}\n\n\tchangePreemtiveSplit(newValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.step);\n\t\tthis.preemptiveSplit = newValue;\n\t\tif (this.premptiveSplitBox.checked !== this.preemptiveSplit) {\n\t\t\tthis.premptiveSplitBox.checked = this.preemptiveSplit;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.messageID, 'Printing tree');\n\t\tconst firstLabel = this.nextIndex;\n\n\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\n\t\tthis.printTreeRec(this.treeRoot);\n\t\tthis.cmd(act.step);\n\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\tthis.cmd(act.delete, i);\n\t\t}\n\t\tthis.nextIndex = firstLabel;\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tlet nextLabelID;\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(act.createLabel, nextLabelID, tree.keys[i], this.getLabelX(tree, i), tree.y);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t} else {\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[0].graphicID, 0);\n\t\t\tthis.printTreeRec(tree.children[0]);\n\t\t\tfor (let i = 0; i < tree.numKeys; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\tthis.cmd(act.createLabel, nextLabelID, tree.keys[i], this.getLabelX(tree, i), tree.y);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\t\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\t\t\tif (this.xPosOfNextLabel > PRINT_MAX) {\n\t\t\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i + 1].graphicID, 0);\n\t\t\t\tthis.printTreeRec(tree.children[i + 1]);\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t}\n\t}\n\n\tclearTree() {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\treturn this.commands;\n\t}\n\n\tdeleteTree(tree) {\n\t\tif (tree != null) {\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tfor (let i = 0; i <= tree.numKeys; i++) {\n\t\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\t\t\t\t\tthis.deleteTree(tree.children[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t}\n\t}\n\n\tchangeDegree(degree) {\n\t\tthis.commands = [];\n\t\tthis.deleteTree(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\tthis.nextIndex = 3;\n\t\tconst newDegree = degree;\n\t\tthis.ignoreInputs = true;\n\t\tthis.maxDegreeRadioButtons[newDegree - MIN_MAX_DEGREE].checked = true;\n\n\t\tthis.ignoreInputs = false;\n\t\tthis.max_degree = newDegree;\n\t\tthis.max_keys = newDegree - 1;\n\t\tthis.min_keys = Math.floor((newDegree + 1) / 2) - 1;\n\t\tthis.split_index = Math.floor((newDegree - 1) / 2);\n\t\tif (this.commands.length === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tif (newDegree % 2 !== 0 && this.preemptiveSplit) {\n\t\t\tthis.preemptiveSplit = false;\n\t\t\tthis.premptiveSplitBox.checked = false;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Finding ' + findValue);\n\t\tthis.findInTree(this.treeRoot, findValue);\n\n\t\treturn this.commands;\n\t}\n\n\tfindInTree(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tthis.findInTree(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.findInTree(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' found');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.messageID, 'Element ' + val + ' is not in the tree');\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.messageID, 'Inserting ' + insertedValue);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = insertedValue;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, insertedValue, 0);\n\t\t} else {\n\t\t\tif (this.preemptiveSplit) {\n\t\t\t\tif (this.treeRoot.numKeys === this.max_keys) {\n\t\t\t\t\tthis.split(this.treeRoot);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t\tthis.insertNotFull(this.treeRoot, insertedValue);\n\t\t\t} else {\n\t\t\t\tthis.insert(this.treeRoot, insertedValue);\n\t\t\t}\n\t\t\tif (!this.treeRoot.isLeaf) {\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\n\t\treturn this.commands;\n\t}\n\n\tinsertNotFull(tree, insertValue) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf'\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tif (tree.children[findIndex].numKeys === this.max_keys) {\n\t\t\t\tconst newTree = this.split(tree.children[findIndex]);\n\t\t\t\tthis.resizeTree();\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.insertNotFull(newTree, insertValue);\n\t\t\t} else {\n\t\t\t\tthis.insertNotFull(tree.children[findIndex], insertValue);\n\t\t\t}\n\t\t}\n\t}\n\n\tinsert(tree, insertValue) {\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tif (tree.isLeaf) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.messageID,\n\t\t\t\t'Inserting ' + insertValue + '.  Inserting into a leaf'\n\t\t\t);\n\t\t\ttree.numKeys++;\n\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\tlet insertIndex = tree.numKeys - 1;\n\t\t\twhile (insertIndex > 0 && tree.keys[insertIndex - 1] > insertValue) {\n\t\t\t\ttree.keys[insertIndex] = tree.keys[insertIndex - 1];\n\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\t\tinsertIndex--;\n\t\t\t}\n\t\t\ttree.keys[insertIndex] = insertValue;\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[insertIndex], insertIndex);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.resizeTree();\n\t\t\tthis.insertRepair(tree);\n\t\t} else {\n\t\t\tlet findIndex = 0;\n\t\t\twhile (findIndex < tree.numKeys && tree.keys[findIndex] < insertValue) {\n\t\t\t\tfindIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[findIndex].graphicID, 0);\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\tthis.insert(tree.children[findIndex], insertValue);\n\t\t}\n\t}\n\n\tinsertRepair(tree) {\n\t\tif (tree.numKeys <= this.max_keys) {\n\t\t\treturn;\n\t\t} else if (tree.parent == null) {\n\t\t\tthis.treeRoot = this.split(tree);\n\t\t\treturn;\n\t\t} else {\n\t\t\tconst newNode = this.split(tree);\n\t\t\tthis.insertRepair(newNode);\n\t\t}\n\t}\n\n\tsplit(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Node now contains too many keys.  Splittig ...');\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tconst rightNode = new BTreeNode(this.nextIndex++, tree.x + 100, tree.y);\n\t\trightNode.numKeys = tree.numKeys - this.split_index - 1;\n\t\tconst risingNode = tree.keys[this.split_index];\n\t\tlet currentParent;\n\t\tlet parentIndex;\n\t\tif (tree.parent != null) {\n\t\t\tcurrentParent = tree.parent;\n\t\t\tfor (\n\t\t\t\tparentIndex = 0;\n\t\t\t\tparentIndex < currentParent.numKeys + 1 &&\n\t\t\t\tcurrentParent.children[parentIndex] !== tree;\n\t\t\t\tparentIndex++\n\t\t\t);\n\t\t\tif (parentIndex === currentParent.numKeys + 1) {\n\t\t\t\tthrow new Error(\"Couldn't find which child we were!\");\n\t\t\t}\n\t\t\tthis.cmd(act.setNumElements, currentParent.graphicID, currentParent.numKeys + 1);\n\t\t\tfor (let i = currentParent.numKeys; i > parentIndex; i--) {\n\t\t\t\tcurrentParent.children[i + 1] = currentParent.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tcurrentParent.graphicID,\n\t\t\t\t\tcurrentParent.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti + 1\n\t\t\t\t);\n\n\t\t\t\tcurrentParent.keys[i] = currentParent.keys[i - 1];\n\t\t\t\tthis.cmd(act.setText, currentParent.graphicID, currentParent.keys[i], i);\n\t\t\t}\n\t\t\tcurrentParent.numKeys++;\n\t\t\tcurrentParent.keys[parentIndex] = risingNode;\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, '', parentIndex);\n\t\t\tthis.moveLabel1ID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\trisingNode,\n\t\t\t\tthis.getLabelX(tree, this.split_index),\n\t\t\t\ttree.y\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.moveLabel1ID, FOREGROUND_COLOR);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.moveLabel1ID,\n\t\t\t\tthis.getLabelX(currentParent, parentIndex),\n\t\t\t\tcurrentParent.y\n\t\t\t);\n\n\t\t\tcurrentParent.children[parentIndex + 1] = rightNode;\n\t\t\trightNode.parent = currentParent;\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createBTreeNode,\n\t\t\trightNode.graphicID,\n\t\t\tWIDTH_PER_ELEM,\n\t\t\tNODE_HEIGHT,\n\t\t\ttree.numKeys - this.split_index - 1,\n\t\t\ttree.x,\n\t\t\ttree.y,\n\t\t\tBACKGROUND_COLOR,\n\t\t\tFOREGROUND_COLOR\n\t\t);\n\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys + 1; i++) {\n\t\t\trightNode.children[i - this.split_index - 1] = tree.children[i];\n\t\t\tif (tree.children[i] != null) {\n\t\t\t\trightNode.isLeaf = false;\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i].graphicID);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightNode.graphicID,\n\t\t\t\t\trightNode.children[i - this.split_index - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - this.split_index - 1\n\t\t\t\t);\n\t\t\t\tif (tree.children[i] != null) {\n\t\t\t\t\ttree.children[i].parent = rightNode;\n\t\t\t\t}\n\t\t\t\ttree.children[i] = null;\n\t\t\t}\n\t\t}\n\t\tfor (let i = this.split_index + 1; i < tree.numKeys; i++) {\n\t\t\trightNode.keys[i - this.split_index - 1] = tree.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\trightNode.graphicID,\n\t\t\t\trightNode.keys[i - this.split_index - 1],\n\t\t\t\ti - this.split_index - 1\n\t\t\t);\n\t\t}\n\t\tconst leftNode = tree;\n\t\tleftNode.numKeys = this.split_index;\n\t\tfor (let i = this.split_index; i < tree.numKeys; i++) {\n\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t}\n\t\tthis.cmd(act.setNumElements, tree.graphicID, this.split_index);\n\n\t\tif (tree.parent != null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tcurrentParent.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\tparentIndex + 1\n\t\t\t);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\tthis.cmd(act.setText, currentParent.graphicID, risingNode, parentIndex);\n\t\t\treturn tree.parent;\n\t\t}\n\t\telse {\n\t\t\tthis.treeRoot = new BTreeNode(this.nextIndex++, this.starting_x, STARTING_Y);\n\t\t\tthis.cmd(\n\t\t\t\tact.createBTreeNode,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tWIDTH_PER_ELEM,\n\t\t\t\tNODE_HEIGHT,\n\t\t\t\t1,\n\t\t\t\tthis.starting_x,\n\t\t\t\tSTARTING_Y,\n\t\t\t\tBACKGROUND_COLOR,\n\t\t\t\tFOREGROUND_COLOR\n\t\t\t);\n\t\t\tthis.treeRoot.keys[0] = risingNode;\n\t\t\tthis.cmd(act.setText, this.treeRoot.graphicID, risingNode, 0);\n\t\t\tthis.treeRoot.children[0] = leftNode;\n\t\t\tthis.treeRoot.children[1] = rightNode;\n\t\t\tleftNode.parent = this.treeRoot;\n\t\t\trightNode.parent = this.treeRoot;\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\tleftNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0\n\t\t\t); // Connection Point\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.treeRoot.graphicID,\n\t\t\t\trightNode.graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t1\n\t\t\t); // Connection Point\n\t\t\tthis.treeRoot.isLeaf = false;\n\t\t\treturn this.treeRoot;\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.cmd(act.setText, 0, '');\n\t\tif (this.preemptiveSplit) {\n\t\t\tthis.doDeleteNotEmpty(this.treeRoot, deletedValue);\n\t\t} else {\n\t\t\tthis.doDelete(this.treeRoot, deletedValue);\n\t\t}\n\t\tif (this.treeRoot.numKeys === 0) {\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\tthis.treeRoot = this.treeRoot.children[0];\n\t\t\tthis.treeRoot.parent = null;\n\t\t\tthis.resizeTree();\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tdoDeleteNotEmpty(tree, val) {\n\t\tif (tree != null) {\n\t\t\tlet nextNode;\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\n\t\t\t\t\tif (tree.children[tree.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\tif (tree.children[tree.numKeys - 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\ttree.children[tree.numKeys],\n\t\t\t\t\t\t\t\ttree.numKeys\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[tree.numKeys - 1]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[tree.numKeys], val);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\n\t\t\t\t\tif (tree.children[i].numKeys > this.min_keys) {\n\t\t\t\t\t\tthis.doDeleteNotEmpty(tree.children[i], val);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys > this.min_keys) {\n\t\t\t\t\t\t\tnextNode = this.stealFromRight(tree.children[i], i);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, 'FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t'Checking to see if tree to left of element to delete \\nhas an extra key'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tlet maxNode = tree.children[i];\n\n\t\t\t\t\tif (tree.children[i].numKeys === this.min_keys) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does not have an extra key.  \\nLooking to the right ...'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t1\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\t\ttree.children[i + 1].graphicID,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// Trees to left and right of node to delete don't have enough keys\n\t\t\t\t\t\t// Do a merge, and then recursively delete the element\n\t\t\t\t\t\tif (tree.children[i + 1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Neither subtree has extra nodes.  Mergeing around the key to delete, \\nand recursively deleting ...'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tnextNode = this.mergeRight(tree.children[i]);\n\t\t\t\t\t\t\tthis.doDeleteNotEmpty(nextNode, val);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t\t'Tree to right of element to delete does have an extra key. \\nFinding the smallest key in that subtree ...'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\t\t\tlet minNode = tree.children[i + 1];\n\t\t\t\t\t\t\twhile (!minNode.isLeaf) {\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\t\tif (minNode.children[0].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\tif (minNode.children[1].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\t\t\tminNode = this.mergeRight(minNode.children[0]);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tminNode = this.stealFromRight(minNode.children[0], 0);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tminNode = minNode.children[0];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 1);\n\t\t\t\t\t\t\ttree.keys[i] = minNode.keys[0];\n\t\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', 0);\n\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\t\tminNode.keys[0],\n\t\t\t\t\t\t\t\tthis.getLabelX(minNode, 0),\n\t\t\t\t\t\t\t\tminNode.y\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\t\tfor (i = 1; i < minNode.numKeys; i++) {\n\t\t\t\t\t\t\t\tminNode.keys[i - 1] = minNode.keys[i];\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, minNode.keys[i - 1], i - 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cmd(act.setText, minNode.graphicID, '', minNode.numKeys - 1);\n\n\t\t\t\t\t\t\tminNode.numKeys--;\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, minNode.graphicID, 0);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\t\tthis.cmd(act.setNumElements, minNode.graphicID, minNode.numKeys);\n\t\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\tthis.messageID,\n\t\t\t\t\t\t\t'Tree to left of element to delete does have \\nan extra key. Finding the largest key in that subtree ...'\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys].numKeys === this.min_keys) {\n\t\t\t\t\t\t\t\tif (maxNode.children[maxNode.numKeys - 1] > this.min_keys) {\n\t\t\t\t\t\t\t\t\tmaxNode = this.stealFromLeft(\n\t\t\t\t\t\t\t\t\t\tmaxNode.children[maxNode.numKeys],\n\t\t\t\t\t\t\t\t\t\tmaxNode.numKeys\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmaxNode = this.mergeRight(maxNode.children[maxNode.numKeys - 1]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\t\tmaxNode.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\t\tthis.resizeTree();\n\t\t\t\t\t\tthis.cmd(act.setText, this.messageID, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDelete(tree, val) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet i;\n\t\t\tfor (i = 0; i < tree.numKeys && tree.keys[i] < val; i++);\n\t\t\tif (i === tree.numKeys) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t1\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setEdgeHighlight,\n\t\t\t\t\t\ttree.graphicID,\n\t\t\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tthis.doDelete(tree.children[tree.numKeys], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else if (tree.keys[i] > val) {\n\t\t\t\tif (!tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setEdgeHighlight, tree.graphicID, tree.children[i].graphicID, 0);\n\t\t\t\t\tthis.doDelete(tree.children[i], val);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, '#FF0000', i);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (tree.isLeaf) {\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tfor (let j = i; j < tree.numKeys - 1; j++) {\n\t\t\t\t\t\ttree.keys[j] = tree.keys[j + 1];\n\t\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[j], j);\n\t\t\t\t\t}\n\t\t\t\t\ttree.numKeys--;\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tthis.repairAfterDelete(tree);\n\t\t\t\t} else {\n\t\t\t\t\tlet maxNode = tree.children[i];\n\t\t\t\t\twhile (!maxNode.isLeaf) {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\t\tmaxNode = maxNode.children[maxNode.numKeys];\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 1);\n\t\t\t\t\ttree.keys[i] = maxNode.keys[maxNode.numKeys - 1];\n\t\t\t\t\tthis.cmd(act.setTextColor, tree.graphicID, FOREGROUND_COLOR, i);\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, '', i);\n\t\t\t\t\tthis.cmd(act.setText, maxNode.graphicID, '', maxNode.numKeys - 1);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.moveLabel1ID,\n\t\t\t\t\t\ttree.keys[i],\n\t\t\t\t\t\tthis.getLabelX(maxNode, maxNode.numKeys - 1),\n\t\t\t\t\t\tmaxNode.y\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, i), tree.y);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\t\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t\t\t\tmaxNode.numKeys--;\n\t\t\t\t\tthis.cmd(act.setHighlight, maxNode.graphicID, 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\n\t\t\t\t\tthis.cmd(act.setNumElements, maxNode.graphicID, maxNode.numKeys);\n\t\t\t\t\tthis.repairAfterDelete(maxNode);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tmergeRight(tree) {\n\t\tthis.cmd(act.setText, this.messageID, 'Merging node');\n\n\t\tconst parentNode = tree.parent;\n\t\tlet parentIndex = 0;\n\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, rightSib.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + rightSib.numKeys + 1);\n\t\ttree.x = (tree.x + rightSib.x) / 2;\n\t\tthis.cmd(act.setPosition, tree.graphicID, tree.x, tree.y);\n\n\t\ttree.keys[tree.numKeys] = parentNode.keys[parentIndex];\n\t\tconst fromParentIndex = tree.numKeys;\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.moveLabel1ID,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y\n\t\t);\n\n\t\tfor (let i = 0; i < rightSib.numKeys; i++) {\n\t\t\ttree.keys[tree.numKeys + 1 + i] = rightSib.keys[i];\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.keys[tree.numKeys + 1 + i],\n\t\t\t\ttree.numKeys + 1 + i\n\t\t\t);\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, '', i);\n\t\t}\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = 0; i <= rightSib.numKeys; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\ttree.children[tree.numKeys + 1 + i] = rightSib.children[i];\n\t\t\t\ttree.children[tree.numKeys + 1 + i].parent = tree;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[tree.numKeys + 1 + i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ttree.numKeys + 1 + i\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.disconnect, parentNode.graphicID, rightSib.graphicID);\n\t\tfor (let i = parentIndex + 1; i < parentNode.numKeys; i++) {\n\t\t\tthis.cmd(act.disconnect, parentNode.graphicID, parentNode.children[i + 1].graphicID);\n\t\t\tparentNode.children[i] = parentNode.children[i + 1];\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tparentNode.graphicID,\n\t\t\t\tparentNode.children[i].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ti\n\t\t\t);\n\t\t\tparentNode.keys[i - 1] = parentNode.keys[i];\n\t\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentNode.numKeys - 1);\n\t\tparentNode.numKeys--;\n\t\tthis.cmd(act.setNumElements, parentNode.graphicID, parentNode.numKeys);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, parentNode.graphicID, 0);\n\n\t\tthis.cmd(act.delete, rightSib.graphicID);\n\t\ttree.numKeys = tree.numKeys + rightSib.numKeys + 1;\n\t\tthis.cmd(act.move, this.moveLabel1ID, this.getLabelX(tree, fromParentIndex), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.moveLabel1ID);\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[fromParentIndex], fromParentIndex);\n\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromRight(tree, parentIndex) {\n\t\t// Steal from right sibling\n\t\tconst parentNode = tree.parent;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys + 1);\n\n\t\tthis.cmd(act.setText, this.messageID, 'Stealing from right sibling');\n\n\t\tconst rightSib = parentNode.children[parentIndex + 1];\n\t\ttree.numKeys++;\n\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex);\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', 0);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\trightSib.keys[0],\n\t\t\tthis.getLabelX(rightSib, 0),\n\t\t\trightSib.y\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex],\n\t\t\tthis.getLabelX(parentNode, parentIndex),\n\t\t\tparentNode.y\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, tree.numKeys - 1), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\t\ttree.keys[tree.numKeys - 1] = parentNode.keys[parentIndex];\n\t\tparentNode.keys[parentIndex] = rightSib.keys[0];\n\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[tree.numKeys - 1], tree.numKeys - 1);\n\t\tthis.cmd(act.setText, parentNode.graphicID, parentNode.keys[parentIndex], parentIndex);\n\t\tif (!tree.isLeaf) {\n\t\t\ttree.children[tree.numKeys] = rightSib.children[0];\n\t\t\ttree.children[tree.numKeys].parent = tree;\n\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[0].graphicID);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[tree.numKeys].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\ttree.numKeys\n\t\t\t);\n\n\t\t\tfor (let i = 1; i < rightSib.numKeys + 1; i++) {\n\t\t\t\tthis.cmd(act.disconnect, rightSib.graphicID, rightSib.children[i].graphicID);\n\t\t\t\trightSib.children[i - 1] = rightSib.children[i];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\trightSib.graphicID,\n\t\t\t\t\trightSib.children[i - 1].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti - 1\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tfor (let i = 1; i < rightSib.numKeys; i++) {\n\t\t\trightSib.keys[i - 1] = rightSib.keys[i];\n\t\t\tthis.cmd(act.setText, rightSib.graphicID, rightSib.keys[i - 1], i - 1);\n\t\t}\n\t\tthis.cmd(act.setText, rightSib.graphicID, '', rightSib.numKeys - 1);\n\t\trightSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, rightSib.graphicID, rightSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\tstealFromLeft(tree, parentIndex) {\n\t\tconst parentNode = tree.parent;\n\t\t// Steal from left sibling\n\t\ttree.numKeys++;\n\t\tthis.cmd(act.setNumElements, tree.graphicID, tree.numKeys);\n\t\tthis.cmd(act.setText, this.messageID, 'Node has too few keys.  Stealing from left sibling.');\n\n\t\tfor (let i = tree.numKeys - 1; i > 0; i--) {\n\t\t\ttree.keys[i] = tree.keys[i - 1];\n\t\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[i], i);\n\t\t}\n\t\tconst leftSib = parentNode.children[parentIndex - 1];\n\n\t\tthis.cmd(act.setText, tree.graphicID, '', 0);\n\t\tthis.cmd(act.setText, parentNode.graphicID, '', parentIndex - 1);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tconst tmpLabel1 = this.nextIndex++;\n\t\tconst tmpLabel2 = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel1,\n\t\t\tleftSib.keys[leftSib.numKeys - 1],\n\t\t\tthis.getLabelX(leftSib, leftSib.numKeys - 1),\n\t\t\tleftSib.y\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\ttmpLabel2,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tthis.getLabelX(parentNode, parentIndex - 1),\n\t\t\tparentNode.y\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel1, FOREGROUND_COLOR);\n\t\tthis.cmd(act.setForegroundColor, tmpLabel2, FOREGROUND_COLOR);\n\n\t\tthis.cmd(act.move, tmpLabel1, this.getLabelX(parentNode, parentIndex - 1), parentNode.y);\n\t\tthis.cmd(act.move, tmpLabel2, this.getLabelX(tree, 0), tree.y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, tmpLabel1);\n\t\tthis.cmd(act.delete, tmpLabel2);\n\n\t\tif (!tree.isLeaf) {\n\t\t\tfor (let i = tree.numKeys; i > 0; i--) {\n\t\t\t\tthis.cmd(act.disconnect, tree.graphicID, tree.children[i - 1].graphicID);\n\t\t\t\ttree.children[i] = tree.children[i - 1];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\ttree.graphicID,\n\t\t\t\t\ttree.children[i].graphicID,\n\t\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t\t0, // Curve\n\t\t\t\t\t0, // Directed\n\t\t\t\t\t'', // Label\n\t\t\t\t\ti\n\t\t\t\t);\n\t\t\t}\n\t\t\ttree.children[0] = leftSib.children[leftSib.numKeys];\n\t\t\tthis.cmd(act.disconnect, leftSib.graphicID, leftSib.children[leftSib.numKeys].graphicID);\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\ttree.graphicID,\n\t\t\t\ttree.children[0].graphicID,\n\t\t\t\tFOREGROUND_COLOR,\n\t\t\t\t0, // Curve\n\t\t\t\t0, // Directed\n\t\t\t\t'', // Label\n\t\t\t\t0\n\t\t\t);\n\t\t\tleftSib.children[leftSib.numKeys] = null;\n\t\t\ttree.children[0].parent = tree;\n\t\t}\n\n\t\ttree.keys[0] = parentNode.keys[parentIndex - 1];\n\t\tthis.cmd(act.setText, tree.graphicID, tree.keys[0], 0);\n\t\tparentNode.keys[parentIndex - 1] = leftSib.keys[leftSib.numKeys - 1];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tparentNode.graphicID,\n\t\t\tparentNode.keys[parentIndex - 1],\n\t\t\tparentIndex - 1\n\t\t);\n\t\tthis.cmd(act.setText, leftSib.graphicID, '', leftSib.numKeys - 1);\n\n\t\tleftSib.numKeys--;\n\t\tthis.cmd(act.setNumElements, leftSib.graphicID, leftSib.numKeys);\n\t\tthis.resizeTree();\n\t\tthis.cmd(act.setText, this.messageID, '');\n\t\treturn tree;\n\t}\n\n\trepairAfterDelete(tree) {\n\t\tif (tree.numKeys < this.min_keys) {\n\t\t\tif (tree.parent == null) {\n\t\t\t\tif (tree.numKeys === 0) {\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, tree.graphicID);\n\t\t\t\t\tthis.treeRoot = tree.children[0];\n\t\t\t\t\tif (this.treeRoot != null) this.treeRoot.parent = null;\n\t\t\t\t\tthis.resizeTree();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst parentNode = tree.parent;\n\t\t\t\tlet parentIndex;\n\t\t\t\tlet nextNode;\n\t\t\t\tfor (parentIndex = 0; parentNode.children[parentIndex] !== tree; parentIndex++);\n\t\t\t\tif (\n\t\t\t\t\tparentIndex > 0 &&\n\t\t\t\t\tparentNode.children[parentIndex - 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromLeft(tree, parentIndex);\n\t\t\t\t} else if (\n\t\t\t\t\tparentIndex < parentNode.numKeys &&\n\t\t\t\t\tparentNode.children[parentIndex + 1].numKeys > this.min_keys\n\t\t\t\t) {\n\t\t\t\t\tthis.stealFromRight(tree, parentIndex);\n\t\t\t\t} else if (parentIndex === 0) {\n\t\t\t\t\t// Merge with right sibling\n\t\t\t\t\tnextNode = this.mergeRight(tree);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t} else {\n\t\t\t\t\t// Merge with left sibling\n\t\t\t\t\tnextNode = this.mergeRight(parentNode.children[parentIndex - 1]);\n\t\t\t\t\tthis.repairAfterDelete(nextNode.parent);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLabelX(tree, index) {\n\t\treturn (\n\t\t\ttree.x -\n\t\t\t(WIDTH_PER_ELEM * tree.numKeys) / 2 +\n\t\t\tWIDTH_PER_ELEM / 2 +\n\t\t\tindex * WIDTH_PER_ELEM\n\t\t);\n\t}\n\n\tresizeTree() {\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tthis.setNewPositions(this.treeRoot, this.starting_x, STARTING_Y);\n\t\tthis.animateNewPositions(this.treeRoot);\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\ttree.x = xPosition;\n\t\t\tif (!tree.isLeaf) {\n\t\t\t\tconst leftEdge = xPosition - tree.width / 2;\n\t\t\t\tlet priorWidth = 0;\n\t\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\t\tthis.setNewPositions(\n\t\t\t\t\t\ttree.children[i],\n\t\t\t\t\t\tleftEdge + priorWidth + tree.widths[i] / 2,\n\t\t\t\t\t\tyPosition + HEIGHT_DELTA\n\t\t\t\t\t);\n\t\t\t\t\tpriorWidth += tree.widths[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree == null) {\n\t\t\treturn;\n\t\t}\n\t\tlet i;\n\t\tfor (i = 0; i < tree.numKeys + 1; i++) {\n\t\t\tthis.animateNewPositions(tree.children[i]);\n\t\t}\n\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (tree.isLeaf) {\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = 0;\n\t\t\t}\n\t\t\ttree.width = tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING;\n\t\t\treturn tree.width;\n\t\t} else {\n\t\t\tlet treeWidth = 0;\n\t\t\tfor (let i = 0; i < tree.numKeys + 1; i++) {\n\t\t\t\ttree.widths[i] = this.resizeWidths(tree.children[i]);\n\t\t\t\ttreeWidth = treeWidth + tree.widths[i];\n\t\t\t}\n\t\t\ttreeWidth = Math.max(treeWidth, tree.numKeys * WIDTH_PER_ELEM + NODE_SPACING);\n\t\t\ttree.width = treeWidth;\n\t\t\treturn treeWidth;\n\t\t}\n\t}\n}\n\nfunction BTreeNode(id, initialX, initialY) {\n\tthis.widths = [];\n\tthis.keys = [];\n\tthis.children = [];\n\tthis.x = initialX;\n\tthis.y = initialY;\n\tthis.graphicID = id;\n\tthis.numKeys = 1;\n\tthis.isLeaf = true;\n\tthis.parent = null;\n\n\tthis.leftWidth = 0;\n\tthis.rightWidth = 0;\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst PATTERN_START_Y = 100;\n\nconst LAST_TABLE_START_Y = 200;\n\nexport default class BoyerMoore extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Last Occurrence Table button\n\t\tthis.blotButton = addControlToAlgorithmBar('Button', 'Build Last Occurrence Table');\n\t\tthis.blotButton.onclick = this.buildLastOccurrenceTableCallback.bind(this);\n\t\tthis.controls.push(this.blotButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.patternTableLabelID = this.nextIndex++;\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tthis.lastTableLabelID = this.nextIndex++;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildLastOccurrenceTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildLastOccurrenceTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tconst xpos = i * this.cellSize + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tlet xpos;\n\t\tlet ypos;\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst lastTable = this.buildLastTable(text.length, pattern);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + (pattern.length - 1) * this.cellSize,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet row = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j >= 0 && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj--;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j >= 0) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j === -1) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t\tlet shift;\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tif (shift < j) {\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tconst lastTable = {};\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tlastTable[pattern.charAt(i)] = i;\n\t\t}\n\t\tlet i = 0;\n\t\tlet j = pattern.length - 1;\n\t\tlet maxRows = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j >= 0 && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj--;\n\t\t\t}\n\t\t\tif (j === -1) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tlet shift;\n\t\t\t\tif (text.charAt(i + j) in lastTable) {\n\t\t\t\t\tshift = lastTable[text.charAt(i + j)];\n\t\t\t\t} else {\n\t\t\t\t\tshift = -1;\n\t\t\t\t}\n\t\t\t\tif (shift < j) {\n\t\t\t\t\ti += j - shift;\n\t\t\t\t} else {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tj = pattern.length - 1;\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildLastOccurrenceTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildLastTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildLastTable(textLength, pattern) {\n\t\t// Display labels\n\t\tconst labelsX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(act.createLabel, this.patternTableLabelID, 'Pattern:', labelsX, PATTERN_START_Y - 5, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.lastTableLabelID,\n\t\t\t'Last occurence table:',\n\t\t\tlabelsX,\n\t\t\tLAST_TABLE_START_Y + 10,\n\t\t\t0\n\t\t);\n\n\t\t// Display pattern table\n\t\tconst patternTableStartX = ARRAY_START_X + textLength * this.cellSize + 80;\n\t\tthis.patternTableCharacterID = new Array(pattern.length);\n\t\tthis.patternTableIndexID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.patternTableCharacterID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tPATTERN_START_Y\n\t\t\t);\n\t\t\tthis.patternTableIndexID[i] = this.nextIndex;\n\t\t\tthis.cmd(act.createLabel, this.nextIndex++, i, xpos, PATTERN_START_Y + this.cellSize);\n\t\t}\n\n\t\t// Create and display last occurrence table\n\t\tconst lastTable = {};\n\t\tconst lotStartX = ARRAY_START_X + textLength * this.cellSize + 155;\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\tlet j = 0;\n\n\t\tconst lotPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tlotPointerID,\n\t\t\t'#0000FF',\n\t\t\tpatternTableStartX,\n\t\t\tPATTERN_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(act.setHighlight, lotPointerID, 1);\n\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tlet xpos = patternTableStartX + i * this.cellSize;\n\t\t\tthis.cmd(act.move, lotPointerID, xpos, PATTERN_START_Y);\n\t\t\tif (lastTable[pattern.charAt(i)]) {\n\t\t\t\tthis.cmd(act.setText, lastTable[pattern.charAt(i)][1], i);\n\t\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 1);\n\t\t\t\tlastTable[pattern.charAt(i)][0] = i;\n\t\t\t} else {\n\t\t\t\txpos = lotStartX + j * this.cellSize;\n\t\t\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\tpattern.charAt(i),\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex,\n\t\t\t\t\ti,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\tLAST_TABLE_START_Y + this.cellSize\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setHighlight, this.nextIndex, 1);\n\t\t\t\tj++;\n\t\t\t\tlastTable[pattern.charAt(i)] = [i, this.nextIndex++];\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, lastTable[pattern.charAt(i)][1], 0);\n\t\t}\n\n\t\t// Display '*' entry\n\t\tthis.cmd(act.delete, lotPointerID);\n\t\tconst xpos = lotStartX + j * this.cellSize;\n\t\tthis.lastTableCharacterID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex,\n\t\t\t'*',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y\n\t\t);\n\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\tthis.lastTableValueID.push(this.nextIndex);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.nextIndex++,\n\t\t\t'-1',\n\t\t\tthis.cellSize,\n\t\t\tthis.cellSize,\n\t\t\txpos,\n\t\t\tLAST_TABLE_START_Y + this.cellSize\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\tObject.keys(lastTable).map(char => lastTable[char] = lastTable[char][0]); // Return only indices\n\t\treturn lastTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.patternTableCharacterID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.patternTableLabelID);\n\t\t}\n\t\tfor (let i = 0; i < this.patternTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.patternTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.patternTableIndexID[i]);\n\t\t}\n\t\tthis.patternTableCharacterID = [];\n\t\tthis.patternTableIndexID = [];\n\t\tif (this.lastTableCharacterID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.lastTableLabelID);\n\t\t}\n\t\tfor (let i = 0; i < this.lastTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.lastTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.lastTableValueID[i]);\n\t\t}\n\t\tthis.lastTableCharacterID = [];\n\t\tthis.lastTableValueID = [];\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nexport default class BruteForce extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j !== pattern.length) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t}\n\t\t\ti++;\n\t\t\tj = 0;\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\tconst xpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\tconst ypos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nlet lastSwapEnabled = true;\n\nexport default class BubbleSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tlet sorted = true;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tdo {\n\t\t\tsorted = true;\n\t\t\tfor (let i = 0; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t} while (!sorted);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\t// Change pointer colors to red\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 9;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 9;\n\nexport default class CircularlyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front', addBottomHorizontalGroup);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back', addBottomHorizontalGroup);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index', addBottomHorizontalGroup);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index', removeTopHorizontalGroup);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front', removeBottomHorizontalGroup);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back', removeBottomHorizontalGroup);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (\n\t\t\tthis.addValueField.value !== '' &&\n\t\t\tthis.addIndexField.value !== '' &&\n\t\t\tthis.size < SIZE\n\t\t) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '' && this.size < SIZE) {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// CircularlySinglyLinkedList.prototype.getCallback = function()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\t// Order of data should behave as normal\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\n\t\t// Adding to the front or back using O(1) trick, so new node will be added to index 1\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\t// Move over all node IDs but the first\n\t\t\tfor (let i = this.size - 1; i >= 1; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\t// Place new node's ID at index 1\n\t\t\tthis.linkedListElemID[1] = this.nextIndex++;\n\t\t}\n\t\t// Adding first node or to the middle, so new node will be placed normally\n\t\telse {\n\t\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t\t}\n\t\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tif (this.size !== 0 && (index === 0 || index === this.size)) {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircularlyLinkedListNode,\n\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t'',\n\t\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\t\tLINKED_LIST_INSERT_X,\n\t\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size === 0) {\n\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\tthis.cmd(act.connectCurve, this.linkedListElemID[0], this.linkedListElemID[0], -0.5);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tthis.size = this.size + 1;\n\t\t\tthis.resetNodePositions();\n\t\t} else {\n\t\t\tif (index === 0 || index === this.size) {\n\t\t\t\t// Move label from first node to new node\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst copiedData = index === 0 ? this.arrayData[1] : this.arrayData[0];\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tcopiedData,\n\t\t\t\t\tLINKED_LIST_START_X,\n\t\t\t\t\tLINKED_LIST_START_Y\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[1], copiedData);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Move label for new data to the first node\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// Change pointers\n\t\t\t\tif (this.size === 1) {\n\t\t\t\t\t// Case where we're adding the second node\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[0]); // Disconnect head node from itself\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5\n\t\t\t\t\t); // Connect new node to head node\n\t\t\t\t} else {\n\t\t\t\t\t// Other cases\n\t\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[2]); // Disconnect head from old second node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[1]); // Connect head node to new node\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[2]); // Connect new node to old second node\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.resetNodePositions();\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t// If adding to the back, \"move head over\" (rotate elements backwards)\n\t\t\t\tif (index === this.size - 1) {\n\t\t\t\t\t// We increment size above, so subtract one to check if adding to back\n\t\t\t\t\tlet i;\n\t\t\t\t\tconst firstNodeID = this.linkedListElemID[0];\n\t\t\t\t\tfor (i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t\t\t}\n\t\t\t\t\tthis.linkedListElemID[this.size - 1] = firstNodeID;\n\n\t\t\t\t\tconst lastX =\n\t\t\t\t\t\t((this.size - 1) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\tconst lastY =\n\t\t\t\t\t\tMath.floor((this.size - 1) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.linkedListElemID[i],\n\t\t\t\t\t\t(LINKED_LIST_START_X + lastX) / 2,\n\t\t\t\t\t\tlastY + LINKED_LIST_ELEM_HEIGHT * 3\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tfor (let i = 0; i < this.size - 1; i++) {\n\t\t\t\t\t\tconst nextX =\n\t\t\t\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\t\t\tconst nextY =\n\t\t\t\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\t\t\t\tLINKED_LIST_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1]\n\t\t\t\t\t); // Disconnect curved pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 2],\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1]\n\t\t\t\t\t); // Connect with normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.disconnect,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0]\n\t\t\t\t\t); // Disconnect normal pointer\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[this.size - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5\n\t\t\t\t\t); // Connect with curved pointer\n\t\t\t\t\tthis.cmd(act.move, this.linkedListElemID[i], lastX, lastY);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\t\t\tthis.cmd(act.delete, labPushValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index - 1], this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index], this.linkedListElemID[index + 1]);\n\n\t\t\t\tthis.size = this.size + 1;\n\t\t\t\tthis.resetNodePositions();\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\t// O(1) remove from front trick\n\t\t\t\tconst labCopiedValID = this.nextIndex++;\n\t\t\t\tconst secondNodeX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING;\n\t\t\t\tconst secondNodeY = LINKED_LIST_START_Y;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tlabCopiedValID,\n\t\t\t\t\tthis.arrayData[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, labCopiedValID, LINKED_LIST_START_X, LINKED_LIST_START_Y);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.setText, this.linkedListElemID[0], this.arrayData[1]);\n\t\t\t\tthis.cmd(act.delete, labCopiedValID);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.linkedListElemID[1],\n\t\t\t\t\tsecondNodeX,\n\t\t\t\t\tsecondNodeY - LINKED_LIST_ELEM_HEIGHT * 2\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(act.disconnect, this.linkedListElemID[0], this.linkedListElemID[1]);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[0], this.linkedListElemID[2]);\n\t\t\t\t}\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tif (this.size === 2) {\n\t\t\t\t\t// Only one node will remain, connect it to itself\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\t// Normal remove\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectCurve,\n\t\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\t\tthis.linkedListElemID[0],\n\t\t\t\t\t\t-0.5\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst removedNodeIndex = index === 0 ? 1 : index; // If deleting from front, we need to remove the second node\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[removedNodeIndex]);\n\t\t\tfor (let i = removedNodeIndex; i < this.size; i++) {\n\t\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[0]);\n\t\t}\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst MAX_HASH_LENGTH = 10;\n\nconst HASH_NUMBER_START_X = 200;\nconst HASH_X_DIFF = 7;\nconst HASH_NUMBER_START_Y = 10;\nconst HASH_ADD_START_Y = 30;\nconst HASH_INPUT_START_X = 60;\nconst HASH_INPUT_X_DIFF = 7;\nconst HASH_INPUT_START_Y = 45;\nconst HASH_ADD_LINE_Y = 42;\nconst HASH_RESULT_Y = 50;\nconst ELF_HASH_SHIFT = 10;\n\nconst HASH_LABEL_X = 300;\nconst HASH_LABEL_Y = 30;\nconst HASH_LABEL_DELTA_X = 50;\n\nconst HIGHLIGHT_COLOR = '#0000FF';\n\nexport default class Hash extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.hashingIntegers = true;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.size = MAX_HASH_LENGTH;\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.size = MAX_HASH_LENGTH;\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.size = MAX_HASH_LENGTH;\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_HASH_LENGTH,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Hash Integer', 'Hash Strings'],\n\t\t\t'HashType'\n\t\t);\n\t\tthis.hashIntegerButton = radioButtonList[0];\n\t\tthis.hashIntegerButton.onclick = this.changeHashTypeCallback.bind(this, true);\n\t\tthis.controls.push(this.hashIntegerButton);\n\t\tthis.hashStringButton = radioButtonList[1];\n\t\tthis.hashStringButton.onclick = this.changeHashTypeCallback.bind(this, false);\n\t\tthis.hashIntegerButton.checked = true;\n\t\tthis.controls.push(this.hashStringButton);\n\t}\n\n\t// Do this extra level of wrapping to get undo to work properly.\n\t// (also, so that we only implement the action if we are changing the\n\t// radio button)\n\tchangeHashTypeCallback(newHashingIntegers) {\n\t\tif (this.hashingIntegers !== newHashingIntegers) {\n\t\t\tthis.implementAction(this.changeHashType.bind(this), newHashingIntegers);\n\t\t}\n\t}\n\n\tchangeHashType(newHashingIntegerValue) {\n\t\tthis.hashingIntegers = newHashingIntegerValue;\n\t\tif (this.hashingIntegers) {\n\t\t\tthis.hashIntegerButton.checked = true;\n\t\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\ttrue\n\t\t\t);\n\t\t} else {\n\t\t\tthis.hashStringButton.checked = true;\n\t\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.insertCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.deleteCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse\n\t\t\t);\n\t\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\t\tthis.insertField,\n\t\t\t\tthis.findCallback.bind(this),\n\t\t\t\tMAX_HASH_LENGTH,\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\t\treturn this.resetAll();\n\t}\n\n\tdoHash(input) {\n\t\tif (this.hashingIntegers) {\n\t\t\tconst labelID1 = this.nextIndex++;\n\t\t\tconst labelID2 = this.nextIndex++;\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tconst index = parseInt(input) % this.table_size;\n\t\t\tthis.currHash = parseInt(input);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID1,\n\t\t\t\tinput + ' % ' + String(this.table_size) + ' = ',\n\t\t\t\tHASH_LABEL_X,\n\t\t\t\tHASH_LABEL_Y\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabelID2,\n\t\t\t\tindex,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_LABEL_X + HASH_LABEL_DELTA_X,\n\t\t\t\tHASH_LABEL_Y\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, labelID1);\n\t\t\tthis.cmd(act.delete, labelID2);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.nextIndex -= 3;\n\n\t\t\treturn index;\n\t\t} else {\n\t\t\tconst label1 = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, label1, 'Hashing:', 10, 45, 0);\n\t\t\tconst wordToHashID = new Array(input.length);\n\t\t\tconst wordToHash = new Array(input.length);\n\t\t\tfor (let i = 0; i < input.length; i++) {\n\t\t\t\twordToHashID[i] = this.nextIndex++;\n\t\t\t\twordToHash[i] = input.charAt(i);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\twordToHashID[i],\n\t\t\t\t\twordToHash[i],\n\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst digits = new Array(32);\n\t\t\tconst hashValue = new Array(32);\n\t\t\tconst nextByte = new Array(8);\n\t\t\tconst nextByteID = new Array(8);\n\t\t\tconst resultDigits = new Array(32);\n\t\t\tconst floatingDigits = new Array(4);\n\t\t\tconst floatingVals = new Array(4);\n\n\t\t\tconst operatorID = this.nextIndex++;\n\t\t\tconst barID = this.nextIndex++;\n\t\t\tfor (let i = 0; i < 32; i++) {\n\t\t\t\thashValue[i] = 0;\n\t\t\t\tdigits[i] = this.nextIndex++;\n\t\t\t\tresultDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 8; i++) {\n\t\t\t\tnextByteID[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tfor (let i = 0; i < 4; i++) {\n\t\t\t\tfloatingDigits[i] = this.nextIndex++;\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let i = wordToHash.length - 1; i >= 0; i--) {\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, wordToHashID[i]);\n\t\t\t\tlet nextChar = wordToHash[i].charCodeAt(0);\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\tnextByte[j] = nextChar % 2;\n\t\t\t\t\tnextChar = Math.floor(nextChar / 2);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tnextByte[j],\n\t\t\t\t\t\tHASH_INPUT_START_X + i * HASH_INPUT_X_DIFF,\n\t\t\t\t\t\tHASH_INPUT_START_Y,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tnextByteID[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 24) * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_ADD_START_Y\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tbarID,\n\t\t\t\t\t'',\n\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t0,\n\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t'left',\n\t\t\t\t\t'bottom'\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.createLabel, operatorID, '+', HASH_NUMBER_START_X, HASH_ADD_START_Y, 0);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tlet carry = 0;\n\t\t\t\tfor (let j = 7; j >= 0; j--) {\n\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] + nextByte[j] + carry;\n\t\t\t\t\tif (hashValue[j + 24] > 1) {\n\t\t\t\t\t\thashValue[j + 24] = hashValue[j + 24] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 23; j >= 0; j--) {\n\t\t\t\t\thashValue[j] = hashValue[j] + carry;\n\t\t\t\t\tif (hashValue[j] > 1) {\n\t\t\t\t\t\thashValue[j] = hashValue[j] - 2;\n\t\t\t\t\t\tcarry = 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcarry = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tfor (let j = 0; j < 8; j++) {\n\t\t\t\t\tthis.cmd(act.delete, nextByteID[j]);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\tHASH_NUMBER_START_Y\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j - 4) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 28; j++) {\n\t\t\t\t\t\tfloatingVals[j] = hashValue[j];\n\t\t\t\t\t\thashValue[j] = hashValue[j + 4];\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tresultDigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + ELF_HASH_SHIFT) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_ADD_START_Y\n\t\t\t\t\t\t);\n\t\t\t\t\t\thashValue[j + 28] = 0;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tfloatingDigits[j],\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + (j + 28) * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (floatingVals[j]) {\n\t\t\t\t\t\t\thashValue[j + ELF_HASH_SHIFT] = 1 - hashValue[j + ELF_HASH_SHIFT];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createRectangle,\n\t\t\t\t\t\tbarID,\n\t\t\t\t\t\t'',\n\t\t\t\t\t\t32 * HASH_X_DIFF,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_LINE_Y,\n\t\t\t\t\t\t'left',\n\t\t\t\t\t\t'bottom'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\toperatorID,\n\t\t\t\t\t\t'XOR',\n\t\t\t\t\t\tHASH_NUMBER_START_X,\n\t\t\t\t\t\tHASH_ADD_START_Y,\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\thashValue[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_RESULT_Y,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\tthis.cmd(act.delete, operatorID);\n\t\t\t\t\tthis.cmd(act.delete, barID);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tdigits[j],\n\t\t\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\t\t\tHASH_NUMBER_START_Y\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tfor (let j = 0; j < 4; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, floatingDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\t\t\tthis.cmd(act.delete, resultDigits[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tdigits[j],\n\t\t\t\t\thashValue[j],\n\t\t\t\t\tHASH_NUMBER_START_X + j * HASH_X_DIFF,\n\t\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.currHash = 0;\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.currHash = this.currHash * 2 + hashValue[j];\n\t\t\t}\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel1,\n\t\t\t\t' = ' + String(this.currHash),\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let j = 0; j < 32; j++) {\n\t\t\t\tthis.cmd(act.delete, digits[j]);\n\t\t\t}\n\n\t\t\tconst label2 = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tlabel1,\n\t\t\t\tString(this.currHash) + ' % ' + String(this.table_size) + ' = '\n\t\t\t);\n\t\t\tconst index = this.currHash % this.table_size;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tlabel2,\n\t\t\t\tindex,\n\t\t\t\tHASH_NUMBER_START_X + 32 * HASH_X_DIFF + 105,\n\t\t\t\tHASH_NUMBER_START_Y,\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightID,\n\t\t\t\tHIGHLIGHT_COLOR,\n\t\t\t\tHASH_NUMBER_START_X + 30 * HASH_X_DIFF + 120,\n\t\t\t\tHASH_NUMBER_START_Y + 15\n\t\t\t);\n\t\t\tthis.cmd(act.move, highlightID, this.indexXPos[index], this.indexYPos[index]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, highlightID);\n\t\t\tthis.cmd(act.delete, label1);\n\t\t\tthis.cmd(act.delete, label2);\n\n\t\t\treturn index;\n\t\t}\n\t}\n\n\tresetAll() {\n\t\tthis.insertField.value = '';\n\t\tthis.deleteField.value = '';\n\t\tthis.findField.value = '';\n\t\treturn [];\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.insertField.value;\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), insertedValue);\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tconst deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), deletedValue);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.findField.value;\n\t\tif (findValue !== '') {\n\t\t\tthis.findField.value = '';\n\t\t\tthis.implementAction(this.findElement.bind(this), findValue);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.hashIntegerButton.checked = true;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport { addDivisorToAlgorithmBar, addRadioButtonGroupToAlgorithmBar } from './Algorithm.js';\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_ELEM_WIDTH = 90;\nconst ARRAY_ELEM_HEIGHT = 30;\nconst ARRAY_ELEM_START_X = 50;\nconst ARRAY_ELEM_START_Y = 100;\nconst ARRAY_VERTICAL_SEPARATION = 100;\n\nconst CLOSED_HASH_TABLE_SIZE = 29;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class ClosedHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.elements_per_row = Math.floor(w / ARRAY_ELEM_WIDTH);\n\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t[\n\t\t\t\t'Linear Probing: f(i) = i',\n\t\t\t\t'Quadratic Probing: f(i) = i * i',\n\t\t\t\t'Double Hashing: f(i) = i * hash2(elem)',\n\t\t\t],\n\t\t\t'CollisionStrategy'\n\t\t);\n\t\tthis.linearProblingButton = radioButtonList[0];\n\t\tthis.linearProblingButton.onclick = this.linearProbeCallback.bind(this);\n\t\tthis.quadraticProbingButton = radioButtonList[1];\n\t\tthis.quadraticProbingButton.onclick = this.quadraticProbeCallback.bind(this);\n\t\tthis.doubleHashingButton = radioButtonList[2];\n\t\tthis.doubleHashingButton.onclick = this.doubleHashingCallback.bind(this);\n\n\t\tthis.linearProblingButton.checked = true;\n\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\n\t\t// Add new controls\n\t}\n\n\tchangeProbeType(newProbingType) {\n\t\tif (newProbingType === this.linearProblingButton) {\n\t\t\tthis.linearProblingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.linearProblingButton;\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i;\n\t\t\t}\n\t\t} else if (newProbingType === this.quadraticProbingButton) {\n\t\t\tthis.quadraticProbingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.quadraticProbingButton;\n\n\t\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\t\tthis.skipDist[i] = i * i;\n\t\t\t}\n\t\t} else if (newProbingType === this.doubleHashingButton) {\n\t\t\tthis.doubleHashingButton.checked = true;\n\t\t\tthis.currentHashingTypeButtonState = this.doubleHashingButton;\n\t\t}\n\t\tthis.commands = this.resetAll();\n\t\treturn this.commands;\n\t}\n\n\tquadraticProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.quadraticProbingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.quadraticProbingButton);\n\t\t}\n\t}\n\n\tdoubleHashingCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.doubleHashingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.doubleHashingButton);\n\t\t}\n\t}\n\n\tlinearProbeCallback() {\n\t\tif (this.currentHashingTypeButtonState !== this.linearProblingButton) {\n\t\t\tthis.implementAction(this.changeProbeType.bind(this), this.linearProblingButton);\n\t\t}\n\t}\n\n\tinsertElement(elem) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element: ' + String(elem));\n\t\tlet index = this.doHash(elem);\n\n\t\tindex = this.getEmptyIndex(index, elem);\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\t\tif (index !== -1) {\n\t\t\tconst labID = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, labID, elem, 20, 25);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tlabID,\n\t\t\t\tthis.indexXPos[index],\n\t\t\t\tthis.indexYPos[index] - ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, labID);\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], elem);\n\t\t\tthis.hashTableValues[index] = elem;\n\t\t\tthis.empty[index] = false;\n\t\t\tthis.deleted[index] = false;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tresetSkipDist(elem, labelID) {\n\t\tconst skipVal = 7 - (this.currHash % 7);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabelID,\n\t\t\t'hash2(' +\n\t\t\t\tString(elem) +\n\t\t\t\t') = 1 - ' +\n\t\t\t\tString(this.currHash) +\n\t\t\t\t' % 7 = ' +\n\t\t\t\tString(skipVal),\n\t\t\t20,\n\t\t\t45,\n\t\t\t0\n\t\t);\n\t\tthis.skipDist[0] = 0;\n\t\tfor (let i = 1; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = this.skipDist[i - 1] + skipVal;\n\t\t}\n\t}\n\n\tgetEmptyIndex(index, elem) {\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tthis.resetSkipDist(elem, this.nextIndex++);\n\t\t}\n\t\tlet foundIndex = -1;\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst candidateIndex = (index + this.skipDist[i]) % this.table_size;\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 0);\n\t\t\tif (this.empty[candidateIndex]) {\n\t\t\t\tfoundIndex = candidateIndex;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tthis.cmd(act.delete, --this.nextIndex);\n\t\t}\n\t\treturn foundIndex;\n\t}\n\n\tgetElemIndex(index, elem) {\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tthis.resetSkipDist(elem, this.nextIndex++);\n\t\t}\n\t\tlet foundIndex = -1;\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tconst candidateIndex = (index + this.skipDist[i]) % this.table_size;\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.hashTableVisual[candidateIndex], 0);\n\t\t\tif (!this.empty[candidateIndex] && this.hashTableValues[candidateIndex] === elem) {\n\t\t\t\tfoundIndex = candidateIndex;\n\t\t\t\tbreak;\n\t\t\t} else if (this.empty[candidateIndex] && !this.deleted[candidateIndex]) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (this.currentHashingTypeButtonState === this.doubleHashingButton) {\n\t\t\tthis.cmd(act.delete, --this.nextIndex);\n\t\t}\n\t\treturn foundIndex;\n\t}\n\n\tdeleteElement(elem) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting element: ' + elem);\n\t\tlet index = this.doHash(elem);\n\n\t\tindex = this.getElemIndex(index, elem);\n\n\t\tif (index > 0) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element deleted'\n\t\t\t);\n\t\t\tthis.empty[index] = true;\n\t\t\tthis.deleted[index] = true;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[index], '<deleted>');\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(elem) {\n\t\tthis.commands = [];\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem);\n\t\tconst index = this.doHash(elem);\n\n\t\tconst found = this.getElemIndex(index, elem) !== -1;\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem + '  Found!');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem + '  Not Found!');\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.table_size = CLOSED_HASH_TABLE_SIZE;\n\t\tthis.skipDist = new Array(this.table_size);\n\t\tthis.hashTableVisual = new Array(this.table_size);\n\t\tthis.hashTableIndices = new Array(this.table_size);\n\t\tthis.hashTableValues = new Array(this.table_size);\n\n\t\tthis.indexXPos = new Array(this.table_size);\n\t\tthis.indexYPos = new Array(this.table_size);\n\n\t\tthis.empty = new Array(this.table_size);\n\t\tthis.deleted = new Array(this.table_size);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.skipDist[i] = i; // Start with linear probing\n\t\t\tlet nextID = this.nextIndex++;\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\n\t\t\tconst nextXPos = ARRAY_ELEM_START_X + (i % this.elements_per_row) * ARRAY_ELEM_WIDTH;\n\t\t\tconst nextYPos =\n\t\t\t\tARRAY_ELEM_START_Y +\n\t\t\t\tMath.floor(i / this.elements_per_row) * ARRAY_VERTICAL_SEPARATION;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tnextXPos,\n\t\t\t\tnextYPos\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.indexXPos[i] = nextXPos;\n\t\t\tthis.indexYPos[i] = nextYPos + ARRAY_ELEM_HEIGHT;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', 10, 25, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.resetIndex = this.nextIndex;\n\t}\n\n\tresetAll() {\n\t\tthis.commands = super.resetAll();\n\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t\tthis.cmd(act.setText, this.hashTableVisual[i], '');\n\t\t}\n\t\treturn this.commands;\n\t\t// Clear array, etc\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.empty[i] = true;\n\t\t\tthis.deleted[i] = false;\n\t\t}\n\t\tthis.nextIndex = this.resetIndex;\n\t\tsuper.reset();\n\t}\n\n\tresetCallback() {}\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t\tthis.linearProblingButton.disabled = true;\n\t\tthis.quadraticProbingButton.disabled = true;\n\t\tthis.doubleHashingButton.disabled = true;\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t\tthis.linearProblingButton.disabled = false;\n\t\tthis.quadraticProbingButton.disabled = false;\n\t\tthis.doubleHashingButton.disabled = false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nlet lastSwapEnabled = true;\n\nexport default class CocktailSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Last swap optimization toggle\n\t\tthis.lastSwapCheckbox = addCheckboxToAlgorithmBar('Enable last swap optimization', true);\n\t\tthis.lastSwapCheckbox.onclick = this.toggleLastSwap.bind(this);\n\t\tthis.controls.push(this.lastSwapCheckbox);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\ttoggleLastSwap() {\n\t\tlastSwapEnabled = !lastSwapEnabled;\n\t}\n\n\tclear() {\n\t\tthis.arrayData = [];\n\t\tthis.commands = [];\n\t\tthis.displayData = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tlet sorted = true;\n\t\tlet start = 0;\n\t\tlet end = this.arrayData.length - 1;\n\t\tlet lastSwapped = 0;\n\t\tdo {\n\t\t\tsorted = true;\n\t\t\tfor (let i = start; i < end; i++) {\n\t\t\t\tthis.movePointers(i, i + 1);\n\t\t\t\tif (this.arrayData[i] > this.arrayData[i + 1]) {\n\t\t\t\t\tthis.swap(i, i + 1);\n\t\t\t\t\tsorted = false;\n\t\t\t\t\tlastSwapped = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (lastSwapEnabled) {\n\t\t\t\tend = lastSwapped;\n\t\t\t} else {\n\t\t\t\tend--;\n\t\t\t}\n\t\t\tif (!sorted) {\n\t\t\t\tfor (let i = end + 1; i < this.arrayData.length; i++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (!sorted) {\n\t\t\t\tsorted = true;\n\t\t\t\tfor (let i = end; i > start; i--) {\n\t\t\t\t\tthis.movePointers(i - 1, i);\n\t\t\t\t\tif (+this.arrayData[i] < +this.arrayData[i - 1]) {\n\t\t\t\t\t\tthis.swap(i, i - 1);\n\t\t\t\t\t\tsorted = false;\n\t\t\t\t\t\tlastSwapped = i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (lastSwapEnabled) {\n\t\t\t\t\tstart = lastSwapped;\n\t\t\t\t} else {\n\t\t\t\t\tstart++;\n\t\t\t\t}\n\t\t\t\tif (!sorted) {\n\t\t\t\t\tfor (let i = start - 1; i >= 0; i--) {\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t} while (!sorted);\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap actual data\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap displayed data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\nimport {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst TERMINATION_MSG_X = 25;\nconst TERMINATION_MSG_Y = 15;\n\nconst AUX_ARRAY_WIDTH = 25;\nconst AUX_ARRAY_HEIGHT = 25;\nconst AUX_ARRAY_START_Y = 50;\n\nconst VISITED_START_X = 475;\n\nconst HIGHLIGHT_CIRCLE_COLOR = '#000000';\nconst DFS_TREE_COLOR = '#0000FF';\nconst DFS_STACK_TOP_COLOR = '#0000FF';\n\nconst LIST_START_X = 30;\nconst LIST_START_Y = 70;\nconst LIST_SPACING = 20;\n\nconst CURRENT_VERTEX_LABEL_X = 25;\nconst CURRENT_VERTEX_LABEL_Y = 110;\nconst CURRENT_VERTEX_X = 115;\nconst CURRENT_VERTEX_Y = 116;\n\nconst STACK_LABEL_X = 25;\nconst STACK_LABEL_Y = 140;\n\nconst STACK_START_X = 60;\nconst STACK_START_Y = 420;\nconst STACK_SPACING = 30;\n\nconst RECURSION_START_X = 30;\nconst RECURSION_START_Y = 170;\n\nconst CHECKMARK = '\\u2713';\n\nexport default class DFS extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, false);\n\t\tthis.showEdgeCosts = false;\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse\n\t\t);\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run DFS');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst radioButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['Stack', 'Recursion'],\n\t\t\t'StackType'\n\t\t);\n\t\tthis.physicalStackButton = radioButtonList[0];\n\t\tthis.recursiveStackButton = radioButtonList[1];\n\t\tthis.physicalStackButton.onclick = () => (this.stackType = 'physical');\n\t\tthis.recursiveStackButton.onclick = () => (this.stackType = 'recursive');\n\t\tthis.physicalStackButton.checked = true;\n\t\tthis.stackType = 'physical';\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.commands = [];\n\t\tthis.messageID = [];\n\n\t\tthis.visitedID = new Array(this.size);\n\t\tthis.visitedIndexID = new Array(this.size);\n\n\t\tthis.visited = [];\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.visitedID[i] = this.nextIndex++;\n\t\t\tthis.visitedIndexID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.visitedID[i],\n\t\t\t\t'',\n\t\t\t\tAUX_ARRAY_WIDTH,\n\t\t\t\tAUX_ARRAY_HEIGHT,\n\t\t\t\tVISITED_START_X,\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.visitedIndexID[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\n\t\t\t\tAUX_ARRAY_START_Y + i * AUX_ARRAY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.visitedIndexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\n\t\tthis.terminationLabelID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.terminationLabelID,\n\t\t\t'',\n\t\t\tTERMINATION_MSG_X,\n\t\t\tTERMINATION_MSG_Y,\n\t\t\t0\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited:',\n\t\t\tVISITED_START_X - AUX_ARRAY_WIDTH,\n\t\t\tAUX_ARRAY_START_Y - AUX_ARRAY_HEIGHT * 1.5,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'List:',\n\t\t\tLIST_START_X - 5,\n\t\t\tLIST_START_Y - 30,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Current vertex:',\n\t\t\tCURRENT_VERTEX_LABEL_X,\n\t\t\tCURRENT_VERTEX_LABEL_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Stack / Recursive calls:',\n\t\t\tSTACK_LABEL_X,\n\t\t\tSTACK_LABEL_Y,\n\t\t\t0\n\t\t);\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.highlightCircleL = this.nextIndex++;\n\t\tthis.highlightCircleAL = this.nextIndex++;\n\t\tthis.highlightCircleAM = this.nextIndex++;\n\t\tthis.lastIndex = this.nextIndex;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = this.lastIndex;\n\t\tthis.listID = [];\n\t\tthis.messageID = [];\n\t}\n\n\tstartCallback() {\n\t\tif (this.startField.value !== '') {\n\t\t\tlet startvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size) {\n\t\t\t\tif (this.stackType === 'physical') {\n\t\t\t\t\tthis.implementAction(this.doDFSStack.bind(this), startvalue);\n\t\t\t\t} else {\n\t\t\t\t\tthis.implementAction(this.doDFSRecursive.bind(this), startvalue);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdoDFSStack(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.stack = [];\n\t\tthis.stackID = [];\n\t\tthis.listID = [];\n\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.rebuildEdges();\n\t\tthis.messageID = [];\n\n\t\tthis.cmd(act.setText, this.terminationLabelID, '');\n\t\tlet vertex = startVertex;\n\t\tlet vertexID = this.nextIndex++;\n\t\tthis.visited[vertex] = true;\n\t\tthis.cmd(act.setText, this.visitedID[vertex], CHECKMARK);\n\t\tthis.cmd(act.setBackgroundColor, this.circleID[vertex], \"#99CCFF\");\n\t\tthis.stack.push(vertex);\n\t\tthis.stackID.push(vertexID);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tvertexID,\n\t\t\tString.fromCharCode(65 + vertex),\n\t\t\tSTACK_START_X,\n\t\t\tSTACK_START_Y\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (this.stack.length > 0 && this.listID.length < this.size) {\n\t\t\tvertex = this.stack.pop();\n\t\t\tvertexID = this.stackID.pop();\n\n\t\t\tthis.cmd(act.setTextColor, vertexID, DFS_STACK_TOP_COLOR);\n\t\t\tthis.cmd(act.move, vertexID, CURRENT_VERTEX_X, CURRENT_VERTEX_Y);\n\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tString.fromCharCode(65 + vertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleL,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.x_pos_logical[vertex],\n\t\t\t\tthis.y_pos_logical[vertex]\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleL, 1);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleAL,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\tthis.adj_list_y_start + vertex * this.adj_list_height\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleAL, 2);\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightCircleAM,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\tthis.adj_matrix_y_start + vertex * this.adj_matrix_height\n\t\t\t);\n\t\t\tthis.cmd(act.setLayer, this.highlightCircleAM, 3);\n\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[vertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.visited[neighbor] = true;\n\t\t\t\t\t\tthis.cmd(act.setText, this.visitedID[neighbor], CHECKMARK);\n\t\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[neighbor], \"#99CCFF\")\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[vertex], this.circleID[neighbor]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[vertex],\n\t\t\t\t\t\t\tthis.circleID[neighbor],\n\t\t\t\t\t\t\tDFS_TREE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[vertex][neighbor],\n\t\t\t\t\t\t\t\tthis.adj_matrix[neighbor][vertex] >= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.directed,\n\t\t\t\t\t\t\t''\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.stack.push(neighbor);\n\t\t\t\t\t\tthis.stackID.push(this.nextIndex);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t\t\tString.fromCharCode(65 + neighbor),\n\t\t\t\t\t\t\tSTACK_START_X,\n\t\t\t\t\t\t\tSTACK_START_Y - (this.stack.length - 1) * STACK_SPACING\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.highlightEdge(vertex, neighbor, 0);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 0);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, vertexID);\n\n\t\t\tthis.cmd(act.delete, this.highlightCircleL);\n\t\t\tthis.cmd(act.delete, this.highlightCircleAM);\n\t\t\tthis.cmd(act.delete, this.highlightCircleAL);\n\t\t}\n\n\t\tif (this.stack.length > 0) {\n\t\t\tthis.cmd(act.setText, this.terminationLabelID, 'All vertices have been visited, done.');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.terminationLabelID, 'Stack is empty, done.');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoDFSRecursive(startVertex) {\n\t\tthis.commands = [];\n\n\t\tthis.clear();\n\n\t\tthis.visited = new Array(this.size);\n\t\tthis.listID = [];\n\t\tthis.currentID = this.nextIndex++;\n\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.rebuildEdges();\n\t\tthis.messageID = [];\n\n\t\tthis.cmd(act.setText, this.terminationLabelID, '');\n\n\t\tconst vertex = startVertex;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.currentID,\n\t\t\t'',\n\t\t\tCURRENT_VERTEX_X,\n\t\t\tCURRENT_VERTEX_Y\n\t\t);\n\t\tthis.cmd(act.setTextColor, this.currentID, DFS_STACK_TOP_COLOR);\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.x_pos_logical[vertex],\n\t\t\tthis.y_pos_logical[vertex]\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleL, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAL,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\tthis.adj_list_y_start + vertex * this.adj_list_height\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAL, 2);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.highlightCircleAM,\n\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\tthis.adj_matrix_y_start + vertex * this.adj_matrix_height\n\t\t);\n\t\tthis.cmd(act.setLayer, this.highlightCircleAM, 3);\n\n\t\tthis.messageY = RECURSION_START_Y;\n\t\tthis.dfsVisit(vertex, RECURSION_START_X);\n\n\t\tthis.cmd(act.setText, this.terminationLabelID, 'Done.');\n\t\tthis.cmd(act.delete, this.highlightCircleL);\n\t\tthis.cmd(act.delete, this.highlightCircleAL);\n\t\tthis.cmd(act.delete, this.highlightCircleAM);\n\n\t\treturn this.commands;\n\t}\n\n\tdfsVisit(startVertex, messageX) {\n\t\tlet nextMessage = this.nextIndex++;\n\t\tthis.messageID.push(nextMessage);\n\n\t\tthis.cmd(act.setText, this.currentID, String.fromCharCode(65 + startVertex));\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tnextMessage,\n\t\t\t'DFS(' + String.fromCharCode(65 + startVertex) + ')',\n\t\t\tmessageX,\n\t\t\tthis.messageY,\n\t\t\t0\n\t\t);\n\t\tthis.messageY = this.messageY + 20;\n\t\tif (!this.visited[startVertex]) {\n\t\t\tthis.visited[startVertex] = true;\n\t\t\tthis.listID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tString.fromCharCode(65 + startVertex),\n\t\t\t\tLIST_START_X + (this.listID.length - 1) * LIST_SPACING,\n\t\t\t\tLIST_START_Y\n\t\t\t);\n\t\t\tthis.cmd(act.setText, this.visitedID[startVertex], CHECKMARK);\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[startVertex], \"#99CCFF\");\n\t\t\tthis.cmd(act.step);\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[startVertex][neighbor] > 0) {\n\t\t\t\t\tthis.highlightEdge(startVertex, neighbor, 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 1);\n\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\tnextMessage = this.nextIndex;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tnextMessage,\n\t\t\t\t\t\t\t'Vertex ' + String.fromCharCode(65 + neighbor) + ' already visited.',\n\t\t\t\t\t\t\tmessageX,\n\t\t\t\t\t\t\tthis.messageY,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.highlightEdge(startVertex, neighbor, 0);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.visitedID[neighbor], 0);\n\t\t\t\t\tif (this.visited[neighbor]) {\n\t\t\t\t\t\tthis.cmd(act.delete, nextMessage);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.visited[neighbor]) {\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.circleID[startVertex], this.circleID[neighbor]);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.circleID[startVertex],\n\t\t\t\t\t\t\tthis.circleID[neighbor],\n\t\t\t\t\t\t\tDFS_TREE_COLOR,\n\t\t\t\t\t\t\tthis.adjustCurveForDirectedEdges(\n\t\t\t\t\t\t\t\tthis.curve[startVertex][neighbor],\n\t\t\t\t\t\t\t\tthis.adj_matrix[neighbor][startVertex] >= 0\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.directed,\n\t\t\t\t\t\t\t''\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleL,\n\t\t\t\t\t\t\tthis.x_pos_logical[neighbor],\n\t\t\t\t\t\t\tthis.y_pos_logical[neighbor]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleAL,\n\t\t\t\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\t\t\t\tthis.adj_list_y_start + neighbor * this.adj_list_height\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleAM,\n\t\t\t\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\t\t\t\tthis.adj_matrix_y_start + neighbor * this.adj_matrix_height\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.dfsVisit(neighbor, messageX + 20);\n\t\t\t\t\t\tnextMessage = this.nextIndex;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tnextMessage,\n\t\t\t\t\t\t\t'Returning from recursive call: DFS(' +\n\t\t\t\t\t\t\t\tString.fromCharCode(65 + neighbor) +\n\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\tmessageX + 20,\n\t\t\t\t\t\t\tthis.messageY,\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleAL,\n\t\t\t\t\t\t\tthis.adj_list_x_start - this.adj_list_width,\n\t\t\t\t\t\t\tthis.adj_list_y_start + startVertex * this.adj_list_height\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleL,\n\t\t\t\t\t\t\tthis.x_pos_logical[startVertex],\n\t\t\t\t\t\t\tthis.y_pos_logical[startVertex]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tthis.highlightCircleAM,\n\t\t\t\t\t\t\tthis.adj_matrix_x_start - this.adj_matrix_width,\n\t\t\t\t\t\t\tthis.adj_matrix_y_start + startVertex * this.adj_matrix_height\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, nextMessage);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclear() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.circleID[i], \"#FFFFFF\");\n\t\t\tthis.cmd(act.setText, this.visitedID[i], '');\n\t\t\tthis.visited[i] = false;\n\t\t}\n\t\tfor (let i = 0; i < this.listID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.listID[i]);\n\t\t}\n\t}\n\n\tenableUI(event) {\n\t\tthis.startField.disabled = false;\n\t\tthis.startButton.disabled = false;\n\t\tthis.physicalStackButton.disabled = false;\n\t\tthis.recursiveStackButton.disabled = false;\n\n\t\tsuper.enableUI(event);\n\t}\n\n\tdisableUI(event) {\n\t\tthis.startField.disabled = true;\n\t\tthis.startButton.disabled = true;\n\t\tthis.physicalStackButton.disabled = true;\n\t\tthis.recursiveStackButton.disabled = true;\n\n\t\tsuper.disableUI(event);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class DPLCS extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.nextIndex = 0;\n\t\tthis.addControls();\n\t\tthis.code = [\n\t\t\t['def ', 'LCS(S1, S2, x, y)', ':'],\n\t\t\t['     if (', '(x == -1) ', ' or ', '(y == -1)', ')'],\n\t\t\t['          return 0'],\n\t\t\t['     else if ', '(S1[x] == S2[y])'],\n\t\t\t['          return 1 + ', 'LCS(S1, S2, x-1, y-1)'],\n\t\t\t['     else'],\n\t\t\t['          return max(', 'LCS(S1, S2, x-1, y)', ',', 'LCS(S1, S2, x, y-1)', ')'],\n\t\t];\n\n\t\tthis.codeID = Array(this.code.length);\n\t\tlet i, j;\n\t\tfor (i = 0; i < this.code.length; i++) {\n\t\t\tthis.codeID[i] = new Array(this.code[i].length);\n\t\t\tfor (j = 0; j < this.code[i].length; j++) {\n\t\t\t\tthis.codeID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.codeID[i][j],\n\t\t\t\t\tthis.code[i][j],\n\t\t\t\t\tDPLCS.CODE_START_X,\n\t\t\t\t\tDPLCS.CODE_START_Y + i * DPLCS.CODE_LINE_HEIGHT,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[i][j], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\tif (j > 0) {\n\t\t\t\t\tthis.cmd(act.alignRight, this.codeID[i][j], this.codeID[i][j - 1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.initialIndex = this.nextIndex;\n\t\tthis.oldIDs = [];\n\t\tthis.commands = [];\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\taddLabelToAlgorithmBar('S1:');\n\t\tthis.S1Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S1Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S1Field,\n\t\t\tthis.emptyCallback.bind(this),\n\t\t\tDPLCS.MAX_SEQUENCE_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.S1Field);\n\n\t\taddLabelToAlgorithmBar('S2:');\n\t\tthis.S2Field = addControlToAlgorithmBar('Text', '');\n\t\tthis.S2Field.onkeydown = this.returnSubmit(\n\t\t\tthis.S2Field,\n\t\t\tthis.emptyCallback.bind(this),\n\t\t\tDPLCS.MAX_SEQUENCE_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.S2Field);\n\n\t\tthis.recursiveButton = addControlToAlgorithmBar('Button', 'LCS Recursive');\n\t\tthis.recursiveButton.onclick = this.recursiveCallback.bind(this);\n\t\tthis.controls.push(this.recursiveButton);\n\n\t\tthis.tableButton = addControlToAlgorithmBar('Button', 'LCS Table');\n\t\tthis.tableButton.onclick = this.tableCallback.bind(this);\n\t\tthis.controls.push(this.tableButton);\n\n\t\tthis.memoizedButton = addControlToAlgorithmBar('Button', 'LCS Memoized');\n\t\tthis.memoizedButton.onclick = this.memoizedCallback.bind(this);\n\t\tthis.controls.push(this.memoizedButton);\n\t}\n\n\tbuildTable(S1, S2) {\n\t\tconst x = S1.length;\n\t\tconst y = S2.length;\n\t\tthis.tableID = new Array(x + 1);\n\t\tthis.tableVals = new Array(x + 1);\n\t\tthis.tableXPos = new Array(x + 1);\n\t\tthis.tableYPos = new Array(x + 1);\n\n\t\tlet i, j;\n\t\t// const sequence1ID = new Array(x);\n\t\t// const sequence2ID = new Array(y);\n\n\t\tthis.S1TableID = new Array(x);\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S1TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S1TableID[i - 1],\n\t\t\t\t\tS1.charAt(i - 1),\n\t\t\t\t\tDPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\t\tDPLCS.TABLE_START_Y - 2 * DPLCS.TABLE_ELEM_HEIGHT\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S1TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1,\n\t\t\t\tDPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\tDPLCS.TABLE_START_Y - 1 * DPLCS.TABLE_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tthis.S2TableID = new Array(y);\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tif (i > 0) {\n\t\t\t\tthis.S2TableID[i - 1] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tthis.S2TableID[i - 1],\n\t\t\t\t\tS2.charAt(i - 1),\n\t\t\t\t\tDPLCS.TABLE_START_X - 2 * DPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\t\tDPLCS.TABLE_START_Y + i * DPLCS.TABLE_ELEM_HEIGHT\n\t\t\t\t);\n\t\t\t\tthis.oldIDs.push(this.S2TableID[i - 1]);\n\t\t\t}\n\t\t\tconst index = this.nextIndex++;\n\t\t\tthis.oldIDs.push(index);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tindex,\n\t\t\t\ti - 1,\n\t\t\t\tDPLCS.TABLE_START_X - 1 * DPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\tDPLCS.TABLE_START_Y + i * DPLCS.TABLE_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, index, '#0000FF');\n\t\t}\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.tableID[i] = new Array(y + 1);\n\t\t\tthis.tableVals[i] = new Array(y + 1);\n\t\t\tthis.tableXPos[i] = new Array(y + 1);\n\t\t\tthis.tableYPos[i] = new Array(y + 1);\n\n\t\t\tfor (j = 0; j <= y; j++) {\n\t\t\t\tthis.tableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.tableVals[i][j] = -1;\n\t\t\t\tthis.oldIDs.push(this.tableID[i][j]);\n\n\t\t\t\tthis.tableXPos[i][j] = DPLCS.TABLE_START_X + i * DPLCS.TABLE_ELEM_WIDTH;\n\t\t\t\tthis.tableYPos[i][j] = DPLCS.TABLE_START_Y + j * DPLCS.TABLE_ELEM_HEIGHT;\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.tableID[i][j],\n\t\t\t\t\t'',\n\t\t\t\t\tDPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\t\tDPLCS.TABLE_ELEM_HEIGHT,\n\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\tthis.tableYPos[i][j]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearOldIDs() {\n\t\tfor (let i = 0; i < this.oldIDs.length; i++) {\n\t\t\tthis.cmd(act.delete, this.oldIDs[i]);\n\t\t}\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\treset() {\n\t\tthis.oldIDs = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\temptyCallback() {\n\t\tthis.implementAction(this.helpMessage.bind(this));\n\t\t// TODO:  Put up a message to push the appropriate button?\n\t}\n\n\trecursiveCallback() {\n\t\t// let fibValue;\n\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.recursiveLCS.bind(this),\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\n\t\t\t);\n\t\t} else {\n\t\t\tthis.implementAction(this.helpMessage.bind(this));\n\t\t}\n\t}\n\n\ttableCallback() {\n\t\t// let fibValue;\n\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.tableLCS.bind(this),\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\n\t\t\t);\n\t\t} else {\n\t\t\tthis.implementAction(this.helpMessage.bind(this));\n\t\t}\n\t}\n\n\tmemoizedCallback() {\n\t\t// let fibValue;\n\n\t\tif (this.S1Field.value !== '' && this.S2Field.value !== '') {\n\t\t\tthis.implementAction(\n\t\t\t\tthis.memoizedLCS.bind(this),\n\t\t\t\tthis.S1Field.value + ';' + this.S2Field.value\n\t\t\t);\n\t\t} else {\n\t\t\tthis.implementAction(this.helpMessage.bind(this));\n\t\t}\n\t}\n\n\thelpMessage() {\n\t\tthis.commands = [];\n\n\t\tthis.clearOldIDs();\n\n\t\tconst messageID = this.nextIndex++;\n\t\tthis.oldIDs.push(messageID);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tmessageID,\n\t\t\t'Enter two sequences in the text fields.\\n' +\n\t\t\t\t'Then press the LCS Recursive, LCS Table, or LCS Memoized button',\n\t\t\tDPLCS.RECURSIVE_START_X,\n\t\t\tDPLCS.RECURSIVE_START_Y,\n\t\t\t0\n\t\t);\n\t\treturn this.commands;\n\t}\n\n\trecursiveLCS(value) {\n\t\tthis.commands = [];\n\n\t\tconst sequences = value.split(';');\n\n\t\tthis.clearOldIDs();\n\n\t\tthis.currentY = DPLCS.RECURSIVE_START_Y;\n\n\t\tconst functionCallID = this.nextIndex++;\n\t\tthis.oldIDs.push(functionCallID);\n\t\tconst final = this.LCS(\n\t\t\tsequences[0],\n\t\t\tsequences[1],\n\t\t\tsequences[0].length - 1,\n\t\t\tsequences[1].length - 1,\n\t\t\tDPLCS.RECURSIVE_START_X,\n\t\t\tfunctionCallID\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tfunctionCallID,\n\t\t\t'LCS(' +\n\t\t\t\tsequences[0] +\n\t\t\t\t', ' +\n\t\t\t\tsequences[1] +\n\t\t\t\t', ' +\n\t\t\t\tString(sequences[0].length - 1) +\n\t\t\t\t', ' +\n\t\t\t\tString(sequences[1].length - 1) +\n\t\t\t\t') = ' +\n\t\t\t\tString(final)\n\t\t);\n\t\treturn this.commands;\n\t}\n\n\tLCS(S1, S2, x, y, xPos, ID) {\n\t\tconst ID2 = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tID,\n\t\t\t'LCS(' + S1 + ', ' + S2 + ', ' + String(x) + ', ' + String(y) + ')',\n\t\t\txPos,\n\t\t\tthis.currentY,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tID2,\n\t\t\t'        [LCS(' + S1.substring(0, x + 1) + ',' + S2.substring(0, y + 1) + ')]'\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, ID2, '#3333FF');\n\t\tthis.cmd(act.alignRight, ID2, ID);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[0][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[0][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\tif (x === -1 || y === -1) {\n\t\t\tif (x === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t}\n\t\t\tif (y === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][3], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tif (x === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][1], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t}\n\t\t\tif (y === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][3], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[2][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setText, ID, 0);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[2][0], DPLCS.CODE_STANDARD_COLOR);\n\t\t\treturn 0;\n\t\t}\n\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\tif (S1.charAt(x) === S2.charAt(y)) {\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst nextID = this.nextIndex++;\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tconst subProb = this.LCS(S1, S2, x - 1, y - 1, xPos + DPLCS.RECURSIVE_DELTA_X, nextID);\n\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tthis.cmd(act.delete, nextID);\n\t\t\tthis.cmd(act.setText, ID, subProb + 1);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.currentY -= DPLCS.RECURSIVE_DELTA_Y;\n\t\t\treturn subProb + 1;\n\t\t} else {\n\t\t\tconst firstID = this.nextIndex++;\n\t\t\tconst secondID = this.nextIndex++;\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst subProb1 = this.LCS(S1, S2, x - 1, y, xPos + DPLCS.RECURSIVE_DELTA_X, firstID);\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][3], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst subProb2 = this.LCS(S1, S2, x, y - 1, xPos + DPLCS.RECURSIVE_DELTA_X, secondID);\n\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.delete, firstID);\n\t\t\tthis.cmd(act.delete, secondID);\n\t\t\tthis.currentY -= 2 * DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tconst best = Math.max(subProb1, subProb2);\n\t\t\tthis.cmd(act.setText, ID, best);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\treturn best;\n\t\t}\n\t}\n\n\tbuildLCSFromTable(S1, S2) {\n\t\tlet currX = this.tableVals.length - 1;\n\t\tlet currY = this.tableVals[0].length - 1;\n\n\t\tconst sequence = [];\n\n\t\tconst header = this.nextIndex++;\n\t\tthis.oldIDs.push(header);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\theader,\n\t\t\t'Sequence',\n\t\t\tDPLCS.SEQUENCE_START_X,\n\t\t\tDPLCS.SEQUENCE_START_Y - 30,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, header, '#003300');\n\n\t\twhile (currX > 0 && currY > 0) {\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 1);\n\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.S1TableID[currX - 1], 0);\n\t\t\tthis.cmd(act.setHighlight, this.S2TableID[currY - 1], 0);\n\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY], 0);\n\n\t\t\tif (S1.charAt(currX - 1) === S2.charAt(currY - 1)) {\n\t\t\t\tconst nextSequenceID = this.nextIndex++;\n\t\t\t\tthis.oldIDs.push(nextSequenceID);\n\t\t\t\tsequence.push(nextSequenceID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextSequenceID,\n\t\t\t\t\tS1.charAt(currX - 1),\n\t\t\t\t\tDPLCS.TABLE_START_X + currX * DPLCS.TABLE_ELEM_WIDTH,\n\t\t\t\t\tDPLCS.TABLE_START_Y - 2 * DPLCS.TABLE_ELEM_HEIGHT\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setForegroundColor, nextSequenceID, '#0000FF');\n\n\t\t\t\tfor (let i = sequence.length - 1; i >= 0; i--) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tsequence[i],\n\t\t\t\t\t\tDPLCS.SEQUENCE_START_X + (sequence.length - 1 - i) * DPLCS.SEQUENCE_DELTA_X,\n\t\t\t\t\t\tDPLCS.SEQUENCE_START_Y\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tcurrX = currX - 1;\n\t\t\t\tcurrY = currY - 1;\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX - 1][currY], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[currX][currY - 1], 0);\n\n\t\t\t\tif (this.tableVals[currX - 1][currY] > this.tableVals[currX][currY - 1]) {\n\t\t\t\t\tcurrX = currX - 1;\n\t\t\t\t} else {\n\t\t\t\t\tcurrY = currY - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttableLCS(value) {\n\t\tthis.commands = [];\n\t\tthis.clearOldIDs();\n\n\t\tconst sequences = value.split(';');\n\n\t\tthis.buildTable(sequences[0], sequences[1]);\n\n\t\tconst moveID = this.nextIndex++;\n\t\tconst x = sequences[0].length;\n\t\tconst y = sequences[1].length;\n\t\tlet i, j;\n\n\t\tfor (i = 0; i <= x; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[i][0], '0');\n\t\t\tthis.tableVals[i][0] = 0;\n\t\t}\n\t\tfor (i = 0; i <= y; i++) {\n\t\t\tthis.cmd(act.setText, this.tableID[0][i], '0');\n\t\t\tthis.tableVals[0][i] = 0;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tfor (j = 0; j < y; j++) {\n\t\t\tfor (i = 0; i < x; i++) {\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 1);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.S1TableID[i], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.S2TableID[j], 0);\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\tif (sequences[0].charAt(i) === sequences[1].charAt(j)) {\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableVals[i][j] + 1,\n\t\t\t\t\t\tthis.tableXPos[i][j],\n\t\t\t\t\t\tthis.tableYPos[i][j]\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1]\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1 - 1][j + 1 - 1], 0);\n\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j] + 1;\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\n\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 1);\n\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setForegroundColor,\n\t\t\t\t\t\t\tthis.codeID[6][3],\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i][j + 1];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i][j + 1],\n\t\t\t\t\t\t\tthis.tableXPos[i][j + 1],\n\t\t\t\t\t\t\tthis.tableYPos[i][j + 1]\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setForegroundColor,\n\t\t\t\t\t\t\tthis.codeID[6][1],\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t\tthis.tableVals[i + 1][j + 1] = this.tableVals[i + 1][j];\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\t\tthis.tableVals[i + 1][j],\n\t\t\t\t\t\t\tthis.tableXPos[i + 1][j],\n\t\t\t\t\t\t\tthis.tableYPos[i + 1][j]\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveID,\n\t\t\t\t\t\tthis.tableXPos[i + 1][j + 1],\n\t\t\t\t\t\tthis.tableYPos[i + 1][j + 1]\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.tableID[i + 1][j + 1], this.tableVals[i + 1][j + 1]);\n\t\t\t\t\tthis.cmd(act.delete, moveID);\n\t\t\t\t\tif (this.tableVals[i][j + 1] > this.tableVals[i + 1][j]) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setForegroundColor,\n\t\t\t\t\t\t\tthis.codeID[6][1],\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i][j + 1], 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.setForegroundColor,\n\t\t\t\t\t\t\tthis.codeID[6][3],\n\t\t\t\t\t\t\tDPLCS.CODE_STANDARD_COLOR\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setHighlight, this.tableID[i + 1][j + 1], 0);\n\t\t\t\t//this.cmd(act.step);\n\t\t\t}\n\t\t}\n\t\tthis.buildLCSFromTable(sequences[0], sequences[1]);\n\t\treturn this.commands;\n\t}\n\n\tLCSMem(S1, S2, x, y, xPos, ID) {\n\t\tconst ID2 = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tID,\n\t\t\t'LCS(' + S1 + ', ' + S2 + ', ' + String(x) + ', ' + String(y) + ')',\n\t\t\txPos,\n\t\t\tthis.currentY,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tID2,\n\t\t\t'        [LCS(' + S1.substring(0, x + 1) + ',' + S2.substring(0, y + 1) + ')]'\n\t\t);\n\t\tthis.cmd(act.setForegroundColor, ID2, '#3333FF');\n\t\tthis.cmd(act.alignRight, ID2, ID);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[0][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[0][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\tif (this.tableVals[x + 1][y + 1] !== -1) {\n\t\t\tconst movingLabel = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tmovingLabel,\n\t\t\t\tthis.tableVals[x + 1][y + 1],\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\n\t\t\t);\n\t\t\tthis.cmd(act.move, movingLabel, xPos, this.currentY);\n\t\t\tthis.cmd(act.setText, ID, '');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, movingLabel);\n\n\t\t\tthis.cmd(act.setText, ID, this.tableVals[x + 1][y + 1]);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\treturn this.tableVals[x + 1][y + 1];\n\t\t}\n\n\t\tif (x === -1 || y === -1) {\n\t\t\tif (x === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t}\n\t\t\tif (y === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][3], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tif (x === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][1], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t}\n\t\t\tif (y === -1) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.codeID[1][3], DPLCS.CODE_STANDARD_COLOR);\n\t\t\t}\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[2][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setText, ID, 0);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[2][0], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst movingLabel = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, movingLabel, 0, xPos, this.currentY);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tmovingLabel,\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, movingLabel);\n\n\t\t\tthis.tableVals[x + 1][y + 1] = 0;\n\t\t\tthis.cmd(act.setText, this.tableID[x + 1][y + 1], 0);\n\n\t\t\treturn 0;\n\t\t}\n\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setForegroundColor, this.codeID[3][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\tif (S1.charAt(x) === S2.charAt(y)) {\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst nextID = this.nextIndex++;\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tconst subProb = this.LCSMem(\n\t\t\t\tS1,\n\t\t\t\tS2,\n\t\t\t\tx - 1,\n\t\t\t\ty - 1,\n\t\t\t\txPos + DPLCS.RECURSIVE_DELTA_X,\n\t\t\t\tnextID\n\t\t\t);\n\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[4][0], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tthis.cmd(act.delete, nextID);\n\t\t\tthis.cmd(act.setText, ID, subProb + 1);\n\t\t\tthis.cmd(act.delete, ID2);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.currentY -= DPLCS.RECURSIVE_DELTA_Y;\n\n\t\t\t// TODO:  Animate moving value into table here\n\n\t\t\tconst movingLabel = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, movingLabel, subProb + 1, xPos, this.currentY);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tmovingLabel,\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, movingLabel);\n\n\t\t\tthis.tableVals[x + 1][y + 1] = subProb + 1;\n\t\t\tthis.cmd(act.setText, this.tableID[x + 1][y + 1], subProb + 1);\n\n\t\t\treturn subProb + 1;\n\t\t} else {\n\t\t\tconst firstID = this.nextIndex++;\n\t\t\tconst secondID = this.nextIndex++;\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][1], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][1], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst subProb1 = this.LCSMem(S1, S2, x - 1, y, xPos + DPLCS.RECURSIVE_DELTA_X, firstID);\n\t\t\tthis.currentY += DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][3], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][3], DPLCS.CODE_STANDARD_COLOR);\n\n\t\t\tconst subProb2 = this.LCSMem(\n\t\t\t\tS1,\n\t\t\t\tS2,\n\t\t\t\tx,\n\t\t\t\ty - 1,\n\t\t\t\txPos + DPLCS.RECURSIVE_DELTA_X,\n\t\t\t\tsecondID\n\t\t\t);\n\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_HIGHLIGHT_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][0], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][2], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.setForegroundColor, this.codeID[6][4], DPLCS.CODE_STANDARD_COLOR);\n\t\t\tthis.cmd(act.delete, firstID);\n\t\t\tthis.cmd(act.delete, secondID);\n\t\t\tthis.currentY -= 2 * DPLCS.RECURSIVE_DELTA_Y;\n\t\t\tconst best = Math.max(subProb1, subProb2);\n\t\t\tthis.cmd(act.setText, ID, best);\n\t\t\tthis.cmd(act.delete, ID2);\n\n\t\t\tconst movingLabel = this.nextIndex++;\n\t\t\tthis.cmd(act.createLabel, movingLabel, best, xPos, this.currentY);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tmovingLabel,\n\t\t\t\tthis.tableXPos[x + 1][y + 1],\n\t\t\t\tthis.tableYPos[x + 1][y + 1]\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.delete, movingLabel);\n\n\t\t\t// TODO:  Animate moving value into table here\n\t\t\tthis.tableVals[x + 1][y + 1] = best;\n\t\t\tthis.cmd(act.setText, this.tableID[x + 1][y + 1], best);\n\n\t\t\tthis.cmd(act.step);\n\t\t\treturn best;\n\t\t}\n\t}\n\n\tmemoizedLCS(value) {\n\t\tthis.commands = [];\n\n\t\tthis.clearOldIDs();\n\t\tconst sequences = value.split(';');\n\n\t\tthis.buildTable(sequences[0], sequences[1]);\n\n\t\tconst functionCallID = this.nextIndex++;\n\t\tthis.currentY = DPLCS.RECURSIVE_START_Y;\n\n\t\tthis.oldIDs.push(functionCallID);\n\n\t\tconst final = this.LCSMem(\n\t\t\tsequences[0],\n\t\t\tsequences[1],\n\t\t\tsequences[0].length - 1,\n\t\t\tsequences[1].length - 1,\n\t\t\tDPLCS.RECURSIVE_START_X,\n\t\t\tfunctionCallID\n\t\t);\n\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tfunctionCallID,\n\t\t\t'LCS(' +\n\t\t\t\tsequences[0] +\n\t\t\t\t', ' +\n\t\t\t\tsequences[1] +\n\t\t\t\t', ' +\n\t\t\t\tString(sequences[0].length - 1) +\n\t\t\t\t', ' +\n\t\t\t\tString(sequences[1].length - 1) +\n\t\t\t\t') = ' +\n\t\t\t\tString(final)\n\t\t);\n\n\t\tthis.buildLCSFromTable(sequences[0], sequences[1]);\n\n\t\treturn this.commands;\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n}\n\nDPLCS.TABLE_ELEM_WIDTH = 40;\nDPLCS.TABLE_ELEM_HEIGHT = 30;\n\nDPLCS.TABLE_START_X = 500;\nDPLCS.TABLE_START_Y = 80;\n\nDPLCS.TABLE_DIFF_X = 100;\n\nDPLCS.CODE_START_X = 10;\nDPLCS.CODE_START_Y = 10;\nDPLCS.CODE_LINE_HEIGHT = 14;\n\nDPLCS.RECURSIVE_START_X = 20;\nDPLCS.RECURSIVE_START_Y = 120;\nDPLCS.RECURSIVE_DELTA_Y = 14;\nDPLCS.RECURSIVE_DELTA_X = 15;\nDPLCS.CODE_HIGHLIGHT_COLOR = '#FF0000';\nDPLCS.CODE_STANDARD_COLOR = '#000000';\nDPLCS.MAX_SEQUENCE_LENGTH = 15;\n\nDPLCS.TABLE_INDEX_COLOR = '#0000FF';\nDPLCS.CODE_RECURSIVE_1_COLOR = '#339933';\nDPLCS.CODE_RECURSIVE_2_COLOR = '#0099FF';\n\nDPLCS.SEQUENCE_START_X = 30;\nDPLCS.SEQUENCE_START_Y = 180;\nDPLCS.SEQUENCE_DELTA_X = 10;\n\nDPLCS.MAX_VALUE = 20;\n\nDPLCS.MESSAGE_ID = 0;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRRAY_ELEMS_PER_LINE = 15;\nconst ARRAY_LINE_SPACING = 130;\n\nconst FRONT_POS_X = 180;\nconst FRONT_POS_Y = 100;\nconst FRONT_LABEL_X = 130;\nconst FRONT_LABEL_Y = 100;\n\nconst SIZE_POS_X = 280;\nconst SIZE_POS_Y = 100;\nconst SIZE_LABEL_X = 230;\nconst SIZE_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 50;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 120;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst INDEX_COLOR = '#0000FF';\n\nconst SIZE = 15;\n\nexport default class DequeArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4); \n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallBack.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.frontID = this.nextIndex++;\n\t\tconst frontLabelID = this.nextIndex++;\n\t\tthis.sizeID = this.nextIndex++;\n\t\tconst sizeLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, frontLabelID, 'Front', FRONT_LABEL_X, FRONT_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.frontID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tFRONT_POS_X,\n\t\t\tFRONT_POS_Y\n\t\t);\n\n\t\tthis.cmd(act.createLabel, sizeLabelID, 'Size', SIZE_LABEL_X, SIZE_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.sizeID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tSIZE_POS_X,\n\t\t\tSIZE_POS_Y\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y, false);\n\n\t\tthis.initialIndex = this.nextIndex;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.arrayData = [];\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddLastCallback() {\n\t\tif ((this.size + 1) % SIZE !== this.front && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addLast.bind(this), pushVal);\n\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeFirst.bind(this));\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size !== 0) {\n\t\t\tthis.implementAction(this.removeLast.bind(this));\n\t\t}\n\t}\n\n\taddFirstCallBack() {\n\t\tif ((this.front - 1 + SIZE) % SIZE !== this.size && this.addField.value !== '') {\n\t\t\tconst pushVal = this.addField.value;\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.addFirst.bind(this), pushVal);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\taddLast(elemToaddLast) {\n\t\tthis.commands = [];\n\n\t\tconst labaddLastID = this.nextIndex++;\n\t\tconst labaddLastValID = this.nextIndex++;\n\t\tconst addIndex = (this.front + this.size) % SIZE;\n\n\t\tthis.arrayData[addIndex] = elemToaddLast;\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labaddLastID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labaddLastValID, elemToaddLast, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (addIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labaddLastValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToaddLast);\n\t\tthis.cmd(act.delete, labaddLastValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.delete, labaddLastID);\n\n\t\treturn this.commands;\n\t}\n\n\taddFirst(elemToAdd) {\n\t\tthis.commands = [];\n\n\t\tconst labelAddID = this.nextIndex++;\n\n\t\tconst addIndex = (this.front - 1 + SIZE) % SIZE;\n\n\t\tconst xpos = (addIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(addIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.arrayData[addIndex] = elemToAdd;\n\n\t\tthis.cmd(act.createLabel, labelAddID, elemToAdd, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.cmd(act.setPosition, this.leftoverLabelID, QUEUE_LABEL_X + 100, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.leftoverLabelID,\n\t\t\t`Adding ${elemToAdd} at index (${this.front} - 1) % ${SIZE}`\n\t\t);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.highlight1ID,\n\t\t\tthis.front * ARRAY_ELEM_WIDTH + ARRAY_START_X,\n\t\t\typos + ARRAY_ELEM_HEIGHT\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.move, labelAddID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[addIndex], elemToAdd);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.frontID, addIndex);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size + 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, labelAddID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\tthis.front = addIndex;\n\t\tthis.size++;\n\t\treturn this.commands;\n\t}\n\n\tremoveFirst() {\n\t\tthis.commands = [];\n\n\t\tconst labremoveFirstID = this.nextIndex++;\n\t\tconst labremoveFirstValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabremoveFirstID,\n\t\t\t'removeFirstd Value: ',\n\t\t\tQUEUE_LABEL_X,\n\t\t\tQUEUE_LABEL_Y\n\t\t);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.front % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.front / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst removeFirstdVal = this.arrayData[this.front];\n\t\tthis.cmd(act.createLabel, labremoveFirstValID, removeFirstdVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.front], '');\n\t\tthis.cmd(act.move, labremoveFirstValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.front = (this.front + 1) % SIZE;\n\t\tthis.cmd(act.setText, this.frontID, this.front);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'removeFirstd Value: ' + removeFirstdVal);\n\n\t\tthis.cmd(act.delete, labremoveFirstID);\n\t\tthis.cmd(act.delete, labremoveFirstValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.size--;\n\t\tthis.cmd(act.setText, this.sizeID, this.size);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.adjustIfEmpty();\n\n\t\treturn this.commands;\n\t}\n\n\tremoveLast() {\n\t\tthis.commands = [];\n\t\tconst remLabelID = this.nextIndex++;\n\t\tconst remLabelValID = this.nextIndex++;\n\n\t\tconst remIndex = (this.front + this.size - 1 + SIZE) % SIZE;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, remLabelID, 'Removed Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, FRONT_POS_X, FRONT_POS_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight2ID, INDEX_COLOR, SIZE_POS_X, SIZE_POS_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (remIndex % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(remIndex / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight2ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.delete, this.highlight2ID);\n\n\t\tconst removedVal = this.arrayData[remIndex];\n\t\tthis.cmd(act.createLabel, remLabelValID, removedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[remIndex], '');\n\t\tthis.cmd(act.move, remLabelValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Removed Value: ' + removedVal);\n\n\t\tthis.cmd(act.delete, remLabelID);\n\t\tthis.cmd(act.delete, remLabelValID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.sizeID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.sizeID, this.size - 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.sizeID, 0);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.size--;\n\n\t\tthis.adjustIfEmpty();\n\n\t\treturn this.commands;\n\t}\n\n\tadjustIfEmpty() {\n\t\tif (this.size === 0) {\n\t\t\tthis.cmd(act.setText, this.leftoverLabelID, 'size = 0, set front to 0');\n\t\t\tthis.front = 0;\n\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.frontID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, this.frontID, 0);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.frontID, 0);\n\t\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.front = 0;\n\t\tthis.size = 0;\n\t\tthis.cmd(act.setText, this.frontID, '0');\n\t\tthis.cmd(act.setText, this.sizeID, '0');\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class DequeLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\t// Add's value text field\n\t\tthis.addField = addControlToAlgorithmBar('Text', '');\n\t\tthis.addField.onkeydown = this.returnSubmit(this.addField, null, 4); \n\t\tthis.controls.push(this.addField);\n\n\t\t// Add first button\n\t\tthis.addFirstButton = addControlToAlgorithmBar('Button', 'Add First');\n\t\tthis.addFirstButton.onclick = this.addFirstCallback.bind(this);\n\t\tthis.controls.push(this.addFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Add last button\n\t\tthis.addLastButton = addControlToAlgorithmBar('Button', 'Add Last');\n\t\tthis.addLastButton.onclick = this.addLastCallback.bind(this);\n\t\tthis.controls.push(this.addLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove first button\n\t\tthis.removeFirstButton = addControlToAlgorithmBar('Button', 'Remove First');\n\t\tthis.removeFirstButton.onclick = this.removeFirstCallback.bind(this);\n\t\tthis.controls.push(this.removeFirstButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Remove last button\n\t\tthis.removeLastButton = addControlToAlgorithmBar('Button', 'Remove Last');\n\t\tthis.removeLastButton.onclick = this.removeLastCallback.bind(this);\n\t\tthis.controls.push(this.removeLastButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddFirstCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddLastCallback() {\n\t\tif (this.addField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addField.value);\n\t\t\tthis.addField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveFirstCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveLastCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { VERTEX_INDEX_COLOR } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst TABLE_ENTRY_WIDTH = 50;\nconst TABLE_ENTRY_HEIGHT = 25;\nconst TABLE_START_X = 50;\nconst TABLE_START_Y = 80;\n\nconst MESSAGE_LABEL_1_X = 20;\nconst MESSAGE_LABEL_1_Y = 10;\n\nexport default class DijkstraPrim extends Graph {\n\tconstructor(am, runningDijkstra, w, h) {\n\t\tsuper(am, w, h, false, false);\n\t\tthis.runningDijkstra = runningDijkstra;\n\t\tthis.showEdgeCosts = true;\n\t}\n\n\taddControls() {\n\t\taddLabelToAlgorithmBar('Start Vertex: ');\n\t\tthis.startField = addControlToAlgorithmBar('Text', '');\n\t\tthis.startField.onkeydown = this.returnSubmit(\n\t\t\tthis.startField,\n\t\t\tthis.startCallback.bind(this),\n\t\t\t1,\n\t\t\tfalse\n\t\t);\n\t\tthis.startField.size = 2;\n\t\tif (this.runningDijkstra) {\n\t\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Dijkstra');\n\t\t} else {\n\t\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Prim');\n\t\t}\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(this.runningDijkstra);\n\t}\n\n\tsetup() {\n\t\tthis.message1ID = this.nextIndex++;\n\t\tsuper.setup();\n\n\t\tthis.commands = [];\n\t\tthis.cmd(act.createLabel, this.message1ID, '', MESSAGE_LABEL_1_X, MESSAGE_LABEL_1_Y, 0);\n\n\t\tthis.vertexID = new Array(this.size);\n\t\tthis.knownID = new Array(this.size);\n\t\tthis.distanceID = new Array(this.size);\n\t\tthis.pathID = new Array(this.size);\n\t\tthis.known = new Array(this.size);\n\t\tthis.distance = new Array(this.size);\n\t\tthis.path = new Array(this.size);\n\n\t\tthis.messageID = null;\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.vertexID[i] = this.nextIndex++;\n\t\t\tthis.knownID[i] = this.nextIndex++;\n\t\t\tthis.distanceID[i] = this.nextIndex++;\n\t\t\tthis.pathID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.vertexID[i],\n\t\t\t\tString.fromCharCode(65 + i),\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_ENTRY_HEIGHT,\n\t\t\t\tTABLE_START_X,\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.knownID[i],\n\t\t\t\t'',\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_ENTRY_HEIGHT,\n\t\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.distanceID[i],\n\t\t\t\t'',\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_ENTRY_HEIGHT,\n\t\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.pathID[i],\n\t\t\t\t'',\n\t\t\t\tTABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_ENTRY_HEIGHT,\n\t\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\n\t\t\t\tTABLE_START_Y + i * TABLE_ENTRY_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.vertexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Vertex',\n\t\t\tTABLE_START_X,\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Visited',\n\t\t\tTABLE_START_X + TABLE_ENTRY_WIDTH,\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Cost',\n\t\t\tTABLE_START_X + 2 * TABLE_ENTRY_WIDTH,\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Path',\n\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\n\t\t\tTABLE_START_Y - TABLE_ENTRY_HEIGHT\n\t\t);\n\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.comparisonMessageID = this.nextIndex++;\n\t}\n\n\tfindCheapestUnknown() {\n\t\tlet bestIndex = -1;\n\t\tthis.cmd(act.setText, this.message1ID, 'Finding Cheapest Uknown Vertex');\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tif (!this.known[i]) {\n\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[i], 1);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!this.known[i] &&\n\t\t\t\tthis.distance[i] !== -1 &&\n\t\t\t\t(bestIndex === -1 || this.distance[i] < this.distance[bestIndex])\n\t\t\t) {\n\t\t\t\tbestIndex = i;\n\t\t\t}\n\t\t}\n\t\t// if (bestIndex == -1) {\n\t\t// \tlet x = 3;\n\t\t// \tx = x + 2;\n\t\t// }\n\t\tthis.cmd(act.step);\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tif (!this.known[i]) {\n\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[i], 0);\n\t\t\t}\n\t\t}\n\t\treturn bestIndex;\n\t}\n\n\tdoDijkstraPrim(startVertex) {\n\t\tthis.commands = [];\n\n\t\tif (!this.runningDijkstra) {\n\t\t\tthis.recolorGraph();\n\t\t}\n\n\t\tlet current = startVertex;\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.known[i] = false;\n\t\t\tthis.distance[i] = -1;\n\t\t\tthis.path[i] = -1;\n\t\t\tthis.cmd(act.setText, this.knownID[i], 'F');\n\t\t\tthis.cmd(act.setText, this.distanceID[i], 'INF');\n\t\t\tthis.cmd(act.setText, this.pathID[i], '-1');\n\t\t\tthis.cmd(act.setTextColor, this.knownID[i], '#000000');\n\t\t}\n\t\tif (this.messageID != null) {\n\t\t\tfor (let i = 0; i < this.messageID.length; i++) {\n\t\t\t\tthis.cmd(act.delete, this.messageID[i]);\n\t\t\t}\n\t\t}\n\t\tthis.messageID = [];\n\n\t\tthis.distance[current] = 0;\n\t\tthis.cmd(act.setText, this.distanceID[current], 0);\n\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tcurrent = this.findCheapestUnknown();\n\t\t\tif (current < 0) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.message1ID,\n\t\t\t\t'Cheapest Unknown Vertex: ' + String.fromCharCode(65 + current)\n\t\t\t); // Gotta love Auto Conversion\n\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 1);\n\n\t\t\tthis.cmd(act.setHighlight, this.circleID[current], 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\tthis.cmd(act.setText, this.message1ID, 'Setting known field to True');\n\t\t\tthis.cmd(act.setHighlight, this.knownID[current], 1);\n\t\t\tthis.known[current] = true;\n\t\t\tthis.cmd(act.setText, this.knownID[current], 'T');\n\t\t\tthis.cmd(act.setTextColor, this.knownID[current], '#AAAAAA');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, this.knownID[current], 0);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.message1ID,\n\t\t\t\t'Updating neighbors of vertex ' + String.fromCharCode(65 + current)\n\t\t\t); // Gotta love Auto Conversion\n\t\t\tfor (let neighbor = 0; neighbor < this.size; neighbor++) {\n\t\t\t\tif (this.adj_matrix[current][neighbor] >= 0) {\n\t\t\t\t\tthis.highlightEdge(current, neighbor, 1);\n\t\t\t\t\tif (this.known[neighbor]) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t'Vertex ' + String.fromCharCode(65 + neighbor) + ' known',\n\t\t\t\t\t\t\tTABLE_START_X + 5 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.knownID[neighbor], 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 1);\n\t\t\t\t\t\tlet distString = String(this.distance[neighbor]);\n\t\t\t\t\t\tif (this.distance[neighbor] < 0) {\n\t\t\t\t\t\t\tdistString = 'INF';\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this.runningDijkstra) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.distance[neighbor] < 0 ||\n\t\t\t\t\t\t\t\tthis.distance[neighbor] >\n\t\t\t\t\t\t\t\t\tthis.distance[current] + this.adj_matrix[current][neighbor]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\tdistString +\n\t\t\t\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\t\t\t\tString(this.distance[current]) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]),\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\t\tString(this.distance[neighbor]) +\n\t\t\t\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\t\t\t\tString(this.distance[current]) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]) +\n\t\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.distance[neighbor] < 0 ||\n\t\t\t\t\t\t\t\tthis.distance[neighbor] > this.adj_matrix[current][neighbor]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\tdistString + ' > ' + String(this.adj_matrix[current][neighbor]),\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tthis.comparisonMessageID,\n\t\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\t\tString(this.distance[neighbor]) +\n\t\t\t\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\t\t\t\tString(this.adj_matrix[current][neighbor]) +\n\t\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\t\t\tTABLE_START_Y + neighbor * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, this.comparisonMessageID);\n\t\t\t\t\tthis.highlightEdge(current, neighbor, 0);\n\t\t\t\t\tif (this.known[neighbor]) {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.knownID[neighbor], 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[current], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.distanceID[neighbor], 0);\n\t\t\t\t\t\tlet compare;\n\t\t\t\t\t\tif (this.runningDijkstra) {\n\t\t\t\t\t\t\tcompare = this.distance[current] + this.adj_matrix[current][neighbor];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcompare = this.adj_matrix[current][neighbor];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this.distance[neighbor] < 0 || this.distance[neighbor] > compare) {\n\t\t\t\t\t\t\tthis.distance[neighbor] = compare;\n\t\t\t\t\t\t\tthis.path[neighbor] = current;\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.distanceID[neighbor], this.distance[neighbor]);\n\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathID[neighbor], this.path[neighbor]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.setHighlight, this.circleID[current], 0);\n\t\t}\n\t\t// Running Dijkstra's algorithm, create the paths\n\t\tif (this.runningDijkstra) {\n\t\t\tthis.cmd(act.setText, this.message1ID, 'Finding Paths in Table');\n\t\t\tthis.createPaths();\n\t\t}\n\t\t// Running Prim's algorithm, highlight the tree\n\t\telse {\n\t\t\tthis.cmd(act.setText, this.message1ID, 'Creating tree from table');\n\t\t\tthis.highlightTree();\n\t\t}\n\n\t\tthis.cmd(act.setText, this.message1ID, '');\n\t\treturn this.commands;\n\t}\n\n\tcreatePaths() {\n\t\tfor (let vertex = 0; vertex < this.size; vertex++) {\n\t\t\tlet nextLabelID = this.nextIndex++;\n\t\t\tif (this.distance[vertex] < 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\t'No Path',\n\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\n\t\t\t\t);\n\t\t\t\tthis.messageID.push(nextLabelID);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tnextLabelID,\n\t\t\t\t\tString.fromCharCode(65 + vertex),\n\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\n\t\t\t\t);\n\t\t\t\tthis.messageID.push(nextLabelID);\n\t\t\t\tconst pathList = [nextLabelID];\n\t\t\t\tlet nextInPath = vertex;\n\t\t\t\twhile (nextInPath >= 0) {\n\t\t\t\t\tthis.cmd(act.setHighlight, this.pathID[nextInPath], 1);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tif (this.path[nextInPath] !== -1) {\n\t\t\t\t\t\tnextLabelID = this.nextIndex++;\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\tnextLabelID,\n\t\t\t\t\t\t\tString.fromCharCode(65 + this.path[nextInPath]),\n\t\t\t\t\t\t\tTABLE_START_X + 3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\tTABLE_START_Y + nextInPath * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tnextLabelID,\n\t\t\t\t\t\t\tTABLE_START_X + 4.3 * TABLE_ENTRY_WIDTH,\n\t\t\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.messageID.push(nextLabelID);\n\t\t\t\t\t\tfor (let i = pathList.length - 1; i >= 0; i--) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\tpathList[i],\n\t\t\t\t\t\t\t\tTABLE_START_X +\n\t\t\t\t\t\t\t\t\t4.3 * TABLE_ENTRY_WIDTH +\n\t\t\t\t\t\t\t\t\t(pathList.length - i) * 17,\n\t\t\t\t\t\t\t\tTABLE_START_Y + vertex * TABLE_ENTRY_HEIGHT\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tpathList.push(nextLabelID);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.setHighlight, this.pathID[nextInPath], 0);\n\t\t\t\t\tnextInPath = this.path[nextInPath];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thighlightTree() {\n\t\tfor (let vertex = 0; vertex < this.size; vertex++) {\n\t\t\tif (this.path[vertex] >= 0) {\n\t\t\t\tthis.cmd(act.setHighlight, this.vertexID[vertex], 1);\n\t\t\t\tthis.cmd(act.setHighlight, this.pathID[vertex], 1);\n\t\t\t\tthis.highlightEdge(vertex, this.path[vertex], 1);\n\t\t\t\tthis.highlightEdge(this.path[vertex], vertex, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, this.vertexID[vertex], 0);\n\t\t\t\tthis.cmd(act.setHighlight, this.pathID[vertex], 0);\n\t\t\t\tthis.highlightEdge(vertex, this.path[vertex], 0);\n\t\t\t\tthis.highlightEdge(this.path[vertex], vertex, 0);\n\t\t\t\tthis.setEdgeColor(vertex, this.path[vertex], '#FF0000');\n\t\t\t\tthis.setEdgeColor(this.path[vertex], vertex, '#FF0000');\n\t\t\t}\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.messageID = [];\n\t}\n\n\tstartCallback() {\n\t\tlet startvalue;\n\n\t\tif (this.startField.value !== '') {\n\t\t\tstartvalue = this.startField.value;\n\t\t\tthis.startField.value = '';\n\t\t\tstartvalue = startvalue.toUpperCase().charCodeAt(0) - 65;\n\t\t\tif (startvalue >= 0 && startvalue < this.size)\n\t\t\t\tthis.implementAction(this.doDijkstraPrim.bind(this), startvalue);\n\t\t}\n\t}\n\n\tenableUI(event) {\n\t\tthis.startField.disabled = false;\n\t\tthis.startButton.disabled = false;\n\n\t\tsuper.enableUI(event);\n\t}\n\n\tdisableUI(event) {\n\t\tthis.startField.disabled = true;\n\t\tthis.startButton.disabled = true;\n\n\t\tsuper.disableUI(event);\n\t}\n}\n\nexport class Dijkstra extends DijkstraPrim {\n\tconstructor(am, w, h) {\n\t\tsuper(am, true, w, h);\n\t}\n}\n\nexport class Prim extends DijkstraPrim {\n\tconstructor(am, w, h) {\n\t\tsuper(am, false, w, h);\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 100;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 150;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class DoublyLinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front', addBottomHorizontalGroup);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back', addBottomHorizontalGroup);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index', addBottomHorizontalGroup);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index', removeTopHorizontalGroup);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front', removeBottomHorizontalGroup);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back', removeBottomHorizontalGroup);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// DoublyLinkedList.prototype.getCallback = function(event)\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createDoublyLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === 0) {\n\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setPrevNull, this.linkedListElemID[index + 1], 1);\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNextNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectNext,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connectPrev,\n\t\t\t\t\tthis.linkedListElemID[index + 1],\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { LARGE_SIZE, SMALL_SIZE } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class Floyd extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, true, false);\n\t\tthis.showEdgeCosts = true;\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Floyd-Warshall');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls();\n\t\tthis.smallGraphButton.onclick = this.smallGraphCallback.bind(this);\n\t\tthis.largeGraphButton.onclick = this.largeGraphCallback.bind(this);\n\t}\n\n\treset() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsmallGraphCallback() {\n\t\tif (this.size !== SMALL_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\t\tthis.logicalButton.disabled = false;\n\t\t\tthis.adjacencyListButton.disabled = false;\n\t\t\tthis.adjacencyMatrixButton.disabled = false;\n\t\t\tthis.setup_small();\n\t\t}\n\t}\n\n\tlargeGraphCallback() {\n\t\tif (this.size !== LARGE_SIZE) {\n\t\t\tthis.animationManager.resetAll();\n\t\t\t//this.animationManager.setAllLayers([0]);\n\t\t\tthis.logicalButton.disabled = true;\n\t\t\tthis.adjacencyListButton.disabled = true;\n\t\t\tthis.adjacencyMatrixButton.disabled = true;\n\t\t\tthis.setup_large();\n\t\t}\n\t}\n\n\tgetCostLabel(value, alwaysUseINF) {\n\t\talwaysUseINF = alwaysUseINF === undefined ? false : alwaysUseINF;\n\t\tif (value >= 0) {\n\t\t\treturn String(value);\n\t\t} else if (this.size === SMALL_SIZE || alwaysUseINF) {\n\t\t\treturn 'INF';\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tsetup_small() {\n\t\tthis.cost_table_width = Floyd.SMALL_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = Floyd.SMALL_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = Floyd.SMALL_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = Floyd.SMALL_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = Floyd.SMALL_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = Floyd.SMALL_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = Floyd.SMALL_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = Floyd.SMALL_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = Floyd.SMALL_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = Floyd.SMALL_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = Floyd.SMALL_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = Floyd.SMALL_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = Floyd.SMALL_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = Floyd.SMALL_NODE_3_Y_POS;\n\n\t\tthis.message_x = Floyd.SMALL_MESSAGE_X;\n\t\tthis.message_y = Floyd.SMALL_MESSAGE_Y;\n\t\tsuper.setup_small();\n\t}\n\n\tsetup_large() {\n\t\tthis.cost_table_width = Floyd.LARGE_COST_TABLE_WIDTH;\n\t\tthis.cost_table_height = Floyd.LARGE_COST_TABLE_HEIGHT;\n\t\tthis.cost_table_start_x = Floyd.LARGE_COST_TABLE_START_X;\n\t\tthis.cost_table_start_y = Floyd.LARGE_COST_TABLE_START_Y;\n\n\t\tthis.path_table_width = Floyd.LARGE_PATH_TABLE_WIDTH;\n\t\tthis.path_table_height = Floyd.LARGE_PATH_TABLE_HEIGHT;\n\t\tthis.path_table_start_x = Floyd.LARGE_PATH_TABLE_START_X;\n\t\tthis.path_table_start_y = Floyd.LARGE_PATH_TABLE_START_Y;\n\n\t\tthis.node_1_x_pos = Floyd.LARGE_NODE_1_X_POS;\n\t\tthis.node_1_y_pos = Floyd.LARGE_NODE_1_Y_POS;\n\t\tthis.node_2_x_pos = Floyd.LARGE_NODE_2_X_POS;\n\t\tthis.node_2_y_pos = Floyd.LARGE_NODE_2_Y_POS;\n\t\tthis.node_3_x_pos = Floyd.LARGE_NODE_3_X_POS;\n\t\tthis.node_3_y_pos = Floyd.LARGE_NODE_3_Y_POS;\n\n\t\tthis.message_x = Floyd.LARGE_MESSAGE_X;\n\t\tthis.message_y = Floyd.LARGE_MESSAGE_Y;\n\n\t\tsuper.setup_large();\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.commands = [];\n\n\t\tthis.costTable = new Array(this.size);\n\t\tthis.pathTable = new Array(this.size);\n\t\tthis.costTableID = new Array(this.size);\n\t\tthis.pathTableID = new Array(this.size);\n\t\tthis.pathIndexXID = new Array(this.size);\n\t\tthis.pathIndexYID = new Array(this.size);\n\t\tthis.costIndexXID = new Array(this.size);\n\t\tthis.costIndexYID = new Array(this.size);\n\n\t\tthis.node1ID = this.nextIndex++;\n\t\tthis.node2ID = this.nextIndex++;\n\t\tthis.node3ID = this.nextIndex++;\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.costTable[i] = new Array(this.size);\n\t\t\tthis.pathTable[i] = new Array(this.size);\n\t\t\tthis.costTableID[i] = new Array(this.size);\n\t\t\tthis.pathTableID[i] = new Array(this.size);\n\t\t}\n\n\t\tconst costTableHeader = this.nextIndex++;\n\t\tconst pathTableHeader = this.nextIndex++;\n\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tcostTableHeader,\n\t\t\t'Cost Table',\n\t\t\tthis.cost_table_start_x,\n\t\t\tthis.cost_table_start_y - 2 * this.cost_table_height,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tpathTableHeader,\n\t\t\t'Path Table',\n\t\t\tthis.path_table_start_x,\n\t\t\tthis.path_table_start_y - 2 * this.path_table_height,\n\t\t\t0\n\t\t);\n\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.pathIndexXID[i] = this.nextIndex++;\n\t\t\tthis.pathIndexYID[i] = this.nextIndex++;\n\t\t\tthis.costIndexXID[i] = this.nextIndex++;\n\t\t\tthis.costIndexYID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x + i * this.path_table_width,\n\t\t\t\tthis.path_table_start_y - this.path_table_height\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.pathIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.path_table_start_x - this.path_table_width,\n\t\t\t\tthis.path_table_start_y + i * this.path_table_height\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.pathIndexYID[i], '#0000FF');\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexXID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x + i * this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y - this.cost_table_height\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexXID[i], '#0000FF');\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.costIndexYID[i],\n\t\t\t\ti,\n\t\t\t\tthis.cost_table_start_x - this.cost_table_width,\n\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\n\t\t\t);\n\t\t\tthis.cmd(act.setTextColor, this.costIndexYID[i], '#0000FF');\n\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\tthis.costTable[i][j] = this.adj_matrix[i][j];\n\t\t\t\tif (this.costTable[i][j] >= 0) {\n\t\t\t\t\tthis.pathTable[i][j] = i;\n\t\t\t\t} else {\n\t\t\t\t\tthis.pathTable[i][j] = -1;\n\t\t\t\t}\n\t\t\t\tthis.costTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.pathTableID[i][j] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.costTableID[i][j],\n\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true),\n\t\t\t\t\tthis.cost_table_width,\n\t\t\t\t\tthis.cost_table_height,\n\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.pathTableID[i][j],\n\t\t\t\t\tthis.pathTable[i][j],\n\t\t\t\t\tthis.path_table_width,\n\t\t\t\t\tthis.path_table_height,\n\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tif (this.size === LARGE_SIZE) {\n\t\t\tthis.animationManager.setAllLayers([0]);\n\t\t}\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doFloydWarshall.bind(this));\n\t}\n\n\tdoFloydWarshall() {\n\t\tthis.commands = [];\n\n\t\tconst oldIndex = this.nextIndex;\n\t\tconst messageID = this.nextIndex++;\n\t\tconst moveLabel1ID = this.nextIndex++;\n\t\tconst moveLabel2ID = this.nextIndex++;\n\n\t\tthis.cmd(act.createCircle, this.node1ID, '', this.node_1_x_pos, this.node_1_y_pos);\n\t\tthis.cmd(act.createCircle, this.node2ID, '', this.node_2_x_pos, this.node_2_y_pos);\n\t\tthis.cmd(act.createCircle, this.node3ID, '', this.node_3_x_pos, this.node_3_y_pos);\n\t\tthis.cmd(act.createLabel, messageID, '', this.message_x, this.message_y, 0);\n\n\t\tfor (let k = 0; k < this.size; k++) {\n\t\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\t\tfor (let j = 0; j < this.size; j++) {\n\t\t\t\t\tif (i !== j && j !== k && i !== k) {\n\t\t\t\t\t\tthis.cmd(act.setText, this.node1ID, i);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node2ID, k);\n\t\t\t\t\t\tthis.cmd(act.setText, this.node3ID, j);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\t'#009999',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node2ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#9900CC',\n\t\t\t\t\t\t\t-0.1,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\t\tthis.node1ID,\n\t\t\t\t\t\t\tthis.node3ID,\n\t\t\t\t\t\t\t'#CC0000',\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t1,\n\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 1);\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#009999');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#9900CC');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#CC0000');\n\t\t\t\t\t\tif (this.costTable[i][k] >= 0 && this.costTable[k][j] >= 0) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tthis.costTable[i][j] < 0 ||\n\t\t\t\t\t\t\t\tthis.costTable[i][k] + this.costTable[k][j] < this.costTable[i][j]\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.costTable[i][j] = this.costTable[i][k] + this.costTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], '');\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.pathTable[k][j],\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + k * this.path_table_height\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel1ID,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_x + j * this.path_table_width,\n\t\t\t\t\t\t\t\t\tthis.path_table_start_y + i * this.path_table_height\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.costTable[i][j],\n\t\t\t\t\t\t\t\t\tthis.message_x,\n\t\t\t\t\t\t\t\t\tthis.message_y\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.setHighlight, moveLabel2ID, 1);\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\t\tmoveLabel2ID,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_x + j * this.cost_table_width,\n\t\t\t\t\t\t\t\t\tthis.cost_table_start_y + i * this.cost_table_height\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.pathTable[i][j] = this.pathTable[k][j];\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.costTableID[i][j], this.costTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.setText, this.pathTableID[i][j], this.pathTable[i][j]);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel1ID);\n\t\t\t\t\t\t\t\tthis.cmd(act.delete, moveLabel2ID);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t\t')'\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t\t\tmessageID,\n\t\t\t\t\t\t\t\t'!(' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][k], true) +\n\t\t\t\t\t\t\t\t\t' + ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[k][j], true) +\n\t\t\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\t\t\tthis.getCostLabel(this.costTable[i][j], true) +\n\t\t\t\t\t\t\t\t\t')'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][k], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[k][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.setTextColor, this.costTableID[i][j], '#000000');\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node2ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node2ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.node1ID, this.node3ID);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][k], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[k][j], 0);\n\t\t\t\t\t\tthis.cmd(act.setHighlight, this.costTableID[i][j], 0);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.delete, this.node1ID);\n\t\tthis.cmd(act.delete, this.node2ID);\n\t\tthis.cmd(act.delete, this.node3ID);\n\t\tthis.cmd(act.delete, messageID);\n\t\tthis.nextIndex = oldIndex;\n\n\t\treturn this.commands;\n\t}\n\n\tenableUI(event) {\n\t\tthis.startButton.disabled = false;\n\t\tsuper.enableUI(event);\n\t}\n\n\tdisableUI(event) {\n\t\tthis.startButton.disabled = true;\n\t\tsuper.disableUI(event);\n\t}\n}\n\nFloyd.SMALL_COST_TABLE_WIDTH = 30;\nFloyd.SMALL_COST_TABLE_HEIGHT = 30;\nFloyd.SMALL_COST_TABLE_START_X = 40;\nFloyd.SMALL_COST_TABLE_START_Y = 70;\n\nFloyd.SMALL_PATH_TABLE_WIDTH = 30;\nFloyd.SMALL_PATH_TABLE_HEIGHT = 30;\nFloyd.SMALL_PATH_TABLE_START_X = 330;\nFloyd.SMALL_PATH_TABLE_START_Y = 70;\n\nFloyd.SMALL_NODE_1_X_POS = 50;\nFloyd.SMALL_NODE_1_Y_POS = 400;\nFloyd.SMALL_NODE_2_X_POS = 150;\nFloyd.SMALL_NODE_2_Y_POS = 350;\nFloyd.SMALL_NODE_3_X_POS = 250;\nFloyd.SMALL_NODE_3_Y_POS = 400;\n\nFloyd.SMALL_MESSAGE_X = 400;\nFloyd.SMALL_MESSAGE_Y = 350;\n\nFloyd.LARGE_COST_TABLE_WIDTH = 20;\nFloyd.LARGE_COST_TABLE_HEIGHT = 20;\nFloyd.LARGE_COST_TABLE_START_X = 40;\nFloyd.LARGE_COST_TABLE_START_Y = 50;\n\nFloyd.LARGE_PATH_TABLE_WIDTH = 20;\nFloyd.LARGE_PATH_TABLE_HEIGHT = 20;\nFloyd.LARGE_PATH_TABLE_START_X = 500;\nFloyd.LARGE_PATH_TABLE_START_Y = 50;\n\nFloyd.LARGE_NODE_1_X_POS = 50;\nFloyd.LARGE_NODE_1_Y_POS = 500;\nFloyd.LARGE_NODE_2_X_POS = 150;\nFloyd.LARGE_NODE_2_Y_POS = 450;\nFloyd.LARGE_NODE_3_X_POS = 250;\nFloyd.LARGE_NODE_3_Y_POS = 500;\n\nFloyd.LARGE_MESSAGE_X = 300;\nFloyd.LARGE_MESSAGE_Y = 450;\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n\taddRadioButtonGroupToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_SIZE = 32;\nconst ARRAY_ELEM_WIDTH = 30;\nconst ARRAY_ELEM_HEIGHT = 25;\nconst ARRAY_INITIAL_X = 30;\n\nconst ARRAY_Y_POS = 50;\nconst ARRAY_LABEL_Y_POS = 75;\n\nconst HEAP_X_POSITIONS = [\n\t0,\n\t450,\n\t250,\n\t650,\n\t150,\n\t350,\n\t550,\n\t750,\n\t100,\n\t200,\n\t300,\n\t400,\n\t500,\n\t600,\n\t700,\n\t800,\n\t75,\n\t125,\n\t175,\n\t225,\n\t275,\n\t325,\n\t375,\n\t425,\n\t475,\n\t525,\n\t575,\n\t625,\n\t675,\n\t725,\n\t775,\n\t825,\n];\n\nconst HEAP_Y_POSITIONS = [\n\t0,\n\t110,\n\t180,\n\t180,\n\t250,\n\t250,\n\t250,\n\t250,\n\t320,\n\t320,\n\t320,\n\t320,\n\t320,\n\t320,\n\t320,\n\t320,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n\t390,\n];\n\nexport default class Heap extends Algorithm {\n\tconstructor(am) {\n\t\tsuper(am);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.createArray();\n\t}\n\n\taddControls() {\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\n\t\taddLabelToAlgorithmBar(\n\t\t\t'Comma separated list (e.g. \"3,1,2\", max 31 elements)',\n\t\t\tverticalGroup\n\t\t);\n\n\t\tconst horizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\tthis.buildHeapField = addControlToAlgorithmBar('Text', '', horizontalGroup);\n\t\tthis.buildHeapField.onkeydown = this.returnSubmit(\n\t\t\tthis.buildHeapField,\n\t\t\tthis.buildHeapCallback.bind(this),\n\t\t\t61,\n\t\t\tfalse\n\t\t);\n\n\t\tthis.buildHeapButton = addControlToAlgorithmBar('Button', 'BuildHeap', horizontalGroup);\n\t\tthis.buildHeapButton.onclick = this.buildHeapCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst minMaxButtonList = addRadioButtonGroupToAlgorithmBar(\n\t\t\t['MinHeap', 'MaxHeap'],\n\t\t\t'MinHeap/MaxHeap'\n\t\t);\n\n\t\tthis.minHeapButton = minMaxButtonList[0];\n\t\tthis.minHeapButton.onclick = this.minHeapCallback.bind(this);\n\t\tthis.minHeapButton.checked = true;\n\t\tthis.maxHeapButton = minMaxButtonList[1];\n\t\tthis.maxHeapButton.onclick = this.maxHeapCallback.bind(this);\n\t\tthis.isMinHeap = true;\n\t}\n\n\tcreateArray() {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData = new Array(ARRAY_SIZE);\n\t\tthis.arrayLabels = new Array(ARRAY_SIZE);\n\t\tthis.arrayRects = new Array(ARRAY_SIZE);\n\t\tthis.circleObjs = new Array(ARRAY_SIZE);\n\t\tthis.arrayXPositions = new Array(ARRAY_SIZE);\n\t\tthis.currentHeapSize = 0;\n\n\t\tfor (let i = 0; i < ARRAY_SIZE; i++) {\n\t\t\tthis.arrayXPositions[i] = ARRAY_INITIAL_X + i * ARRAY_ELEM_WIDTH;\n\t\t\tthis.arrayLabels[i] = this.nextIndex++;\n\t\t\tthis.arrayRects[i] = this.nextIndex++;\n\t\t\tthis.circleObjs[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayRects[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_Y_POS\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.arrayLabels[i],\n\t\t\t\ti,\n\t\t\t\tthis.arrayXPositions[i],\n\t\t\t\tARRAY_LABEL_Y_POS\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabels[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.setText, this.arrayRects[0], 'null');\n\t\tthis.swapLabel1 = this.nextIndex++;\n\t\tthis.swapLabel2 = this.nextIndex++;\n\t\tthis.swapLabel3 = this.nextIndex++;\n\t\tthis.swapLabel4 = this.nextIndex++;\n\t\tthis.descriptLabel1 = this.nextIndex++;\n\t\tthis.descriptLabel2 = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, this.descriptLabel1, '', 20, 10, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tinsertCallback() {\n\t\tconst insertedValue = this.normalizeNumber(this.insertField.value, 4);\n\t\tif (insertedValue !== '') {\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tthis.implementAction(this.remove.bind(this));\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tbuildHeapCallback() {\n\t\tif (this.buildHeapField.value !== '') {\n\t\t\tconst list = this.buildHeapField.value;\n\t\t\tthis.buildHeapField.value = '';\n\t\t\tthis.implementAction(this.buildHeap.bind(this), list);\n\t\t}\n\t}\n\n\tminHeapCallback() {\n\t\tif (!this.isMinHeap) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.isMinHeap = true;\n\t\t}\n\t}\n\n\tmaxHeapCallback() {\n\t\tif (this.isMinHeap) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tthis.isMinHeap = false;\n\t\t}\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\twhile (this.currentHeapSize > 0) {\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\treset() {\n\t\tthis.currentHeapSize = 0;\n\t}\n\n\tswap(index1, index2) {\n\t\tthis.cmd(act.setText, this.arrayRects[index1], '');\n\t\tthis.cmd(act.setText, this.arrayRects[index2], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index1], '');\n\t\tthis.cmd(act.setText, this.circleObjs[index2], '');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel1,\n\t\t\tthis.arrayData[index1],\n\t\t\tthis.arrayXPositions[index1],\n\t\t\tARRAY_Y_POS\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel2,\n\t\t\tthis.arrayData[index2],\n\t\t\tthis.arrayXPositions[index2],\n\t\t\tARRAY_Y_POS\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel3,\n\t\t\tthis.arrayData[index1],\n\t\t\tHEAP_X_POSITIONS[index1],\n\t\t\tHEAP_Y_POSITIONS[index1]\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.swapLabel4,\n\t\t\tthis.arrayData[index2],\n\t\t\tHEAP_X_POSITIONS[index2],\n\t\t\tHEAP_Y_POSITIONS[index2]\n\t\t);\n\t\tthis.cmd(act.move, this.swapLabel1, this.arrayXPositions[index2], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel2, this.arrayXPositions[index1], ARRAY_Y_POS);\n\t\tthis.cmd(act.move, this.swapLabel3, HEAP_X_POSITIONS[index2], HEAP_Y_POSITIONS[index2]);\n\t\tthis.cmd(act.move, this.swapLabel4, HEAP_X_POSITIONS[index1], HEAP_Y_POSITIONS[index1]);\n\t\tconst tmp = this.arrayData[index1];\n\t\tthis.arrayData[index1] = this.arrayData[index2];\n\t\tthis.arrayData[index2] = tmp;\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayRects[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.arrayRects[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.setText, this.circleObjs[index1], this.arrayData[index1]);\n\t\tthis.cmd(act.setText, this.circleObjs[index2], this.arrayData[index2]);\n\t\tthis.cmd(act.delete, this.swapLabel1);\n\t\tthis.cmd(act.delete, this.swapLabel2);\n\t\tthis.cmd(act.delete, this.swapLabel3);\n\t\tthis.cmd(act.delete, this.swapLabel4);\n\t}\n\n\tsetIndexHighlight(index, highlightVal) {\n\t\tthis.cmd(act.setHighlight, this.circleObjs[index], highlightVal);\n\t\tthis.cmd(act.setHighlight, this.arrayRects[index], highlightVal);\n\t}\n\n\tpushDown(index) {\n\t\tlet childIndex; // Used to keep track of smallest (in MinHeap) or largest (in MaxHeap) child\n\n\t\twhile (index * 2 <= this.currentHeapSize) {\n\t\t\tchildIndex = 2 * index;\n\n\t\t\tif (index * 2 + 1 <= this.currentHeapSize) {\n\t\t\t\tthis.setIndexHighlight(2 * index, 1);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(2 * index, 0);\n\t\t\t\tthis.setIndexHighlight(2 * index + 1, 0);\n\t\t\t\tif (this.downheapCheckRightChild(index)) {\n\t\t\t\t\tchildIndex = 2 * index + 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.setIndexHighlight(index, 1);\n\t\t\tthis.setIndexHighlight(childIndex, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(index, 0);\n\t\t\tthis.setIndexHighlight(childIndex, 0);\n\n\t\t\tif (this.downheapCompare(childIndex, index)) {\n\t\t\t\tthis.swap(childIndex, index);\n\t\t\t\tindex = childIndex;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCheckRightChild(index) {\n\t\t// Checks if the right child is smaller (in MinHeap) or greater (in MaxHeap) than left child\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[2 * index + 1] < this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[2 * index + 1] > this.arrayData[2 * index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdownheapCompare(childIndex, index) {\n\t\t// Checks if smallest child is smaller than parent (in MinHeap)\n\t\t// or greatest child is greater than parent (in MaxHeap)\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[childIndex] < this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[childIndex] > this.arrayData[index]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremove() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\tif (this.currentHeapSize === 0) {\n\t\t\tthis.cmd(act.setText, this.descriptLabel1, 'Heap is empty, cannot dequeue');\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element:');\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.descriptLabel2,\n\t\t\tthis.arrayData[1],\n\t\t\tHEAP_X_POSITIONS[1],\n\t\t\tHEAP_Y_POSITIONS[1],\n\t\t\t0\n\t\t);\n\t\tthis.cmd(act.setText, this.circleObjs[1], '');\n\t\tthis.cmd(act.move, this.descriptLabel2, 120, 40);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Removing element: ' + this.arrayData[1]);\n\t\tthis.arrayData[1] = '';\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], '');\n\t\t\tthis.swap(1, this.currentHeapSize);\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t\tthis.pushDown(1);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.arrayRects[1], '');\n\t\t\tthis.cmd(act.delete, this.circleObjs[this.currentHeapSize]);\n\t\t\tthis.currentHeapSize--;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tbuildHeap(params) {\n\t\tthis.commands = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',') // Split on commas\n\t\t\t.map(Number) // Map to numbers (to remove invalid characters)\n\t\t\t.filter(x => !Number.isNaN(x)) // Remove stuff that was invalid\n\t\t\t.slice(0, 31) // Get first 31 numbers\n\t\t\t.map(String); // Map back to strings\n\t\tthis.arrayData.unshift(0); // Add a 0 to start of array\n\t\tthis.clear();\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = this.normalizeNumber(this.arrayData[i], 4);\n\t\t\tthis.cmd(\n\t\t\t\tact.createCircle,\n\t\t\t\tthis.circleObjs[i],\n\t\t\t\tthis.arrayData[i],\n\t\t\t\tHEAP_X_POSITIONS[i],\n\t\t\t\tHEAP_Y_POSITIONS[i]\n\t\t\t);\n\t\t\tthis.cmd(act.setText, this.arrayRects[i], this.arrayData[i]);\n\t\t\tif (i > 1) {\n\t\t\t\tthis.cmd(act.connect, this.circleObjs[Math.floor(i / 2)], this.circleObjs[i]);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.currentHeapSize = this.arrayData.length - 1;\n\t\tlet nextElem = this.currentHeapSize;\n\t\twhile (nextElem > 0) {\n\t\t\tthis.pushDown(nextElem);\n\t\t\tnextElem = nextElem - 1;\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\n\t\tif (this.currentHeapSize >= ARRAY_SIZE - 1) {\n\t\t\tthis.cmd(act.setText, this.descriptLabel1, 'Heap Full!');\n\t\t\treturn this.commands;\n\t\t}\n\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ' + insertedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.descriptLabel1, 'Enqueueing Element: ');\n\t\tthis.currentHeapSize++;\n\t\tthis.arrayData[this.currentHeapSize] = insertedValue;\n\t\tthis.cmd(\n\t\t\tact.createCircle,\n\t\t\tthis.circleObjs[this.currentHeapSize],\n\t\t\t'',\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize]\n\t\t);\n\t\tthis.cmd(act.createLabel, this.descriptLabel2, insertedValue, 120, 45, 1);\n\t\tif (this.currentHeapSize > 1) {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.circleObjs[Math.floor(this.currentHeapSize / 2)],\n\t\t\t\tthis.circleObjs[this.currentHeapSize]\n\t\t\t);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.move,\n\t\t\tthis.descriptLabel2,\n\t\t\tHEAP_X_POSITIONS[this.currentHeapSize],\n\t\t\tHEAP_Y_POSITIONS[this.currentHeapSize]\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.circleObjs[this.currentHeapSize], insertedValue);\n\t\tthis.cmd(act.delete, this.descriptLabel2);\n\t\tthis.cmd(act.setText, this.arrayRects[this.currentHeapSize], insertedValue);\n\n\t\tlet currentIndex = this.currentHeapSize;\n\t\tlet parentIndex = Math.floor(currentIndex / 2);\n\n\t\tif (currentIndex > 1) {\n\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t}\n\n\t\twhile (currentIndex > 1 && this.upheapCompare(currentIndex, parentIndex)) {\n\t\t\tthis.swap(currentIndex, parentIndex);\n\t\t\tcurrentIndex = parentIndex;\n\t\t\tparentIndex = Math.floor(parentIndex / 2);\n\t\t\tif (currentIndex > 1) {\n\t\t\t\tthis.setIndexHighlight(currentIndex, 1);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 1);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.setIndexHighlight(currentIndex, 0);\n\t\t\t\tthis.setIndexHighlight(parentIndex, 0);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.setText, this.descriptLabel1, '');\n\n\t\treturn this.commands;\n\t}\n\n\tupheapCompare(currentIndex, parentIndex) {\n\t\tif (this.isMinHeap) {\n\t\t\tif (this.arrayData[currentIndex] < this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.arrayData[currentIndex] > this.arrayData[parentIndex]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tthis.insertField.disabled = true;\n\t\tthis.insertButton.disabled = true;\n\t\tthis.removeButton.disabled = true;\n\t\tthis.clearButton.disabled = true;\n\t\tthis.buildHeapButton.disabled = true;\n\t\tthis.minHeapButton.disabled = true;\n\t\tthis.maxHeapButton.disabled = true;\n\t}\n\n\tenableUI() {\n\t\tthis.insertField.disabled = false;\n\t\tthis.insertButton.disabled = false;\n\t\tthis.removeButton.disabled = false;\n\t\tthis.clearButton.disabled = false;\n\t\tthis.buildHeapButton.disabled = false;\n\t\tthis.minHeapButton.disabled = false;\n\t\tthis.maxHeapButton.disabled = false;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nexport default class InsertionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma seperated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tfor (let j = i; j >= 1; j--) {\n\t\t\t\tthis.movePointers(j - 1, j);\n\t\t\t\tif (this.arrayData[j] < this.arrayData[j - 1]) {\n\t\t\t\t\tthis.swap(j, j - 1);\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (i === 1) this.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\nconst FAILURE_TABLE_START_Y = 100;\n\nexport default class KMP extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddLabelToAlgorithmBar('or');\n\n\t\t// Build Failure Table button\n\t\tthis.bftButton = addControlToAlgorithmBar('Button', 'Build Failure Table');\n\t\tthis.bftButton.onclick = this.buildFailureTableCallback.bind(this);\n\t\tthis.controls.push(this.bftButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.failureTableLabelID = this.nextIndex++;\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tbuildFailureTableCallback() {\n\t\tif (this.patternField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.onlyBuildFailureTable.bind(this), 0, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\tconst maxRows = this.getMaxRows(text, pattern);\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst failureTable = this.buildFailureTable(text.length, pattern);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y + this.cellSize,\n\t\t\tthis.cellSize / 2\n\t\t);\n\n\t\tlet i = 0;\n\t\tlet j = 0;\n\t\tlet row = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t\tif (k - i < j) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\tj++;\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (j === 0) {\n\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i], '#E74C3C');\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t\t}\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\trow++;\n\t\t\tif (i <= text.length - pattern.length) {\n\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\treturn this.commands;\n\t}\n\n\tgetMaxRows(text, pattern) {\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tj++;\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tj++;\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ti = 0;\n\t\tj = 0;\n\t\tlet maxRows = 0;\n\t\twhile (i <= text.length - pattern.length) {\n\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\tj++;\n\t\t\t}\n\t\t\tif (j === 0) {\n\t\t\t\ti++;\n\t\t\t} else {\n\t\t\t\tconst nextAlignment = failureTable[j - 1];\n\t\t\t\ti += j - nextAlignment;\n\t\t\t\tj = nextAlignment;\n\t\t\t}\n\t\t\tmaxRows++;\n\t\t}\n\t\treturn maxRows;\n\t}\n\n\tonlyBuildFailureTable(textLength, pattern) {\n\t\tthis.commands = [];\n\t\tthis.cellSize = 30;\n\t\tthis.buildFailureTable(textLength, pattern);\n\t\treturn this.commands;\n\t}\n\n\tbuildFailureTable(textLength, pattern) {\n\t\t// Display label\n\t\tconst labelX = ARRAY_START_X + textLength * this.cellSize + 10;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.failureTableLabelID,\n\t\t\t'Failure table:',\n\t\t\tlabelX,\n\t\t\tFAILURE_TABLE_START_Y + 10,\n\t\t\t0\n\t\t);\n\n\t\t// Display empty failure table\n\t\tconst tableStartX = ARRAY_START_X + textLength * this.cellSize + 110;\n\t\tthis.failureTableCharacterID = new Array(pattern.length);\n\t\tthis.failureTableValueID = new Array(pattern.length);\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\tconst xpos = tableStartX + i * this.cellSize;\n\t\t\tthis.failureTableCharacterID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableCharacterID[i],\n\t\t\t\tpattern.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.failureTableCharacterID[i], '#D3D3D3');\n\t\t\tthis.failureTableValueID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.failureTableValueID[i],\n\t\t\t\t'',\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\tFAILURE_TABLE_START_Y + this.cellSize\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Display pointers and set first value to 0\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tiPointerID,\n\t\t\t'#0000FF',\n\t\t\ttableStartX,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tjPointerID,\n\t\t\t'#FF0000',\n\t\t\ttableStartX + this.cellSize,\n\t\t\tFAILURE_TABLE_START_Y,\n\t\t\tthis.cellSize / 2\n\t\t);\n\t\tthis.cmd(act.setText, this.failureTableValueID[0], 0);\n\t\tthis.cmd(act.step);\n\n\t\tconst failureTable = [];\n\t\tfailureTable[0] = 0;\n\t\tlet i = 0;\n\t\tlet j = 1;\n\t\twhile (j < pattern.length) {\n\t\t\tif (pattern.charAt(i) === pattern.charAt(j)) {\n\t\t\t\ti++;\n\t\t\t\tfailureTable[j] = i;\n\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\tj++;\n\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tfailureTable[j] = i;\n\t\t\t\t\tthis.cmd(act.setText, this.failureTableValueID[j], i);\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j < pattern.length) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\tjPointerID,\n\t\t\t\t\t\t\ttableStartX + j * this.cellSize,\n\t\t\t\t\t\t\tFAILURE_TABLE_START_Y\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t} else {\n\t\t\t\t\ti = failureTable[i - 1];\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tiPointerID,\n\t\t\t\t\t\ttableStartX + i * this.cellSize,\n\t\t\t\t\t\tFAILURE_TABLE_START_Y\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\n\t\treturn failureTable;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\t\tif (this.failureTableValueID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.failureTableLabelID);\n\t\t}\n\t\tfor (let i = 0; i < this.failureTableCharacterID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.failureTableCharacterID[i]);\n\t\t\tthis.cmd(act.delete, this.failureTableValueID[i]);\n\t\t}\n\t\tthis.failureTableCharacterID = [];\n\t\tthis.failureTableValueID = [];\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Graph, { EDGE_COLOR, VERTEX_INDEX_COLOR } from './Graph.js';\nimport { addControlToAlgorithmBar, addDivisorToAlgorithmBar, } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nexport default class Kruskal extends Graph {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h, false, false);\n\t\tthis.showEdgeCosts = true;\n\t}\n\n\taddControls() {\n\t\tthis.startButton = addControlToAlgorithmBar('Button', 'Run Kruskal');\n\t\tthis.startButton.onclick = this.startCallback.bind(this);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tsuper.addControls(false);\n\t}\n\n\tsetup() {\n\t\tsuper.setup();\n\t\tthis.messageID = [];\n\t\tthis.commands = [];\n\t\tthis.setID = new Array(this.size);\n\t\tthis.setIndexID = new Array(this.size);\n\t\tthis.setData = new Array(this.size);\n\n\t\tlet i;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setID[i] = this.nextIndex++;\n\t\t\tthis.setIndexID[i] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.setID[i],\n\t\t\t\t'-1',\n\t\t\t\tKruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tKruskal.SET_ARRAY_ELEM_HEIGHT,\n\t\t\t\tKruskal.SET_ARRAY_START_X,\n\t\t\t\tKruskal.SET_ARRAY_START_Y + i * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.createLabel,\n\t\t\t\tthis.setIndexID[i],\n\t\t\t\ti,\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tKruskal.SET_ARRAY_START_Y + i * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.setForegroundColor, this.setIndexID[i], VERTEX_INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.nextIndex++,\n\t\t\t'Disjoint Set',\n\t\t\tKruskal.SET_ARRAY_START_X - 1 * Kruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\tKruskal.SET_ARRAY_START_Y - Kruskal.SET_ARRAY_ELEM_HEIGHT * 1.5,\n\t\t\t0\n\t\t);\n\t\tthis.animationManager.setAllLayers([0, this.currentLayer]);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tstartCallback() {\n\t\tthis.implementAction(this.doKruskal.bind(this));\n\t}\n\n\tdisjointSetFind(valueToFind, highlightCircleID) {\n\t\tthis.cmd(act.setTextColor, this.setID[valueToFind], '#FF0000');\n\t\tthis.cmd(act.step);\n\t\twhile (this.setData[valueToFind] >= 0) {\n\t\t\tthis.cmd(act.setTextColor, this.setID[valueToFind], '#000000');\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircleID,\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\n\t\t\t\t\tthis.setData[valueToFind] * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tvalueToFind = this.setData[valueToFind];\n\t\t\tthis.cmd(act.setTextColor, this.setID[valueToFind], '#FF0000');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tthis.cmd(act.setTextColor, this.setID[valueToFind], '#000000');\n\t\treturn valueToFind;\n\t}\n\n\tdoKruskal() {\n\t\tthis.commands = [];\n\n\t\tthis.edgesListLeftID = [];\n\t\tthis.edgesListRightID = [];\n\t\tthis.edgesListLeft = [];\n\t\tthis.edgesListRight = [];\n\n\t\tlet i;\n\t\tlet j;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tthis.setData[i] = -1;\n\t\t\tthis.cmd(act.setText, this.setID[i], '-1');\n\t\t}\n\n\t\tthis.recolorGraph();\n\n\t\t// Create Edge List\n\t\tlet top;\n\t\tfor (i = 0; i < this.size; i++) {\n\t\t\tfor (j = i + 1; j < this.size; j++) {\n\t\t\t\tif (this.adj_matrix[i][j] >= 0) {\n\t\t\t\t\tthis.edgesListLeftID.push(this.nextIndex++);\n\t\t\t\t\tthis.edgesListRightID.push(this.nextIndex++);\n\t\t\t\t\ttop = this.edgesListLeftID.length - 1;\n\t\t\t\t\tthis.edgesListLeft.push(i);\n\t\t\t\t\tthis.edgesListRight.push(j);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\ti,\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\t\t\tMath.floor(top / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\tj,\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\t\t\tMath.floor(top / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t\t\t(top % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connect,\n\t\t\t\t\t\tthis.edgesListLeftID[top],\n\t\t\t\t\t\tthis.edgesListRightID[top],\n\t\t\t\t\t\tEDGE_COLOR,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\tthis.adj_matrix[i][j]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Sort edge list based on edge cost\n\t\tconst edgeCount = this.edgesListLeftID.length;\n\t\tlet tmpLeftID;\n\t\tlet tmpRightID;\n\t\tlet tmpLeft;\n\t\tlet tmpRight;\n\t\tfor (i = 1; i < edgeCount; i++) {\n\t\t\ttmpLeftID = this.edgesListLeftID[i];\n\t\t\ttmpRightID = this.edgesListRightID[i];\n\t\t\ttmpLeft = this.edgesListLeft[i];\n\t\t\ttmpRight = this.edgesListRight[i];\n\t\t\tj = i;\n\t\t\twhile (\n\t\t\t\tj > 0 &&\n\t\t\t\tthis.adj_matrix[this.edgesListLeft[j - 1]][this.edgesListRight[j - 1]] >\n\t\t\t\t\tthis.adj_matrix[tmpLeft][tmpRight]\n\t\t\t) {\n\t\t\t\tthis.edgesListLeft[j] = this.edgesListLeft[j - 1];\n\t\t\t\tthis.edgesListRight[j] = this.edgesListRight[j - 1];\n\t\t\t\tthis.edgesListLeftID[j] = this.edgesListLeftID[j - 1];\n\t\t\t\tthis.edgesListRightID[j] = this.edgesListRightID[j - 1];\n\t\t\t\tj = j - 1;\n\t\t\t}\n\t\t\tthis.edgesListLeft[j] = tmpLeft;\n\t\t\tthis.edgesListRight[j] = tmpRight;\n\t\t\tthis.edgesListLeftID[j] = tmpLeftID;\n\t\t\tthis.edgesListRightID[j] = tmpRightID;\n\t\t}\n\t\tfor (i = 0; i < edgeCount; i++) {\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListLeftID[i],\n\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\tMath.floor(i / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t(i % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\tthis.edgesListRightID[i],\n\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\tMath.floor(i / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t(i % Kruskal.EDGE_LIST_MAX_PER_COLUMN) * Kruskal.EDGE_LIST_ELEM_HEIGHT\n\t\t\t);\n\t\t}\n\n\t\tthis.cmd(act.step);\n\n\t\tconst findLabelLeft = this.nextIndex++;\n\t\tconst findLabelRight = this.nextIndex++;\n\t\tconst highlightCircle1 = this.nextIndex++;\n\t\tconst highlightCircle2 = this.nextIndex++;\n\t\tconst moveLabelID = this.nextIndex++;\n\t\tconst messageLabelID = this.nextIndex++;\n\n\t\tlet edgesAdded = 0;\n\t\tlet nextListIndex = 0;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tfindLabelLeft,\n\t\t\t'',\n\t\t\tKruskal.FIND_LABEL_1_X,\n\t\t\tKruskal.FIND_LABEL_1_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tfindLabelRight,\n\t\t\t'',\n\t\t\tKruskal.FIND_LABEL_2_X,\n\t\t\tKruskal.FIND_LABEL_2_Y,\n\t\t\t0\n\t\t);\n\n\t\twhile (edgesAdded < this.size - 1 && nextListIndex < edgeCount) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setEdgeHighlight,\n\t\t\t\tthis.edgesListLeftID[nextListIndex],\n\t\t\t\tthis.edgesListRightID[nextListIndex],\n\t\t\t\t1\n\t\t\t);\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t1\n\t\t\t);\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t1\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + String(this.edgesListLeft[nextListIndex]) + ') = '\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle1,\n\t\t\t\tKruskal.HIGHLIGHT_CIRCLE_COLOR_1,\n\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\tMath.floor(nextListIndex / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t(nextListIndex % Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t15\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle1,\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\n\t\t\t\t\tthis.edgesListLeft[nextListIndex] * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst left = this.disjointSetFind(this.edgesListLeft[nextListIndex], highlightCircle1);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelLeft,\n\t\t\t\t'find(' + String(this.edgesListLeft[nextListIndex]) + ') = ' + String(left)\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + String(this.edgesListRight[nextListIndex]) + ') = '\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\thighlightCircle2,\n\t\t\t\tKruskal.HIGHLIGHT_CIRCLE_COLOR_2,\n\t\t\t\tKruskal.EDGE_LIST_START_X +\n\t\t\t\t\tKruskal.EDGE_LIST_ELEM_WIDTH +\n\t\t\t\t\tMath.floor(nextListIndex / Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_COLUMN_WIDTH,\n\t\t\t\tKruskal.EDGE_LIST_START_Y +\n\t\t\t\t\t(nextListIndex % Kruskal.EDGE_LIST_MAX_PER_COLUMN) *\n\t\t\t\t\t\tKruskal.EDGE_LIST_ELEM_HEIGHT,\n\t\t\t\t15\n\t\t\t);\n\n\t\t\tthis.cmd(\n\t\t\t\tact.move,\n\t\t\t\thighlightCircle2,\n\t\t\t\tKruskal.SET_ARRAY_START_X - Kruskal.SET_ARRAY_ELEM_WIDTH,\n\t\t\t\tKruskal.SET_ARRAY_START_Y +\n\t\t\t\t\tthis.edgesListRight[nextListIndex] * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tconst right = this.disjointSetFind(\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\thighlightCircle2\n\t\t\t);\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tfindLabelRight,\n\t\t\t\t'find(' + String(this.edgesListRight[nextListIndex]) + ') = ' + String(right)\n\t\t\t);\n\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (left !== right) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tmessageLabelID,\n\t\t\t\t\t'Vertices in different trees.  Add edge to tree: Union(' +\n\t\t\t\t\t\tString(left) +\n\t\t\t\t\t\t',' +\n\t\t\t\t\t\tString(right) +\n\t\t\t\t\t\t')',\n\t\t\t\t\tKruskal.MESSAGE_LABEL_X,\n\t\t\t\t\tKruskal.MESSAGE_LABEL_Y,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.highlightEdge(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\t1\n\t\t\t\t);\n\t\t\t\tthis.highlightEdge(\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\t1\n\t\t\t\t);\n\t\t\t\tedgesAdded++;\n\t\t\t\tthis.setEdgeColor(\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\t'#FF0000'\n\t\t\t\t);\n\t\t\t\tthis.setEdgeColor(\n\t\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t\t'#FF0000'\n\t\t\t\t);\n\t\t\t\tif (this.setData[left] < this.setData[right]) {\n\t\t\t\t\tthis.cmd(act.setText, this.setID[right], '');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tmoveLabelID,\n\t\t\t\t\t\tthis.setData[right],\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + right * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveLabelID,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + left * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, moveLabelID);\n\t\t\t\t\tthis.setData[left] = this.setData[left] + this.setData[right];\n\t\t\t\t\tthis.setData[right] = left;\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, this.setID[left], '');\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tmoveLabelID,\n\t\t\t\t\t\tthis.setData[left],\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + left * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tmoveLabelID,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_X,\n\t\t\t\t\t\tKruskal.SET_ARRAY_START_Y + right * Kruskal.SET_ARRAY_ELEM_HEIGHT\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.delete, moveLabelID);\n\t\t\t\t\tthis.setData[right] = this.setData[right] + this.setData[left];\n\t\t\t\t\tthis.setData[left] = right;\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.setText, this.setID[left], this.setData[left]);\n\t\t\t\tthis.cmd(act.setText, this.setID[right], this.setData[right]);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createLabel,\n\t\t\t\t\tmessageLabelID,\n\t\t\t\t\t'Vertices in the same tree.  Skip edge',\n\t\t\t\t\tKruskal.MESSAGE_LABEL_X,\n\t\t\t\t\tKruskal.MESSAGE_LABEL_Y,\n\t\t\t\t\t0\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.highlightEdge(\n\t\t\t\tthis.edgesListRight[nextListIndex],\n\t\t\t\tthis.edgesListLeft[nextListIndex],\n\t\t\t\t0\n\t\t\t);\n\n\t\t\tthis.cmd(act.delete, messageLabelID);\n\t\t\tthis.cmd(act.delete, highlightCircle1);\n\t\t\tthis.cmd(act.delete, highlightCircle2);\n\n\t\t\tthis.cmd(act.delete, this.edgesListLeftID[nextListIndex]);\n\t\t\tthis.cmd(act.delete, this.edgesListRightID[nextListIndex]);\n\t\t\tthis.cmd(act.setText, findLabelLeft, '');\n\t\t\tthis.cmd(act.setText, findLabelRight, '');\n\t\t\tnextListIndex++;\n\t\t}\n\t\tthis.cmd(act.delete, findLabelLeft);\n\t\tthis.cmd(act.delete, findLabelRight);\n\n\t\treturn this.commands;\n\t}\n\n\treset() {\n\t\tthis.messageID = [];\n\t}\n\n\tenableUI(event) {\n\t\tthis.startButton.disabled = false;\n\n\t\tsuper.enableUI(event);\n\t}\n\n\tdisableUI(event) {\n\t\tthis.startButton.disabled = true;\n\n\t\tsuper.disableUI(event);\n\t}\n}\n\nKruskal.HIGHLIGHT_CIRCLE_COLOR = '#000000';\n\nKruskal.SET_ARRAY_ELEM_WIDTH = 25;\nKruskal.SET_ARRAY_ELEM_HEIGHT = 25;\nKruskal.SET_ARRAY_START_X = 50;\nKruskal.SET_ARRAY_START_Y = 130;\n\nKruskal.EDGE_LIST_ELEM_WIDTH = 40;\nKruskal.EDGE_LIST_ELEM_HEIGHT = 40;\nKruskal.EDGE_LIST_COLUMN_WIDTH = 100;\nKruskal.EDGE_LIST_MAX_PER_COLUMN = 10;\n\nKruskal.EDGE_LIST_START_X = 150;\nKruskal.EDGE_LIST_START_Y = 130;\n\nKruskal.FIND_LABEL_1_X = 30;\nKruskal.FIND_LABEL_2_X = 100;\nKruskal.FIND_LABEL_1_Y = 30;\nKruskal.FIND_LABEL_2_Y = Kruskal.FIND_LABEL_1_Y;\n\nKruskal.MESSAGE_LABEL_X = 30;\nKruskal.MESSAGE_LABEL_Y = 50;\n\nKruskal.HIGHLIGHT_CIRCLE_COLOR_1 = '#FFAAAA';\nKruskal.HIGHLIGHT_CIRCLE_COLOR_2 = '#FF0000';\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst INFO_LABEL_X = 75;\nconst INFO_LABEL_Y = 20;\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 70;\n\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst BUCKETS_START_X = 100;\nconst BUCKETS_START_Y = 140;\n\nconst BUCKET_ELEM_WIDTH = 50;\nconst BUCKET_ELEM_HEIGHT = 20;\nconst BUCKET_ELEM_SPACING = 15;\n\nexport default class LSDRadix extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 9 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.infoLabelID = this.nextIndex++;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tfor (let i = 0; i < this.bucketsID.length; i++) {\n\t\t\tfor (let j = 0; j < this.bucketsID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.bucketsID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.arrayDisplay = [];\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\t\tthis.bucketsDisplay = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 9);\n\t\tconst length = this.arrayData.length;\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\t// Create data array\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet arrayDisplay = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tarrayDisplay += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.arrayDisplay[i] = arrayDisplay;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tarrayDisplay,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\n\t\tthis.bucketsData = [];\n\t\tthis.bucketsID = [];\n\n\t\t// Create buckets\n\t\tfor (let i = 0; i < 10; i++) {\n\t\t\tthis.bucketsData[i] = [];\n\t\t\tthis.bucketsID[i] = [];\n\t\t\tthis.bucketsDisplay[i] = [];\n\t\t\tthis.bucketsID[i].push(this.nextIndex++);\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + BUCKETS_START_X;\n\t\t\tconst ypos = BUCKETS_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.bucketsID[i][0],\n\t\t\t\ti,\n\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.bucketsID[i], '#D3D3D3');\n\t\t}\n\n\t\t// Find number of digits\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.infoLabelID,\n\t\t\t'Searching for number with greatest magnitude',\n\t\t\tINFO_LABEL_X,\n\t\t\tINFO_LABEL_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\n\t\tlet greatest = 0;\n\t\tfor (let i = 1; i < this.arrayData.length; i++) {\n\t\t\tthis.movePointers(greatest, i);\n\t\t\tif (this.arrayData[i] > this.arrayData[greatest]) {\n\t\t\t\tgreatest = i;\n\t\t\t\tthis.movePointers(greatest, i);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFF00');\n\n\t\tlet digits = Math.floor(Math.log10(this.arrayData[greatest])) + 1;\n\t\tdigits = digits || 1; // If greatest is 0, above returns NaN, so set to 1 if that happens\n\n\t\tconst longData = this.arrayData[greatest];\n\t\tthis.cmd(\n\t\t\tact.setText,\n\t\t\tthis.infoLabelID,\n\t\t\tlongData + ' has greatest magnitude, number of digits is ' + digits\n\t\t);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[greatest], '#FFFFFF');\n\n\t\t// Run algorithm\n\t\tfor (let i = 0; i < digits; i++) {\n\t\t\tthis.cmd(act.setText, this.infoLabelID, 'Getting digits at position ' + (i + 1));\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.iPointerID,\n\t\t\t\t'#0000FF',\n\t\t\t\tARRAY_START_X,\n\t\t\t\tARRAY_START_Y\n\t\t\t);\n\t\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\t\tfor (let j = 0; j < this.arrayData.length; j++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\tthis.iPointerID,\n\t\t\t\t\tARRAY_START_X + j * ARRAY_ELEM_WIDTH,\n\t\t\t\t\tARRAY_START_Y\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tconst id = this.nextIndex++;\n\t\t\t\tconst data = this.arrayData[j];\n\t\t\t\tconst display = this.arrayDisplay[j];\n\t\t\t\tconst digit = this.nthDigit(data, i);\n\t\t\t\tthis.bucketsID[digit].push(id);\n\t\t\t\tthis.bucketsData[digit].push(data);\n\t\t\t\tthis.bucketsDisplay[digit].push(display);\n\t\t\t\tconst len = this.bucketsData[digit].length;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tid,\n\t\t\t\t\tdisplay,\n\t\t\t\t\tBUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKET_ELEM_HEIGHT,\n\t\t\t\t\tBUCKETS_START_X + digit * BUCKET_ELEM_WIDTH,\n\t\t\t\t\tBUCKETS_START_Y + len * BUCKET_ELEM_HEIGHT + len * BUCKET_ELEM_SPACING\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.bucketsID[digit][this.bucketsID[digit].length - 2],\n\t\t\t\t\tid,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\t1,\n\t\t\t\t\t'',\n\t\t\t\t\t2\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.iPointerID);\n\t\t\tthis.cmd(act.step);\n\t\t\tlet index = 0;\n\t\t\tfor (let j = 0; j < 10; j++) {\n\t\t\t\tconst idBucket = this.bucketsID[j];\n\t\t\t\tconst dataBucket = this.bucketsData[j];\n\t\t\t\tconst displayBucket = this.bucketsDisplay[j];\n\t\t\t\twhile (dataBucket.length) {\n\t\t\t\t\tconst labelID = this.nextIndex++;\n\t\t\t\t\tconst nodeID = idBucket.splice(1, 1)[0];\n\t\t\t\t\tconst data = dataBucket.shift();\n\t\t\t\t\tconst display = displayBucket.shift();\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.createLabel,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tdisplay,\n\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\tBUCKETS_START_Y + BUCKET_ELEM_HEIGHT + BUCKET_ELEM_SPACING\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tlabelID,\n\t\t\t\t\t\tARRAY_START_X + index * ARRAY_ELEM_WIDTH,\n\t\t\t\t\t\tARRAY_START_Y\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setText, this.arrayID[index], display);\n\t\t\t\t\tthis.cmd(act.delete, labelID);\n\t\t\t\t\tthis.cmd(act.delete, nodeID);\n\t\t\t\t\tif (dataBucket.length) {\n\t\t\t\t\t\tthis.cmd(act.connect, idBucket[0], idBucket[1]);\n\t\t\t\t\t\tfor (let k = 1; k < idBucket.length; k++) {\n\t\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\t\tidBucket[k],\n\t\t\t\t\t\t\t\tBUCKETS_START_X + j * BUCKET_ELEM_WIDTH,\n\t\t\t\t\t\t\t\tBUCKETS_START_Y + k * BUCKET_ELEM_HEIGHT + k * BUCKET_ELEM_SPACING\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t\tthis.arrayData[index] = data;\n\t\t\t\t\tthis.arrayDisplay[index] = display;\n\t\t\t\t\tindex++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, this.infoLabelID);\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t}\n\n\tnthDigit(data, digit) {\n\t\tdata = Math.floor(data / Math.pow(10, digit));\n\t\tdata %= 10;\n\t\treturn data;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar\n} from './Algorithm';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 200;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class LinkedList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst addVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst addTopHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\t\tconst addBottomHorizontalGroup = addGroupToAlgorithmBar(true, addVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', addTopHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('at index', addTopHorizontalGroup);\n\n\t\t// Add's index text field\n\t\tthis.addIndexField = addControlToAlgorithmBar('Text', '', addTopHorizontalGroup);\n\t\tthis.addIndexField.onkeydown = this.returnSubmit(\n\t\t\tthis.addIndexField,\n\t\t\t() => this.addIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addIndexField);\n\n\t\t// Add to front button\n\t\tthis.addFrontButton = addControlToAlgorithmBar('Button', 'Add to Front', addBottomHorizontalGroup);\n\t\tthis.addFrontButton.onclick = this.addFrontCallback.bind(this);\n\t\tthis.controls.push(this.addFrontButton);\n\n\t\t// Add to back button\n\t\tthis.addBackButton = addControlToAlgorithmBar('Button', 'Add to Back', addBottomHorizontalGroup);\n\t\tthis.addBackButton.onclick = () => this.addBackCallback();\n\t\tthis.controls.push(this.addBackButton);\n\n\t\taddLabelToAlgorithmBar('or', addBottomHorizontalGroup);\n\n\t\t// Add at index button\n\t\tthis.addIndexButton = addControlToAlgorithmBar('Button', 'Add at Index', addBottomHorizontalGroup);\n\t\tthis.addIndexButton.onclick = this.addIndexCallback.bind(this);\n\t\tthis.controls.push(this.addIndexButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tconst removeVerticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst removeTopHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\t\tconst removeBottomHorizontalGroup = addGroupToAlgorithmBar(true, removeVerticalGroup);\n\n\t\taddLabelToAlgorithmBar('Index', removeTopHorizontalGroup);\n\n\t\t// Remove's index text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '', removeTopHorizontalGroup);\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\t() => this.removeIndexCallback(),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove from index button\n\t\tthis.removeIndexButton = addControlToAlgorithmBar('Button', 'Remove from Index', removeTopHorizontalGroup);\n\t\tthis.removeIndexButton.onclick = () => this.removeIndexCallback();\n\t\tthis.controls.push(this.removeIndexButton);\n\n\t\taddLabelToAlgorithmBar('or', removeBottomHorizontalGroup);\n\n\t\t// Remove from front button\n\t\tthis.removeFrontButton = addControlToAlgorithmBar('Button', 'Remove from Front', removeBottomHorizontalGroup);\n\t\tthis.removeFrontButton.onclick = () => this.removeFrontCallback();\n\t\tthis.controls.push(this.removeFrontButton);\n\n\t\t// Remove from back button\n\t\tthis.removeBackButton = addControlToAlgorithmBar('Button', 'Remove from Back', removeBottomHorizontalGroup);\n\t\tthis.removeBackButton.onclick = () => this.removeBackCallback();\n\t\tthis.controls.push(this.removeBackButton);\n\n\t\t// Get's index text field\n\t\t// this.getField = addControlToAlgorithmBar(\"Text\", \"\");\n\t\t// this.getField.onkeydown = this.returnSubmit(this.getField, () => this.getCallback(), 4, true);\n\t\t// this.controls.push(this.getField);\n\n\t\t// Get button\n\t\t// this.getButton = addControlToAlgorithmBar(\"Button\", \"Get\");\n\t\t// this.getButton.onclick = () => this.getCallback();\n\t\t// this.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = () => this.clearCallback();\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.size = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.size = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\taddIndexCallback() {\n\t\tif (this.addValueField.value !== '' && this.addIndexField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tconst index = parseInt(this.addIndexField.value);\n\t\t\tif (index >= 0 && index <= this.size) {\n\t\t\t\tthis.addValueField.value = '';\n\t\t\t\tthis.addIndexField.value = '';\n\t\t\t\tthis.implementAction(this.add.bind(this), addVal, index);\n\t\t\t}\n\t\t}\n\t}\n\n\taddFrontCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, 0);\n\t\t}\n\t}\n\n\taddBackCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, this.size);\n\t\t}\n\t}\n\n\tremoveIndexCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst index = this.removeField.value;\n\t\t\tif (index >= 0 && index < this.size) {\n\t\t\t\tthis.removeField.value = '';\n\t\t\t\tthis.implementAction(this.remove.bind(this), index);\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveFrontCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), 0);\n\t\t}\n\t}\n\n\tremoveBackCallback() {\n\t\tif (this.size > 0) {\n\t\t\tthis.implementAction(this.remove.bind(this), this.size - 1);\n\t\t}\n\t}\n\n\t// getCallback()\n\t// {\n\t//     if (this.getField.value != \"\" && this.getField.value > 0 && this.getField.value < this.size)\n\t//     {\n\t//         this.implementAction(this.get.bind(this), \"\");\n\t//     }\n\t// }\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(elemToAdd, index) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\n\t\tfor (let i = this.size - 1; i >= index; i--) {\n\t\t\tthis.arrayData[i + 1] = this.arrayData[i];\n\t\t\tthis.linkedListElemID[i + 1] = this.linkedListElemID[i];\n\t\t}\n\t\tthis.arrayData[index] = elemToAdd;\n\t\tthis.linkedListElemID[index] = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[index],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Adding Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToAdd, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[index], elemToAdd);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (index === this.size) {\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index], 1);\n\t\t}\n\n\t\tif (this.size !== 0) {\n\t\t\tif (index === 0) {\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index], this.linkedListElemID[index + 1]);\n\t\t\t} else if (index === this.size) {\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 0);\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index - 1], this.linkedListElemID[index]);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index - 1], this.linkedListElemID[index]);\n\t\t\t\tthis.cmd(act.connect, this.linkedListElemID[index], this.linkedListElemID[index + 1]);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.step);\n\t\tthis.size = this.size + 1;\n\t\tthis.resetNodePositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tremove(index) {\n\t\tthis.commands = [];\n\n\t\tindex = parseInt(index);\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tconst nodePosX = LINKED_LIST_START_X + LINKED_LIST_ELEM_SPACING * index;\n\t\tconst nodePosY = LINKED_LIST_START_Y;\n\t\tthis.cmd(act.createLabel, labPopID, 'Removing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[index], nodePosX, nodePosY);\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tif (this.size !== 1) {\n\t\t\tif (index === 0) {\n\t\t\t\t//TODO: Move head pointer\n\t\t\t} else if (index === this.size - 1) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.setNull, this.linkedListElemID[index - 1], 1);\n\t\t\t} else {\n\t\t\t\tconst xPos =\n\t\t\t\t\t(index % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\t\tLINKED_LIST_START_X;\n\t\t\t\tconst yPos = LINKED_LIST_START_Y - LINKED_LIST_ELEM_HEIGHT * 2;\n\t\t\t\tthis.cmd(act.move, this.linkedListElemID[index], xPos, yPos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index]\n\t\t\t\t);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.linkedListElemID[index - 1],\n\t\t\t\t\tthis.linkedListElemID[index + 1]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[index]);\n\n\t\tfor (let i = index; i < this.size; i++) {\n\t\t\tthis.arrayData[i] = this.arrayData[i + 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i + 1];\n\t\t}\n\t\tthis.size = this.size - 1;\n\t\tthis.resetNodePositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\n\t\treturn this.commands;\n\t}\n\n\tresetNodePositions() {\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tconst nextX =\n\t\t\t\t(i % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING + LINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor(i / LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.size; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.size = 0;\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 120;\nconst ARRAY_START_Y = 50;\nconst ARRAY_LINE_SPACING = 80;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nconst LARGE_OFFSET = 15;\nconst SMALL_OFFSET = 7;\n\nexport default class MergeSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\n\t\t// Useful for memory management\n\t\tthis.nextIndex = 0;\n\n\t\t// TODO:  Add any code necessary to set up your own algorithm.  Initialize data\n\t\t// structures, etc.\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 12 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.kPointerID = 0;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 12);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst yPos = ARRAY_START_Y;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (this.arrayData.length !== 1) {\n\t\t\tconst mid = Math.ceil((this.arrayData.length - 1) / 2);\n\t\t\tthis.leftHelper(0, mid - 1, -LARGE_OFFSET, 0, 1);\n\t\t\tthis.rightHelper(mid, this.arrayData.length - 1, LARGE_OFFSET, 0, 1);\n\t\t\tthis.merge(\n\t\t\t\t0,\n\t\t\t\tthis.arrayData.length - 1,\n\t\t\t\tmid,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\t-LARGE_OFFSET,\n\t\t\t\tLARGE_OFFSET,\n\t\t\t\tthis.arrayID\n\t\t\t);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[0], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tleftHelper(left, right, offset, prevOffset, row) {\n\t\tif (left > right) return;\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\n\t\tif (left !== right) {\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.leftHelper(left, mid - 1, offset - extraOffset, offset, row + 1);\n\t\t\tthis.leftHelper(mid, right, offset, offset, row + 1);\n\t\t\tthis.merge(left, right, mid, row, offset, offset - extraOffset, offset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\trightHelper(left, right, offset, prevOffset, row) {\n\t\tif (left > right) return;\n\n\t\tconst tempArrayID = this.drawArrayAndCopy(left, right, offset, prevOffset, row);\n\n\t\tif (left !== right) {\n\t\t\tconst mid = Math.ceil((left + right) / 2);\n\t\t\tconst extraOffset = row < 2 ? 2 * LARGE_OFFSET : 2 * SMALL_OFFSET;\n\t\t\tthis.rightHelper(left, mid - 1, offset, offset, row + 1);\n\t\t\tthis.rightHelper(mid, right, offset + extraOffset, offset, row + 1);\n\t\t\tthis.merge(left, right, mid, row, offset, offset, offset + extraOffset, tempArrayID);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, tempArrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tdrawArrayAndCopy(left, right, offset, prevOffset, row) {\n\t\tconst tempArrayID = [];\n\n\t\t// Display subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tconst xPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\t\ttempArrayID[i] = this.nextIndex;\n\t\t\tthis.arrayID.push(this.nextIndex);\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex++,\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txPos,\n\t\t\t\tyPos\n\t\t\t);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\t// Copy elements from big array to current subarray\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\ti,\n\t\t\t\tprevOffset,\n\t\t\t\toffset,\n\t\t\t\trow - 1,\n\t\t\t\trow,\n\t\t\t\tthis.displayData[i],\n\t\t\t\ttempArrayID[i],\n\t\t\t\t-1\n\t\t\t);\n\t\t}\n\n\t\treturn tempArrayID;\n\t}\n\n\tmerge(left, right, mid, row, currOffset, leftOffset, rightOffset, currArrayID) {\n\t\tconst tempArray = new Array(this.arrayData.length); // Temporary array to store data for sorting\n\t\tconst tempDisplay = new Array(this.arrayData.length);\n\n\t\t// Copy data to temporary array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\ttempArray[i] = this.arrayData[i];\n\t\t\ttempDisplay[i] = this.displayData[i];\n\t\t}\n\n\t\t// Create pointers\n\t\tconst bottomYPos = ARRAY_START_Y + (row + 1) * ARRAY_LINE_SPACING;\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst iXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + leftOffset;\n\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', iXPos, bottomYPos);\n\t\tconst jPointerID = this.nextIndex++;\n\t\tconst jXPos = mid * ARRAY_ELEM_WIDTH + ARRAY_START_X + rightOffset;\n\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', jXPos, bottomYPos);\n\t\tconst kPointerID = this.nextIndex++;\n\t\tconst kXPos = left * ARRAY_ELEM_WIDTH + ARRAY_START_X + currOffset;\n\t\tconst topYPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.createHighlightCircle, kPointerID, '#0000FF', kXPos, topYPos);\n\t\tthis.cmd(act.step);\n\n\t\t// Merge data and animate\n\t\tlet i = left;\n\t\tlet j = mid;\n\t\tlet k = left;\n\t\twhile (i < mid && j <= right) {\n\t\t\tif (tempArray[i] <= tempArray[j]) {\n\t\t\t\tthis.copyData(\n\t\t\t\t\ti,\n\t\t\t\t\tk,\n\t\t\t\t\tleftOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[i],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tiPointerID\n\t\t\t\t);\n\t\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\t\tk++;\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t\ti++;\n\t\t\t\tif (i < mid) {\n\t\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.copyData(\n\t\t\t\t\tj,\n\t\t\t\t\tk,\n\t\t\t\t\trightOffset,\n\t\t\t\t\tcurrOffset,\n\t\t\t\t\trow + 1,\n\t\t\t\t\trow,\n\t\t\t\t\ttempDisplay[j],\n\t\t\t\t\tcurrArrayID[k],\n\t\t\t\t\tjPointerID\n\t\t\t\t);\n\t\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\t\tk++;\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t\tj++;\n\t\t\t\tif (j <= right) {\n\t\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\twhile (i < mid) {\n\t\t\tthis.copyData(\n\t\t\t\ti,\n\t\t\t\tk,\n\t\t\t\tleftOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[i],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tiPointerID\n\t\t\t);\n\t\t\tthis.arrayData[k] = tempArray[i];\n\t\t\tthis.displayData[k] = tempDisplay[i];\n\t\t\tk++;\n\t\t\ti++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(i, row + 1, leftOffset, iPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t}\n\t\twhile (j <= right) {\n\t\t\tthis.copyData(\n\t\t\t\tj,\n\t\t\t\tk,\n\t\t\t\trightOffset,\n\t\t\t\tcurrOffset,\n\t\t\t\trow + 1,\n\t\t\t\trow,\n\t\t\t\ttempDisplay[j],\n\t\t\t\tcurrArrayID[k],\n\t\t\t\tjPointerID\n\t\t\t);\n\t\t\tthis.arrayData[k] = tempArray[j];\n\t\t\tthis.displayData[k] = tempDisplay[j];\n\t\t\tj++;\n\t\t\tk++;\n\t\t\tif (k <= right) {\n\t\t\t\tthis.movePointer(j, row + 1, rightOffset, jPointerID);\n\t\t\t\tthis.movePointer(k, row, currOffset, kPointerID);\n\t\t\t}\n\t\t}\n\n\t\t// Delete pointers\n\t\tthis.cmd(act.delete, iPointerID);\n\t\tthis.cmd(act.delete, jPointerID);\n\t\tthis.cmd(act.delete, kPointerID);\n\t\tthis.cmd(act.step);\n\t}\n\n\tcopyData(fromIndex, toIndex, fromOffset, toOffset, fromRow, toRow, value, cellID, pointerID) {\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#FF0000');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst fromXPos = fromIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + fromOffset;\n\t\tconst fromYPos = ARRAY_START_Y + fromRow * ARRAY_LINE_SPACING;\n\t\tconst labelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, labelID, value, fromXPos, fromYPos);\n\t\tconst toXPos = toIndex * ARRAY_ELEM_WIDTH + ARRAY_START_X + toOffset;\n\t\tconst toYPos = ARRAY_START_Y + toRow * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, labelID, toXPos, toYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, cellID, value);\n\t\tthis.cmd(act.delete, labelID);\n\t\tif (pointerID !== -1) {\n\t\t\tthis.cmd(act.setBackgroundColor, cellID, '#2ECC71');\n\t\t\tthis.cmd(act.setForegroundColor, pointerID, '#0000FF');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tmovePointer(index, row, offset, pointerID) {\n\t\tconst xPos = index * ARRAY_ELEM_WIDTH + ARRAY_START_X + offset;\n\t\tconst yPos = ARRAY_START_Y + row * ARRAY_LINE_SPACING;\n\t\tthis.cmd(act.move, pointerID, xPos, yPos);\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Hash from './Hash.js';\nimport { act } from '../anim/AnimationMain';\n\nconst POINTER_ARRAY_ELEM_WIDTH = 70;\nconst POINTER_ARRAY_ELEM_HEIGHT = 30;\nconst POINTER_ARRAY_ELEM_START_X = 50;\n\nconst LINKED_ITEM_HEIGHT = 30;\nconst LINKED_ITEM_WIDTH = 65;\n\nconst LINKED_ITEM_Y_DELTA = 50;\n\nconst HASH_TABLE_SIZE = 13;\n\nconst INDEX_COLOR = '#0000FF';\n\nexport default class OpenHash extends Hash {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.nextIndex = 0;\n\t\tthis.POINTER_ARRAY_ELEM_Y = h - POINTER_ARRAY_ELEM_WIDTH;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tsuper.addControls();\n\t}\n\n\tinsertElement(elem) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Inserting element: ' + String(elem));\n\t\tconst index = this.doHash(elem);\n\n\t\tconst node = new LinkedListNode(elem, this.nextIndex++, 100, 75);\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tnode.graphicID,\n\t\t\telem,\n\t\t\tLINKED_ITEM_WIDTH,\n\t\t\tLINKED_ITEM_HEIGHT,\n\t\t\t100,\n\t\t\t75\n\t\t);\n\t\tlet found = false;\n\t\tif (this.hashTableValues[index] != null) {\n\t\t\t// Search for duplicates\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Searching for duplicates of ' + elem);\n\n\t\t\tconst compareIndex = this.nextIndex++;\n\t\t\tlet tmp = this.hashTableValues[index];\n\t\t\tthis.cmd(act.createLabel, compareIndex, '', 10, 40, 0);\n\t\t\twhile (tmp != null && !found) {\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\t\tif (tmp.data === elem) {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.data + '==' + elem);\n\t\t\t\t\tfound = true;\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.data + '!=' + elem);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\n\t\t\tthis.cmd(act.delete, compareIndex);\n\t\t\tthis.nextIndex--;\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, node.graphicID, 1);\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 0);\n\t\t}\n\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Duplicate of  ' + elem + '  found!');\n\t\t\tthis.cmd(act.delete, node.graphicID);\n\t\t\tthis.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Duplicate of  ' + elem + '  not found!');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.hashTableValues[index] != null) {\n\t\t\t\tthis.cmd(act.connect, node.graphicID, this.hashTableValues[index].graphicID);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.disconnect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].graphicID\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.cmd(act.connect, this.hashTableVisual[index], node.graphicID);\n\t\t\tnode.next = this.hashTableValues[index];\n\t\t\tthis.hashTableValues[index] = node;\n\t\t\tthis.repositionList(index);\n\t\t}\n\n\t\tthis.cmd(act.setText, this.ExplainLabel, '');\n\n\t\treturn this.commands;\n\t}\n\n\trepositionList(index) {\n\t\tconst startX = POINTER_ARRAY_ELEM_START_X + index * POINTER_ARRAY_ELEM_WIDTH;\n\t\tlet startY = this.POINTER_ARRAY_ELEM_Y - LINKED_ITEM_Y_DELTA;\n\t\tlet tmp = this.hashTableValues[index];\n\t\twhile (tmp != null) {\n\t\t\ttmp.x = startX;\n\t\t\ttmp.y = startY;\n\t\t\tthis.cmd(act.move, tmp.graphicID, tmp.x, tmp.y);\n\t\t\tstartY = startY - LINKED_ITEM_Y_DELTA;\n\t\t\ttmp = tmp.next;\n\t\t}\n\t}\n\n\tdeleteElement(elem) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Deleting element: ' + elem);\n\t\tconst index = this.doHash(elem);\n\t\tif (this.hashTableValues[index] == null) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\n\t\t\t);\n\t\t\treturn this.commands;\n\t\t}\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.hashTableValues[index].graphicID, 0);\n\t\tif (this.hashTableValues[index].data === elem) {\n\t\t\tif (this.hashTableValues[index].next != null) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.connect,\n\t\t\t\t\tthis.hashTableVisual[index],\n\t\t\t\t\tthis.hashTableValues[index].next.graphicID\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[index], 1);\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.hashTableValues[index].graphicID);\n\t\t\tthis.hashTableValues[index] = this.hashTableValues[index].next;\n\t\t\tthis.repositionList(index);\n\t\t\treturn this.commands;\n\t\t}\n\t\tlet tmpPrev = this.hashTableValues[index];\n\t\tlet tmp = this.hashTableValues[index].next;\n\t\tlet found = false;\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\tif (tmp.data === elem) {\n\t\t\t\tfound = true;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.ExplainLabel,\n\t\t\t\t\t'Deleting element: ' + elem + '  Element deleted'\n\t\t\t\t);\n\t\t\t\tif (tmp.next != null) {\n\t\t\t\t\tthis.cmd(act.connect, tmpPrev.graphicID, tmp.next.graphicID);\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(act.setNull, tmpPrev.graphicID, 1);\n\t\t\t\t}\n\t\t\t\ttmpPrev.next = tmpPrev.next.next;\n\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\tthis.repositionList(index);\n\t\t\t} else {\n\t\t\t\ttmpPrev = tmp;\n\t\t\t\ttmp = tmp.next;\n\t\t\t}\n\t\t}\n\t\tif (!found) {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\tthis.ExplainLabel,\n\t\t\t\t'Deleting element: ' + elem + '  Element not in table'\n\t\t\t);\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tfindElement(elem) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem);\n\n\t\tconst index = this.doHash(elem);\n\t\tconst compareIndex = this.nextIndex++;\n\t\tlet found = false;\n\t\tlet tmp = this.hashTableValues[index];\n\t\tthis.cmd(act.createLabel, compareIndex, '', 10, 40, 0);\n\t\twhile (tmp != null && !found) {\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 1);\n\t\t\tif (tmp.data === elem) {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.data + '==' + elem);\n\t\t\t\tfound = true;\n\t\t\t} else {\n\t\t\t\tthis.cmd(act.setText, compareIndex, tmp.data + '!=' + elem);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setHighlight, tmp.graphicID, 0);\n\t\t\ttmp = tmp.next;\n\t\t}\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem + '  Found!');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, this.ExplainLabel, 'Finding Element: ' + elem + '  Not Found!');\n\t\t}\n\t\tthis.cmd(act.delete, compareIndex);\n\t\tthis.nextIndex--;\n\t\treturn this.commands;\n\t}\n\n\tsetup() {\n\t\tthis.hashTableVisual = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableIndices = new Array(HASH_TABLE_SIZE);\n\t\tthis.hashTableValues = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.indexXPos = new Array(HASH_TABLE_SIZE);\n\t\tthis.indexYPos = new Array(HASH_TABLE_SIZE);\n\n\t\tthis.ExplainLabel = this.nextIndex++;\n\n\t\tthis.table_size = HASH_TABLE_SIZE;\n\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < HASH_TABLE_SIZE; i++) {\n\t\t\tlet nextID = this.nextIndex++;\n\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tnextID,\n\t\t\t\t'',\n\t\t\t\tPOINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tPOINTER_ARRAY_ELEM_HEIGHT,\n\t\t\t\tPOINTER_ARRAY_ELEM_START_X + i * POINTER_ARRAY_ELEM_WIDTH,\n\t\t\t\tthis.POINTER_ARRAY_ELEM_Y\n\t\t\t);\n\t\t\tthis.hashTableVisual[i] = nextID;\n\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\n\t\t\tnextID = this.nextIndex++;\n\t\t\tthis.hashTableIndices[i] = nextID;\n\t\t\tthis.indexXPos[i] = POINTER_ARRAY_ELEM_START_X + i * POINTER_ARRAY_ELEM_WIDTH;\n\t\t\tthis.indexYPos[i] = this.POINTER_ARRAY_ELEM_Y + POINTER_ARRAY_ELEM_HEIGHT;\n\t\t\tthis.hashTableValues[i] = null;\n\n\t\t\tthis.cmd(act.createLabel, nextID, i, this.indexXPos[i], this.indexYPos[i]);\n\t\t\tthis.cmd(act.setForegroundColor, nextID, INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, this.ExplainLabel, '', 10, 25, 0);\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t\tthis.resetIndex = this.nextIndex;\n\t}\n\n\tresetAll() {\n\t\tlet tmp;\n\t\tthis.commands = super.resetAll();\n\t\tfor (let i = 0; i < this.hashTableValues.length; i++) {\n\t\t\ttmp = this.hashTableValues[i];\n\t\t\tif (tmp != null) {\n\t\t\t\twhile (tmp != null) {\n\t\t\t\t\tthis.cmd(act.delete, tmp.graphicID);\n\t\t\t\t\ttmp = tmp.next;\n\t\t\t\t}\n\t\t\t\tthis.hashTableValues[i] = null;\n\t\t\t\tthis.cmd(act.setNull, this.hashTableVisual[i], 1);\n\t\t\t}\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\t// NEED TO OVERRIDE IN PARENT\n\treset() {\n\t\tfor (let i = 0; i < this.table_size; i++) {\n\t\t\tthis.hashTableValues[i] = null;\n\t\t}\n\t\tthis.nextIndex = this.resetIndex;\n\t\tsuper.reset();\n\t}\n\n\tresetCallback() {}\n\n\t/*this.nextIndex = 0;\n this.commands = [];\n this.cmd(act.createLabel, 0, \"\", 20, 50, 0);\n this.animationManager.startNewAnimation(this.commands);\n this.animationManager.skipForward();\n this.animationManager.clearHistory(); */\n\n\tdisableUI() {\n\t\tsuper.disableUI();\n\t}\n\n\tenableUI() {\n\t\tsuper.enableUI();\n\t}\n}\n\nclass LinkedListNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.graphicID = id;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.next = null;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRRAY_ELEMS_PER_LINE = 15;\nconst ARRAY_LINE_SPACING = 130;\n\nconst HEAD_POS_X = 180;\nconst HEAD_POS_Y = 100;\nconst HEAD_LABEL_X = 130;\nconst HEAD_LABEL_Y = 100;\n\nconst TAIL_POS_X = 280;\nconst TAIL_POS_Y = 100;\nconst TAIL_LABEL_X = 230;\nconst TAIL_LABEL_Y = 100;\n\nconst QUEUE_LABEL_X = 50;\nconst QUEUE_LABEL_Y = 30;\nconst QUEUE_ELEMENT_X = 120;\nconst QUEUE_ELEMENT_Y = 30;\n\nconst INDEX_COLOR = '#0000FF';\n\nconst SIZE = 15;\n\nexport default class QueueArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.headID = this.nextIndex++;\n\t\tconst headLabelID = this.nextIndex++;\n\t\tthis.tailID = this.nextIndex++;\n\t\tconst tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.head = 0;\n\t\tthis.tail = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], INDEX_COLOR);\n\t\t}\n\t\tthis.cmd(act.createLabel, headLabelID, 'Head', HEAD_LABEL_X, HEAD_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tHEAD_POS_X,\n\t\t\tHEAD_POS_Y\n\t\t);\n\n\t\tthis.cmd(act.createLabel, tailLabelID, 'Tail', TAIL_LABEL_X, TAIL_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tTAIL_POS_Y\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.initialIndex = this.nextIndex;\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tenqueueCallback() {\n\t\tif ((this.tail + 1) % SIZE !== this.head && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.tail !== this.head) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToEnqueue) {\n\t\tthis.commands = [];\n\n\t\tconst labEnqueueID = this.nextIndex++;\n\t\tconst labEnqueueValID = this.nextIndex++;\n\t\tthis.arrayData[this.tail] = elemToEnqueue;\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labEnqueueID, 'Enqueuing Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labEnqueueValID, elemToEnqueue, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, TAIL_POS_X, TAIL_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.tail % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.tail / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labEnqueueValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[this.tail], elemToEnqueue);\n\t\tthis.cmd(act.delete, labEnqueueValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.tailID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.tail = (this.tail + 1) % SIZE;\n\t\tthis.cmd(act.setText, this.tailID, this.tail);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.tailID, 0);\n\t\tthis.cmd(act.delete, labEnqueueID);\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labDequeueID = this.nextIndex++;\n\t\tconst labDequeueValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labDequeueID, 'Dequeued Value: ', QUEUE_LABEL_X, QUEUE_LABEL_Y);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, INDEX_COLOR, HEAD_POS_X, HEAD_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.head % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.head / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tconst dequeuedVal = this.arrayData[this.head];\n\t\tthis.cmd(act.createLabel, labDequeueValID, dequeuedVal, xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.head], '');\n\t\tthis.cmd(act.move, labDequeueValID, QUEUE_ELEMENT_X, QUEUE_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setHighlight, this.headID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.head = (this.head + 1) % SIZE;\n\t\tthis.cmd(act.setText, this.headID, this.head);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.headID, 0);\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + dequeuedVal);\n\n\t\tthis.cmd(act.delete, labDequeueID);\n\t\tthis.cmd(act.delete, labDequeueValID);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.head = 0;\n\t\tthis.tail = 0;\n\t\tthis.cmd(act.setText, this.headID, '0');\n\t\tthis.cmd(act.setText, this.tailID, '0');\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst TAIL_POS_X = 180;\nconst TAIL_LABEL_X = 130;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class QueueLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.tail_pos_y = h - LINKED_LIST_ELEM_HEIGHT;\n\t\tthis.tail_label_y = this.tail_pos_y;\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.enqueueField = addControlToAlgorithmBar('Text', '');\n\t\tthis.enqueueField.onkeydown = this.returnSubmit(\n\t\t\tthis.enqueueField,\n\t\t\tthis.enqueueCallback.bind(this),\n\t\t\t4\n\t\t);\n\n\t\tthis.enqueueButton = addControlToAlgorithmBar('Button', 'Enqueue');\n\t\tthis.enqueueButton.onclick = this.enqueueCallback.bind(this);\n\t\tthis.controls.push(this.enqueueField);\n\t\tthis.controls.push(this.enqueueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.dequeueButton = addControlToAlgorithmBar('Button', 'Dequeue');\n\t\tthis.dequeueButton.onclick = this.dequeueCallback.bind(this);\n\t\tthis.controls.push(this.dequeueButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.headID = this.nextIndex++;\n\t\tthis.headLabelID = this.nextIndex++;\n\n\t\tthis.tailID = this.nextIndex++;\n\t\tthis.tailLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.headLabelID, 'Head', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.headID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y\n\t\t);\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\n\t\tthis.cmd(act.createLabel, this.tailLabelID, 'Tail', TAIL_LABEL_X, this.tail_label_y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.tailID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTAIL_POS_X,\n\t\t\tthis.tail_pos_y\n\t\t);\n\t\tthis.cmd(act.setNull, this.tailID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', 5, PUSH_LABEL_Y, 0);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tenqueueCallback() {\n\t\tif (this.top < SIZE && this.enqueueField.value !== '') {\n\t\t\tconst pushVal = this.enqueueField.value;\n\t\t\tthis.enqueueField.value = '';\n\t\t\tthis.implementAction(this.enqueue.bind(this), pushVal);\n\t\t}\n\t}\n\n\tdequeueCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.dequeue.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tenqueue(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tfor (let i = this.top; i > 0; i--) {\n\t\t\tthis.arrayData[i] = this.arrayData[i - 1];\n\t\t\tthis.linkedListElemID[i] = this.linkedListElemID[i - 1];\n\t\t}\n\t\tthis.arrayData[0] = elemToPush;\n\t\tthis.linkedListElemID[0] = this.nextIndex++;\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[0],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1,\n\t\t);\n\n\t\tthis.cmd(act.setNull, this.linkedListElemID[0], 1);\n\t\tthis.cmd(act.createLabel, labPushID, 'Enqueuing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[0], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.headID, 0);\n\t\t\tthis.cmd(act.setNull, this.tailID, 0);\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top]);\n\t\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[this.top]);\n\t\t} else {\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[1], 0);\n\t\t\tthis.cmd(act.connect, this.linkedListElemID[1], this.linkedListElemID[0]);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.tailID, this.linkedListElemID[0]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tdequeue() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Dequeued Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y\n\t\t);\n\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.headID, this.linkedListElemID[this.top - 1]);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\t\tthis.cmd(act.setNull, this.tailID, 1);\n\t\t\tthis.cmd(act.disconnect, this.tailID, this.linkedListElemID[this.top - 1]);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.headID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Dequeued Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.headID, 1);\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nlet worstPivotEnabled = false;\nlet firstPivotEnabled = false;\n\nexport default class QuickSelect extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\taddLabelToAlgorithmBar('kᵗʰ element (1 indexed)');\n\n\t\t// k text field\n\t\tthis.kField = addControlToAlgorithmBar('Text', '');\n\t\tthis.kField.onkeydown = this.returnSubmit(\n\t\t\tthis.kField,\n\t\t\tthis.runCallback.bind(this),\n\t\t\t2,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.kField);\n\n\t\t// Run button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Run');\n\t\tthis.findButton.onclick = this.runCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Toggles\n\t\tthis.togglesGroup = addGroupToAlgorithmBar();\n\t\tthis.worstPivotToggle = addCheckboxToAlgorithmBar(\n\t\t\t'Pick min element as pivot',\n\t\t\tfalse,\n\t\t\tthis.togglesGroup\n\t\t);\n\t\tthis.worstPivotToggle.onclick = this.toggleWorstPivot.bind(this);\n\t\tthis.controls.push(this.worstPivotToggle);\n\t\tthis.firstPivotToggle = addCheckboxToAlgorithmBar(\n\t\t\t'Pick first element as pivot',\n\t\t\tfalse,\n\t\t\tthis.togglesGroup\n\t\t);\n\t\tthis.firstPivotToggle.onclick = this.toggleFirstPivot.bind(this);\n\t\tthis.controls.push(this.firstPivotToggle);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t}\n\n\trunCallback() {\n\t\tif (this.listField.value !== '' && this.kField.value !== '') {\n\t\t\tconst listStr = this.listField.value;\n\t\t\tconst list = listStr\n\t\t\t\t.split(',')\n\t\t\t\t.map(Number)\n\t\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t\t.slice(0, 18);\n\t\t\tconst k = this.kField.value;\n\t\t\tif (k > 0 && k <= list.length) {\n\t\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\t\tthis.listField.value = '';\n\t\t\t\tthis.kField.value = '';\n\t\t\t\tthis.implementAction(this.run.bind(this), listStr, k);\n\t\t\t}\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\treturn this.commands;\n\t}\n\n\trun(list, k) {\n\t\tthis.commands = [];\n\n\t\tthis.k = Number(k);\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = list\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\treturn;\n\t\t}\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tif (worstPivotEnabled) {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (firstPivotEnabled) {\n\t\t\tpivot = left;\n\t\t} else {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.swapPivot(pivot, left);\n\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\twhile (i <= j) {\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\ti++;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.swap(i, j);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t}\n\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tif (this.k - 1 === j) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t} else {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#4DA6ff');\n\t\t\tthis.cmd(act.step);\n\n\t\t\tif (this.k - 1 < j) {\n\t\t\t\tthis.helper(left, j - 1);\n\t\t\t} else {\n\t\t\t\tthis.helper(j + 1, right);\n\t\t\t}\n\t\t}\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\ttoggleWorstPivot() {\n\t\tworstPivotEnabled = !worstPivotEnabled;\n\t\tif (firstPivotEnabled) {\n\t\t\tfirstPivotEnabled = false;\n\t\t\tthis.firstPivotToggle.checked = false;\n\t\t}\n\t}\n\n\ttoggleFirstPivot() {\n\t\tfirstPivotEnabled = !firstPivotEnabled;\n\t\tif (worstPivotEnabled) {\n\t\t\tworstPivotEnabled = false;\n\t\t\tthis.worstPivotToggle.checked = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddCheckboxToAlgorithmBar,\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar,\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nlet worstPivotEnabled = false;\nlet firstPivotEnabled = false;\n\nexport default class QuickSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Toggles\n\t\tthis.togglesGroup = addGroupToAlgorithmBar();\n\t\tthis.worstPivotToggle = addCheckboxToAlgorithmBar(\n\t\t\t'Pick min element as pivot',\n\t\t\tfalse,\n\t\t\tthis.togglesGroup\n\t\t);\n\t\tthis.worstPivotToggle.onclick = this.toggleWorstPivot.bind(this);\n\t\tthis.controls.push(this.worstPivotToggle);\n\t\tthis.firstPivotToggle = addCheckboxToAlgorithmBar(\n\t\t\t'Pick first element as pivot',\n\t\t\tfalse,\n\t\t\tthis.togglesGroup\n\t\t);\n\t\tthis.firstPivotToggle.onclick = this.toggleFirstPivot.bind(this);\n\t\tthis.controls.push(this.firstPivotToggle);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.displayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.iPointerID = 0;\n\t\tthis.jPointerID = 0;\n\t\tthis.pPointerID = 0;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => x)\n\t\t\t.slice(0, 18);\n\t\tthis.displayData = new Array(this.arrayData.length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < this.arrayData.length; i++) {\n\t\t\tthis.arrayData[i] = parseInt(this.arrayData[i]);\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t\tthis.pPointerID = this.nextIndex++;\n\t\tthis.helper(0, this.arrayData.length - 1);\n\n\t\treturn this.commands;\n\t}\n\n\thelper(left, right) {\n\t\tif (left > right) return;\n\n\t\t// Hightlight cells in the current sub-array\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#99CCFF');\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tif (left === right) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[left], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t\treturn;\n\t\t}\n\n\t\t// Create pivot pointer and swap with left-most element\n\t\t// To make things more interesting (and clearer), we don't pick the left-most element as pivot\n\t\tlet pivot;\n\t\tif (worstPivotEnabled) {\n\t\t\tlet min = left;\n\t\t\tfor (let i = left + 1; i <= right; i++) {\n\t\t\t\tif (this.arrayData[i] < this.arrayData[min]) {\n\t\t\t\t\tmin = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpivot = min;\n\t\t} else if (firstPivotEnabled) {\n\t\t\tpivot = left;\n\t\t} else {\n\t\t\tpivot = Math.floor(Math.random() * (right - left)) + left + 1;\n\t\t}\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.pPointerID, '#FFFF00', pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.swapPivot(pivot, left);\n\n\t\t// Partition\n\t\tlet i = left + 1;\n\t\tlet j = right;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createHighlightCircle, this.iPointerID, '#0000FF', iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.createHighlightCircle, this.jPointerID, '#0000FF', jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\twhile (i <= j) {\n\t\t\twhile (i <= j && this.arrayData[left] >= this.arrayData[i]) {\n\t\t\t\ti++;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\twhile (i <= j && this.arrayData[left] <= this.arrayData[j]) {\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#FF0000');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i <= j) {\n\t\t\t\tthis.swap(i, j);\n\t\t\t\ti++;\n\t\t\t\tj--;\n\t\t\t\tthis.movePointers(i, j);\n\t\t\t}\n\t\t}\n\n\t\t// Move pivot back and delete pivot pointer\n\t\tthis.swapPivot(left, j, true);\n\n\t\t// Delete i and j pointers\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.delete, this.pPointerID);\n\t\tthis.cmd(act.step);\n\n\t\t// Un-hightlight cells in sub-array and set pivot cell to green\n\t\tfor (let i = left; i <= right; i++) {\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#FFFFFF');\n\t\t}\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[j], '#2ECC71');\n\t\tthis.cmd(act.step);\n\n\t\tthis.helper(left, j - 1);\n\t\tthis.helper(j + 1, right);\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, ARRAY_START_Y);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswapPivot(pivot, other, moveJ) {\n\t\tif (pivot === other) return;\n\t\t// Create temporary labels and remove text in array\n\t\tconst lLabelID = this.nextIndex++;\n\t\tconst lXPos = other * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, lLabelID, this.displayData[other], lXPos, ARRAY_START_Y);\n\t\tconst pLabelID = this.nextIndex++;\n\t\tconst pXPos = pivot * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, pLabelID, this.displayData[pivot], pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[other], '');\n\t\tthis.cmd(act.setText, this.arrayID[pivot], '');\n\t\t// Move labels and pivot pointer\n\t\tthis.cmd(act.move, pLabelID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, this.pPointerID, lXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, lLabelID, pXPos, ARRAY_START_Y);\n\t\tmoveJ && this.cmd(act.move, this.jPointerID, pXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array, and delete temporary labels and pointer\n\t\tthis.cmd(act.setText, this.arrayID[other], this.displayData[pivot]);\n\t\tthis.cmd(act.setText, this.arrayID[pivot], this.displayData[other]);\n\t\tthis.cmd(act.delete, pLabelID);\n\t\tthis.cmd(act.delete, lLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[pivot];\n\t\tthis.arrayData[pivot] = this.arrayData[other];\n\t\tthis.arrayData[other] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[pivot];\n\t\tthis.displayData[pivot] = this.displayData[other];\n\t\tthis.displayData[other] = temp;\n\t}\n\n\tswap(i, j) {\n\t\t// Create temporary labels and remove text in array\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, ARRAY_START_Y);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\t// Move labels\n\t\tthis.cmd(act.move, iLabelID, jXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.move, jLabelID, iXPos, ARRAY_START_Y);\n\t\tthis.cmd(act.step);\n\t\t// Set text in array and delete temporary labels\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t//Swap data in backend display data\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t\t// Reset pointer colors back to blue\n\t\tthis.cmd(act.setForegroundColor, this.iPointerID, '#0000FF');\n\t\tthis.cmd(act.setForegroundColor, this.jPointerID, '#0000FF');\n\t\tthis.cmd(act.step);\n\t}\n\n\ttoggleWorstPivot() {\n\t\tworstPivotEnabled = !worstPivotEnabled;\n\t\tif (firstPivotEnabled) {\n\t\t\tfirstPivotEnabled = false;\n\t\t\tthis.firstPivotToggle.checked = false;\n\t\t}\n\t}\n\n\ttoggleFirstPivot() {\n\t\tfirstPivotEnabled = !firstPivotEnabled;\n\t\tif (worstPivotEnabled) {\n\t\t\tworstPivotEnabled = false;\n\t\t\tthis.worstPivotToggle.checked = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 30;\n\nconst MAX_LENGTH = 22;\n\n// const LOWER_A_CHAR_CODE = 97;\n\nconst BASE_LABEL_Y = 45;\nconst CHARACTER_VALUES_LABEL_Y = 60;\nconst TEXT_HASH_LABEL_START_Y = 100;\nconst PATTERN_HASH_LABEL_START_Y = 115;\n\nexport default class RabinKarp extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Text');\n\n\t\t// Text text field\n\t\tthis.textField = addControlToAlgorithmBar('Text', '');\n\t\tthis.textField.onkeydown = this.returnSubmit(\n\t\t\tthis.textField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.textField);\n\n\t\taddLabelToAlgorithmBar('Pattern');\n\n\t\t// Pattern text field\n\t\tthis.patternField = addControlToAlgorithmBar('Text', '');\n\t\tthis.patternField.onkeydown = this.returnSubmit(\n\t\t\tthis.patternField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\tMAX_LENGTH,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.patternField);\n\n\t\t// Find button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.textRowID = [];\n\t\tthis.comparisonMatrixID = [];\n\t\tthis.baseLabelID = this.nextIndex++;\n\t\tthis.characterValuesLabelID = this.nextIndex++;\n\t\tthis.textHashLabelID = this.nextIndex++;\n\t\tthis.textHashCalculationID = this.nextIndex++;\n\t\tthis.patternHashLabelID = this.nextIndex++;\n\t\tthis.patternHashCalculationID = this.nextIndex++;\n\t}\n\n\tfindCallback() {\n\t\tif (\n\t\t\tthis.textField.value !== '' &&\n\t\t\tthis.patternField.value !== '' &&\n\t\t\tthis.textField.value.length >= this.patternField.value.length\n\t\t) {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst text = this.textField.value;\n\t\t\tconst pattern = this.patternField.value;\n\t\t\tthis.textField.value = '';\n\t\t\tthis.patternField.value = '';\n\t\t\tthis.implementAction(this.find.bind(this), text, pattern);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tfind(text, pattern) {\n\t\tthis.commands = [];\n\n\t\t// Filter non-letters from string and make lower case\n\t\ttext = text\n\t\t\t.replace(/[^a-zA-Z]/g, '')\n\t\t\t.toLowerCase();\n\t\tpattern = pattern\n\t\t\t.replace(/[^a-zA-Z]/g, '')\n\t\t\t.toLowerCase();\n\n\t\tconst maxRows = text.length - pattern.length + 1;\n\t\tif (maxRows <= 14) {\n\t\t\tthis.cellSize = 30;\n\t\t} else if (maxRows <= 17) {\n\t\t\tthis.cellSize = 25;\n\t\t} else {\n\t\t\tthis.cellSize = 20;\n\t\t}\n\n\t\tthis.textRowID = new Array(text.length);\n\t\tthis.comparisonMatrixID = new Array(maxRows);\n\t\tfor (let i = 0; i < maxRows; i++) {\n\t\t\tthis.comparisonMatrixID[i] = new Array(text.length);\n\t\t}\n\n\t\tlet xpos, ypos;\n\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\typos = ARRAY_START_Y;\n\t\t\tthis.textRowID[i] = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.nextIndex,\n\t\t\t\ttext.charAt(i),\n\t\t\t\tthis.cellSize,\n\t\t\t\tthis.cellSize,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex++, '#D3D3D3');\n\t\t}\n\n\t\tfor (let row = 0; row < maxRows; row++) {\n\t\t\tfor (let col = 0; col < text.length; col++) {\n\t\t\t\txpos = col * this.cellSize + ARRAY_START_X;\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.comparisonMatrixID[row][col] = this.nextIndex;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createRectangle,\n\t\t\t\t\tthis.nextIndex++,\n\t\t\t\t\t'',\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\tthis.cellSize,\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst labelsX = ARRAY_START_X + text.length * this.cellSize + 10;\n\t\tthis.cmd(act.createLabel, this.baseLabelID, 'Base constant = 1', labelsX, BASE_LABEL_Y, 0);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.characterValuesLabelID,\n\t\t\t'Character values: a = 0, b = 1, ..., z = 25',\n\t\t\tlabelsX,\n\t\t\tCHARACTER_VALUES_LABEL_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashLabelID,\n\t\t\t'Text hash:',\n\t\t\tlabelsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashLabelID,\n\t\t\t'Pattern hash:',\n\t\t\tlabelsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0\n\t\t);\n\n\t\tlet textCalculation = '';\n\t\tlet textHash = 0;\n\t\tlet patternCalculation = '';\n\t\tlet patternHash = 0;\n\t\tfor (let i = 0; i < pattern.length; i++) {\n\t\t\ttextHash += text.charCodeAt(i) - 97;\n\t\t\ttextCalculation += text.charAt(i) + ' + ';\n\t\t\tpatternHash += pattern.charCodeAt(i) - 97;\n\t\t\tpatternCalculation += pattern.charAt(i) + ' + ';\n\t\t}\n\t\ttextCalculation =\n\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\tpatternCalculation =\n\t\t\tpatternCalculation.substring(0, patternCalculation.length - 2) + ' = ' + patternHash;\n\t\tconst calculationsX = ARRAY_START_X + text.length * this.cellSize + 100;\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.textHashCalculationID,\n\t\t\ttextCalculation,\n\t\t\tcalculationsX,\n\t\t\tTEXT_HASH_LABEL_START_Y,\n\t\t\t0\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tthis.patternHashCalculationID,\n\t\t\tpatternCalculation,\n\t\t\tcalculationsX,\n\t\t\tPATTERN_HASH_LABEL_START_Y,\n\t\t\t0\n\t\t);\n\n\t\tconst iPointerID = this.nextIndex++;\n\t\tconst jPointerID = this.nextIndex++;\n\n\t\tlet row = 0;\n\t\tfor (let i = 0; i <= text.length - pattern.length; i++) {\n\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\tthis.comparisonMatrixID[row][k],\n\t\t\t\t\tpattern.charAt(k - i),\n\t\t\t\t\txpos,\n\t\t\t\t\typos\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.cmd(act.step);\n\t\t\tif (patternHash === textHash) {\n\t\t\t\txpos = i * this.cellSize + ARRAY_START_X;\n\t\t\t\tthis.cmd(act.createHighlightCircle, iPointerID, '#0000FF', xpos, ARRAY_START_Y);\n\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\tthis.cmd(act.createHighlightCircle, jPointerID, '#0000FF', xpos, ypos);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tlet j = 0;\n\t\t\t\twhile (j < pattern.length && pattern.charAt(j) === text.charAt(i + j)) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#2ECC71');\n\t\t\t\t\tj++;\n\t\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\t\txpos = (i + j) * this.cellSize + ARRAY_START_X;\n\t\t\t\t\t\tthis.cmd(act.move, iPointerID, xpos, ARRAY_START_Y);\n\t\t\t\t\t\typos = (row + 1) * this.cellSize + ARRAY_START_Y;\n\t\t\t\t\t\tthis.cmd(act.move, jPointerID, xpos, ypos);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (j !== pattern.length) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][i + j], '#E74C3C');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.delete, iPointerID);\n\t\t\t\tthis.cmd(act.delete, jPointerID);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t} else {\n\t\t\t\tfor (let k = i; k < i + pattern.length; k++) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.comparisonMatrixID[row][k], '#FFFF4D');\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t\tif (i < text.length - pattern.length) {\n\t\t\t\ttextHash =\n\t\t\t\t\ttextHash -\n\t\t\t\t\t(text.charCodeAt(i) - 97) +\n\t\t\t\t\t(text.charCodeAt(i + pattern.length) - 97);\n\t\t\t\ttextCalculation = '';\n\t\t\t\tfor (let k = 0; k < pattern.length; k++) {\n\t\t\t\t\ttextCalculation += text.charAt(k + i + 1) + ' + ';\n\t\t\t\t}\n\t\t\t\ttextCalculation =\n\t\t\t\t\ttextCalculation.substring(0, textCalculation.length - 2) + ' = ' + textHash;\n\t\t\t\tthis.cmd(act.setText, this.textHashCalculationID, textCalculation);\n\t\t\t}\n\t\t\trow++;\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tif (this.textRowID.length !== 0) {\n\t\t\tthis.cmd(act.delete, this.baseLabelID);\n\t\t\tthis.cmd(act.delete, this.characterValuesLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashLabelID);\n\t\t\tthis.cmd(act.delete, this.textHashCalculationID);\n\t\t\tthis.cmd(act.delete, this.patternHashLabelID);\n\t\t\tthis.cmd(act.delete, this.patternHashCalculationID);\n\t\t}\n\t\tfor (let i = 0; i < this.textRowID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.textRowID[i]);\n\t\t}\n\t\tthis.textRowID = [];\n\t\tfor (let i = 0; i < this.comparisonMatrixID.length; i++) {\n\t\t\tfor (let j = 0; j < this.comparisonMatrixID[i].length; j++) {\n\t\t\t\tthis.cmd(act.delete, this.comparisonMatrixID[i][j]);\n\t\t\t}\n\t\t}\n\t\tthis.comparisonMatrixID = [];\n\n\t\treturn this.commands;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addLabelToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\n// const ARRRAY_ELEMS_PER_LINE = 15;\n// const ARRAY_LINE_SPACING = 130;\n\n// const TOP_POS_X = 180;\n// const TOP_POS_Y = 100;\n// const TOP_LABEL_X = 130;\n// const TOP_LABEL_Y = 100;\n\n// const PUSH_LABEL_X = 50;\n// const PUSH_LABEL_Y = 30;\n// const PUSH_ELEMENT_X = 120;\n// const PUSH_ELEMENT_Y = 30;\n\n// const SIZE = 10;\n\nexport default class SelectionSort extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\taddLabelToAlgorithmBar('Comma separated list (e.g. \"3,1,2\", max 18 elements)');\n\n\t\t// List text field\n\t\tthis.listField = addControlToAlgorithmBar('Text', '');\n\t\tthis.listField.onkeydown = this.returnSubmit(\n\t\t\tthis.listField,\n\t\t\tthis.sortCallback.bind(this),\n\t\t\t60,\n\t\t\tfalse\n\t\t);\n\t\tthis.controls.push(this.listField);\n\n\t\t// Sort button\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Sort');\n\t\tthis.findButton.onclick = this.sortCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tsetup() {\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation();\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\tthis.iPointerID = this.nextIndex++;\n\t\tthis.jPointerID = this.nextIndex++;\n\t}\n\n\tsortCallback() {\n\t\tif (this.listField.value !== '') {\n\t\t\tthis.implementAction(this.clear.bind(this));\n\t\t\tconst list = this.listField.value;\n\t\t\tthis.listField.value = '';\n\t\t\tthis.implementAction(this.sort.bind(this), list);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.arrayID.length; i++) {\n\t\t\tthis.cmd(act.delete, this.arrayID[i]);\n\t\t}\n\t\tthis.arrayData = [];\n\t\tthis.arrayID = [];\n\t\tthis.displayData = [];\n\t\treturn this.commands;\n\t}\n\n\tsort(params) {\n\t\tthis.commands = [];\n\n\t\tthis.arrayID = [];\n\t\tthis.arrayData = params\n\t\t\t.split(',')\n\t\t\t.map(Number)\n\t\t\t.filter(x => !Number.isNaN(x))\n\t\t\t.slice(0, 18);\n\t\tconst length = this.arrayData.length;\n\t\tthis.displayData = new Array(length);\n\n\t\tconst elemCounts = new Map();\n\t\tconst letterMap = new Map();\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst count = elemCounts.has(this.arrayData[i]) ? elemCounts.get(this.arrayData[i]) : 0;\n\t\t\tif (count > 0) {\n\t\t\t\tletterMap.set(this.arrayData[i], 'a');\n\t\t\t}\n\t\t\telemCounts.set(this.arrayData[i], count + 1);\n\t\t}\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tconst xpos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = ARRAY_START_Y;\n\n\t\t\tlet displayData = this.arrayData[i].toString();\n\t\t\tif (letterMap.has(this.arrayData[i])) {\n\t\t\t\tconst currChar = letterMap.get(this.arrayData[i]);\n\t\t\t\tdisplayData += currChar;\n\t\t\t\tletterMap.set(this.arrayData[i], String.fromCharCode(currChar.charCodeAt(0) + 1));\n\t\t\t}\n\t\t\tthis.displayData[i] = displayData;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\tdisplayData,\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t}\n\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.iPointerID,\n\t\t\t'#FF0000',\n\t\t\tARRAY_START_X,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.iPointerID, 1);\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\tthis.jPointerID,\n\t\t\t'#0000FF',\n\t\t\tARRAY_START_X + ARRAY_ELEM_WIDTH,\n\t\t\tARRAY_START_Y\n\t\t);\n\t\tthis.cmd(act.setHighlight, this.jPointerID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tfor (let i = 0; i < this.arrayData.length - 1; i++) {\n\t\t\tlet smallest = i;\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[smallest], '#FFFF00');\n\t\t\tfor (let j = i + 1; j < this.arrayData.length; j++) {\n\t\t\t\tthis.movePointers(smallest, j);\n\t\t\t\tif (this.arrayData[j] < this.arrayData[smallest]) {\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[smallest], '#FFFFFF');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tsmallest = j;\n\t\t\t\t\tthis.movePointers(smallest, j);\n\t\t\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[smallest], '#FFFF00');\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.swap(i, smallest);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[smallest], '#FFFFFF');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setBackgroundColor, this.arrayID[i], '#2ECC71');\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\tthis.cmd(act.delete, this.iPointerID);\n\t\tthis.cmd(act.delete, this.jPointerID);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setBackgroundColor, this.arrayID[this.arrayID.length - 1], '#2ECC71');\n\n\t\treturn this.commands;\n\t}\n\n\tmovePointers(i, j) {\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.iPointerID, iXPos, iYPos);\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.move, this.jPointerID, jXPos, jYPos);\n\t\tthis.cmd(act.step);\n\t}\n\n\tswap(i, j) {\n\t\tconst iLabelID = this.nextIndex++;\n\t\tconst iXPos = i * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst iYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, iLabelID, this.displayData[i], iXPos, iYPos);\n\t\tconst jLabelID = this.nextIndex++;\n\t\tconst jXPos = j * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst jYPos = ARRAY_START_Y;\n\t\tthis.cmd(act.createLabel, jLabelID, this.displayData[j], jXPos, jYPos);\n\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\tthis.cmd(act.setText, this.arrayID[j], '');\n\t\tthis.cmd(act.move, iLabelID, jXPos, jYPos);\n\t\tthis.cmd(act.move, jLabelID, iXPos, iYPos);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.arrayID[i], this.displayData[j]);\n\t\tthis.cmd(act.setText, this.arrayID[j], this.displayData[i]);\n\t\tthis.cmd(act.delete, iLabelID);\n\t\tthis.cmd(act.delete, jLabelID);\n\t\t// Swap data in backend array\n\t\tlet temp = this.arrayData[i];\n\t\tthis.arrayData[i] = this.arrayData[j];\n\t\tthis.arrayData[j] = temp;\n\t\t// Swap data in display array\n\t\ttemp = this.displayData[i];\n\t\tthis.displayData[i] = this.displayData[j];\n\t\tthis.displayData[j] = temp;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, {\n\taddControlToAlgorithmBar,\n\taddDivisorToAlgorithmBar,\n\taddGroupToAlgorithmBar,\n\taddLabelToAlgorithmBar\n} from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst SKIP_LIST_START_X = 100;\nconst SKIP_LIST_START_Y = 400;\nconst SKIP_LIST_ELEM_SIZE = 40;\n\nconst SKIP_LIST_SPACING = 80;\n\nconst VALUE_LABEL_X = 50;\nconst VALUE_LABEL_Y = 23;\nconst VALUE_STRING_X = 120;\nconst VALUE_STRING_Y = 23;\n\nconst CF_LABEL_X = 50;\nconst CF_LABEL_Y = 37;\nconst CF_STRING_X = 120;\nconst CF_STRING_Y = 37;\n\nconst NINF = '\\u2212\\u221E'; // Negative infinity\nconst PINF = '\\u221E'; // Positive infinity\n\nexport default class SkipList extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.setup();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tconst verticalGroup = addGroupToAlgorithmBar(false);\n\t\tconst topHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\t\tconst bottomHorizontalGroup = addGroupToAlgorithmBar(true, verticalGroup);\n\n\t\taddLabelToAlgorithmBar('Add', topHorizontalGroup);\n\n\t\t// Add's value text field\n\t\tthis.addValueField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.addValueField.onkeydown = this.returnSubmit(\n\t\t\tthis.addValueField,\n\t\t\tthis.addRandomlyCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.addValueField);\n\n\t\taddLabelToAlgorithmBar('with', topHorizontalGroup);\n\n\t\t// Heads' text field\n\t\tthis.headsField = addControlToAlgorithmBar('Text', '', topHorizontalGroup);\n\t\tthis.headsField.onkeydown = this.returnSubmit(\n\t\t\tthis.headsField,\n\t\t\tthis.addWithHeadsCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.headsField);\n\n\t\taddLabelToAlgorithmBar('heads', topHorizontalGroup);\n\n\t\t// Add randomly button\n\t\tthis.addRandomlyButton = addControlToAlgorithmBar('Button', 'Add randomly', bottomHorizontalGroup);\n\t\tthis.addRandomlyButton.onclick = this.addRandomlyCallback.bind(this);\n\t\tthis.controls.push(this.addRandomlyButton);\n\n\t\taddLabelToAlgorithmBar('or', bottomHorizontalGroup);\n\n\t\t// Add with heads button\n\t\tthis.addWithHeadsButton = addControlToAlgorithmBar('Button', 'Add with heads', bottomHorizontalGroup);\n\t\tthis.addWithHeadsButton.onclick = this.addWithHeadsCallback.bind(this);\n\t\tthis.controls.push(this.addWithHeadsButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Remove's text field\n\t\tthis.removeField = addControlToAlgorithmBar('Text', '');\n\t\tthis.removeField.onkeydown = this.returnSubmit(\n\t\t\tthis.removeField,\n\t\t\tthis.removeCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.removeField);\n\n\t\t// Remove button\n\t\tthis.removeButton = addControlToAlgorithmBar('Button', 'Remove');\n\t\tthis.removeButton.onclick = this.removeCallback.bind(this);\n\t\tthis.controls.push(this.removeButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Get's index text field\n\t\tthis.getField = addControlToAlgorithmBar('Text', '');\n\t\tthis.getField.onkeydown = this.returnSubmit(\n\t\t\tthis.getField,\n\t\t\tthis.getCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.getField);\n\n\t\t// Get button\n\t\tthis.getButton = addControlToAlgorithmBar('Button', 'Get');\n\t\tthis.getButton.onclick = this.getCallback.bind(this);\n\t\tthis.controls.push(this.getButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\t// Clear button\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.commands = [];\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 0;\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\t}\n\n\taddRandomlyCallback() {\n\t\tif (this.addValueField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal);\n\t\t}\n\t}\n\n\taddWithHeadsCallback() {\n\t\tif (this.addValueField.value !== '' && this.headsField.value !== '') {\n\t\t\tconst addVal = parseInt(this.addValueField.value);\n\t\t\tthis.addValueField.value = '';\n\t\t\tconst heads = parseInt(this.headsField.value);\n\t\t\tthis.headsField.value = '';\n\t\t\tthis.implementAction(this.add.bind(this), addVal, heads);\n\t\t}\n\t}\n\n\tremoveCallback() {\n\t\tif (this.removeField.value !== '') {\n\t\t\tconst value = parseInt(this.removeField.value);\n\t\t\tthis.removeField.value = '';\n\t\t\tthis.implementAction(this.remove.bind(this), value);\n\t\t}\n\t}\n\n\tgetCallback() {\n\t\tif (this.getField.value !== '') {\n\t\t\tconst value = parseInt(this.getField.value);\n\t\t\tthis.getField.value = '';\n\t\t\tthis.implementAction(this.get.bind(this), value);\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tadd(value, heads) {\n\t\tthis.commands = [];\n\n\t\tif (heads === undefined) {\n\t\t\theads = Math.floor(Math.random() * (this.size + 1));\n\t\t}\n\t\theads = Math.min(heads, 4);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tconst cfLabelId = this.nextIndex++;\n\t\tconst cfStringId = this.nextIndex++;\n\n\t\tlet headsString = '';\n\t\tfor (let i = 0; i < heads; i++) {\n\t\t\theadsString += 'H';\n\t\t}\n\t\theadsString += 'T';\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to add:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.createLabel, cfLabelId, 'Coin Flipper:', CF_LABEL_X, CF_LABEL_Y);\n\t\tthis.cmd(act.createLabel, cfStringId, headsString, CF_STRING_X, CF_STRING_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Add levels\n\t\tfor (let row = this.nodeID[0].length; row <= heads; row++) {\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[0][row] = Number.NEGATIVE_INFINITY;\n\t\t\tthis.nodeID[0][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[0][row],\n\t\t\t\tNINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t);\n\t\t\tthis.data[rightPhantomsCol][row] = Number.POSITIVE_INFINITY;\n\t\t\tthis.nodeID[rightPhantomsCol][row] = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createSkipListNode,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\tPINF,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * rightPhantomsCol,\n\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[0][row], this.nodeID[rightPhantomsCol][row], 3);\n\t\t\tthis.cmd(act.connectSkipList, this.nodeID[0][row - 1], this.nodeID[0][row], 0);\n\t\t\tthis.cmd(\n\t\t\t\tact.connectSkipList,\n\t\t\t\tthis.nodeID[rightPhantomsCol][row - 1],\n\t\t\t\tthis.nodeID[rightPhantomsCol][row],\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\n\t\t// Find column where new element will be inserted\n\t\tlet newCol = 1;\n\t\twhile (value > this.data[newCol][0]) {\n\t\t\tnewCol++;\n\t\t}\n\n\t\t// Move IDs and data in next columns to the right\n\t\tfor (let col = this.nodeID.length - 1; col >= newCol; col--) {\n\t\t\tthis.nodeID[col + 1] = this.nodeID[col];\n\t\t\tthis.data[col + 1] = this.data[col];\n\t\t}\n\t\tthis.nodeID[newCol] = [];\n\t\tthis.data[newCol] = [];\n\n\t\t// Traverse and add\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tlet foundDuplicate = false;\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tfoundDuplicate = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\t// Move highlight circle downward\n\t\t\trow--;\n\t\t\tif (row >= 0) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\t// Add nodes bottom-up to the new column if no duplicate has been found\n\t\tif (!foundDuplicate) {\n\t\t\tthis.shiftColumns(newCol);\n\t\t\trow++;\n\t\t\t// Having a highlight circle in the previous ID causes an object to look weird (this\n\t\t\t// seems to be an already existing bug) Creating a random object before it is a workaround\n\t\t\tthis.cmd(act.createCircle, this.nextIndex++, '', -100, -100, 0);\n\n\t\t\twhile (row <= heads) {\n\t\t\t\tthis.data[newCol][row] = value;\n\t\t\t\tthis.nodeID[newCol][row] = this.nextIndex++;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createSkipListNode,\n\t\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\t\tvalue,\n\t\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tconst prevCol = this.getPrevCol(newCol, row);\n\t\t\t\tconst nextCol = this.getNextCol(newCol, row);\n\t\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[nextCol][row]);\n\t\t\t\tthis.cmd(act.connectSkipList, this.nodeID[prevCol][row], this.nodeID[newCol][row], 3);\n\t\t\t\tthis.cmd(act.connectSkipList, this.nodeID[newCol][row], this.nodeID[nextCol][row], 3);\n\t\t\t\tif (row !== 0) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\t\tthis.nodeID[newCol][row - 1],\n\t\t\t\t\t\tthis.nodeID[newCol][row],\n\t\t\t\t\t\t0\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * newCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\trow++;\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, cfLabelId);\n\t\tthis.cmd(act.delete, cfStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\tthis.size++;\n\n\t\treturn this.commands;\n\t}\n\n\tremove(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tconst valueLabelId = this.nextIndex++;\n\t\tconst valueStringId = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, valueLabelId, 'Value to remove:', VALUE_LABEL_X, VALUE_LABEL_Y);\n\t\tthis.cmd(act.createLabel, valueStringId, value, VALUE_STRING_X, VALUE_STRING_Y);\n\t\tthis.cmd(act.step);\n\n\t\t// Traverse and remove\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\tlet removedCol = -1;\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value > this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\tif (value === this.data[nextCol][row]) {\n\t\t\t\tremovedCol = nextCol;\n\t\t\t\tcol = nextCol;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\twhile (row >= 0) {\n\t\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t\t\tconst prevCol = this.getPrevCol(col, row);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[prevCol][row], this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row], this.nodeID[nextCol][row]);\n\t\t\t\t\tif (this.nodeID[col][row + 1] != null) {\n\t\t\t\t\t\tthis.cmd(act.disconnect, this.nodeID[col][row + 1], this.nodeID[col][row]);\n\t\t\t\t\t}\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.connectSkipList,\n\t\t\t\t\t\tthis.nodeID[prevCol][row],\n\t\t\t\t\t\tthis.nodeID[nextCol][row],\n\t\t\t\t\t\t3\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\t\trow--;\n\t\t\t\t\tif (row !== -1) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.move,\n\t\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trow--;\n\t\t\t\tif (row !== -1) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\thighlightID,\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, valueLabelId);\n\t\tthis.cmd(act.delete, valueStringId);\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\tif (removedCol !== -1) {\n\t\t\t// Shift ID and data columns to the left (already erases last column)\n\t\t\tfor (let col = removedCol; col < this.nodeID.length - 1; col++) {\n\t\t\t\tthis.nodeID[col] = this.nodeID[col + 1];\n\t\t\t\tthis.data[col] = this.data[col + 1];\n\t\t\t}\n\t\t\tthis.nodeID.pop();\n\t\t\tthis.data.pop();\n\n\t\t\tthis.shiftColumns(removedCol);\n\t\t}\n\n\t\t// Remove empty rows\n\t\t// Find tallest column of actual values (not phantoms)\n\t\tlet maxHeight = 1;\n\t\tfor (let col = 1; col < this.nodeID.length - 1; col++) {\n\t\t\tmaxHeight = Math.max(maxHeight, this.nodeID[col].length);\n\t\t}\n\t\t// Remove rows above tallest column (so empty rows)\n\t\tfor (let row = this.nodeID[0].length - 1; row >= maxHeight; row--) {\n\t\t\tthis.data[0].pop();\n\t\t\tconst leftPhantomID = this.nodeID[0].pop();\n\t\t\tthis.cmd(act.delete, leftPhantomID);\n\t\t\tconst rightPhantomsCol = this.nodeID.length - 1;\n\t\t\tthis.data[rightPhantomsCol].pop();\n\t\t\tconst rightPhantomID = this.nodeID[rightPhantomsCol].pop();\n\t\t\tthis.cmd(act.delete, rightPhantomID);\n\t\t}\n\t\tthis.cmd(act.step);\n\n\t\tthis.size--;\n\n\t\treturn this.commands;\n\t}\n\n\tget(params) {\n\t\tthis.commands = [];\n\n\t\tconst value = parseInt(params);\n\n\t\tlet col = 0;\n\t\tlet row = this.nodeID[0].length - 1;\n\t\t// let nextCol = this.getNextCol(col, row);\n\n\t\tconst highlightID = this.nextIndex++;\n\t\tthis.cmd(\n\t\t\tact.createHighlightCircle,\n\t\t\thighlightID,\n\t\t\t'#FF0000',\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t);\n\t\tthis.cmd(act.setHighlight, highlightID, 1);\n\t\tthis.cmd(act.step);\n\n\t\twhile (row >= 0 && value !== this.data[col][row]) {\n\t\t\t// Move right until next element is greater or equal\n\t\t\tlet nextCol = this.getNextCol(col, row);\n\t\t\twhile (value >= this.data[nextCol][row]) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * nextCol,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tcol = nextCol;\n\t\t\t\tnextCol = this.getNextCol(col, row);\n\t\t\t}\n\n\t\t\t// Move highlight circle downward if data has not been found\n\t\t\tif (value !== this.data[col][row]) {\n\t\t\t\trow--;\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.move,\n\t\t\t\t\thighlightID,\n\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t}\n\t\t}\n\n\t\tthis.cmd(act.delete, highlightID);\n\n\t\treturn this.commands;\n\t}\n\n\t// Shifts columns on screen\n\tshiftColumns(col) {\n\t\tfor (; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tif (this.nodeID[col][row] != null) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.move,\n\t\t\t\t\t\tthis.nodeID[col][row],\n\t\t\t\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING * col,\n\t\t\t\t\t\tSKIP_LIST_START_Y - SKIP_LIST_SPACING * row\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.cmd(act.step);\n\t}\n\n\t// Gets the column of the next node (\"right pointer\")\n\tgetNextCol(col, row) {\n\t\tcol++;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol++;\n\t\t}\n\t\treturn col;\n\t}\n\n\t// Gets the column of the previous node (\"left pointer\")\n\tgetPrevCol(col, row) {\n\t\tcol--;\n\t\twhile (this.data[col][row] == null) {\n\t\t\tcol--;\n\t\t}\n\t\treturn col;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\n\t\tfor (let col = 0; col < this.nodeID.length; col++) {\n\t\t\tfor (let row = 0; row < this.nodeID[col].length; row++) {\n\t\t\t\tthis.cmd(act.delete, this.nodeID[col][row]);\n\t\t\t}\n\t\t}\n\n\t\tthis.nodeID = [[this.nextIndex++], [this.nextIndex++]];\n\t\tthis.data = [[Number.NEGATIVE_INFINITY], [Number.POSITIVE_INFINITY]];\n\t\tthis.size = 0;\n\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[0][0],\n\t\t\tNINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X,\n\t\t\tSKIP_LIST_START_Y\n\t\t);\n\t\tthis.cmd(\n\t\t\tact.createSkipListNode,\n\t\t\tthis.nodeID[1][0],\n\t\t\tPINF,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_ELEM_SIZE,\n\t\t\tSKIP_LIST_START_X + SKIP_LIST_SPACING,\n\t\t\tSKIP_LIST_START_Y\n\t\t);\n\t\tthis.cmd(act.connectSkipList, this.nodeID[0][0], this.nodeID[1][0], 3);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY David Galles ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINK_COLOR = '#007700';\nconst HIGHLIGHT_CIRCLE_COLOR = '#007700';\nconst FOREGROUND_COLOR = '#007700';\nconst BACKGROUND_COLOR = '#EEFFEE';\nconst PRINT_COLOR = FOREGROUND_COLOR;\n\nconst WIDTH_DELTA = 50;\nconst HEIGHT_DELTA = 50;\nconst STARTING_Y = 50;\n\nconst FIRST_PRINT_POS_X = 50;\nconst PRINT_VERTICAL_GAP = 20;\nconst PRINT_HORIZONTAL_GAP = 50;\n\nexport default class SplayTree extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.startingX = w / 2;\n\t\tthis.first_print_pos_y = h - 2 * PRINT_VERTICAL_GAP;\n\t\tthis.print_max = w - 10;\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.cmd(act.createLabel, 0, '', 20, 10, 0);\n\t\tthis.nextIndex = 1;\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\n\t\tthis.insertField = addControlToAlgorithmBar('Text', '');\n\t\tthis.insertField.onkeydown = this.returnSubmit(\n\t\t\tthis.insertField,\n\t\t\tthis.insertCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.insertField);\n\n\t\tthis.insertButton = addControlToAlgorithmBar('Button', 'Insert');\n\t\tthis.insertButton.onclick = this.insertCallback.bind(this);\n\t\tthis.controls.push(this.insertButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.deleteField = addControlToAlgorithmBar('Text', '');\n\t\tthis.deleteField.onkeydown = this.returnSubmit(\n\t\t\tthis.deleteField,\n\t\t\tthis.deleteCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.deleteField);\n\n\t\tthis.deleteButton = addControlToAlgorithmBar('Button', 'Delete');\n\t\tthis.deleteButton.onclick = this.deleteCallback.bind(this);\n\t\tthis.controls.push(this.deleteButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.findField = addControlToAlgorithmBar('Text', '');\n\t\tthis.findField.onkeydown = this.returnSubmit(\n\t\t\tthis.findField,\n\t\t\tthis.findCallback.bind(this),\n\t\t\t4,\n\t\t\ttrue\n\t\t);\n\t\tthis.controls.push(this.findField);\n\n\t\tthis.findButton = addControlToAlgorithmBar('Button', 'Find');\n\t\tthis.findButton.onclick = this.findCallback.bind(this);\n\t\tthis.controls.push(this.findButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.printButton = addControlToAlgorithmBar('Button', 'Print');\n\t\tthis.printButton.onclick = this.printCallback.bind(this);\n\t\tthis.controls.push(this.printButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\treset() {\n\t\tthis.nextIndex = 1;\n\t\tthis.treeRoot = null;\n\t}\n\n\tinsertCallback() {\n\t\tlet insertedValue = this.insertField.value;\n\t\t// Get text value\n\t\tinsertedValue = this.normalizeNumber(insertedValue, 4);\n\t\tif (insertedValue !== '') {\n\t\t\t// set text value\n\t\t\tthis.insertField.value = '';\n\t\t\tthis.implementAction(this.insertElement.bind(this), parseInt(insertedValue));\n\t\t}\n\t}\n\n\tdeleteCallback() {\n\t\tlet deletedValue = this.deleteField.value;\n\t\tif (deletedValue !== '') {\n\t\t\tdeletedValue = this.normalizeNumber(deletedValue, 4);\n\t\t\tthis.deleteField.value = '';\n\t\t\tthis.implementAction(this.deleteElement.bind(this), parseInt(deletedValue));\n\t\t}\n\t}\n\n\t//  TODO:  This top-down version is broken.  Don't use\n\tsplay(value) {\n\t\tif (this.treeRoot == null) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.treeRoot.data === value) {\n\t\t\treturn true;\n\t\t}\n\t\tif (value < this.treeRoot.data) {\n\t\t\tif (this.treeRoot.left == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.left.data === value) {\n\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value < this.treeRoot.left.data) {\n\t\t\t\tif (this.treeRoot.left.left == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.left.right == null) {\n\t\t\t\t\tthis.singleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateRight(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\treturn false;\n\t\t\t} else if (this.treeRoot.right.data === value) {\n\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\treturn true;\n\t\t\t} else if (value > this.treeRoot.right.data) {\n\t\t\t\tif (this.treeRoot.right.right == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.zigZigLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (this.treeRoot.right.left == null) {\n\t\t\t\t\tthis.singleRotateLeft(this.treeRoot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t} else {\n\t\t\t\t\tthis.doubleRotateLeft(this.treeRot);\n\t\t\t\t\treturn this.splay(value);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprintCallback() {\n\t\tthis.implementAction(this.printTree.bind(this));\n\t}\n\n\tprintTree() {\n\t\tthis.commands = [];\n\n\t\tif (this.treeRoot != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tconst firstLabel = this.nextIndex;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\tthis.treeRoot.x,\n\t\t\t\tthis.treeRoot.y\n\t\t\t);\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel = this.first_print_pos_y;\n\t\t\tthis.printTreeRec(this.treeRoot);\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\tthis.cmd(act.step);\n\n\t\t\tfor (let i = firstLabel; i < this.nextIndex; i++) {\n\t\t\t\tthis.cmd(act.delete, i);\n\t\t\t}\n\t\t\tthis.nextIndex = this.highlightID; /// Reuse objects.  Not necessary.\n\t\t}\n\t\treturn this.commands;\n\t}\n\n\tprintTreeRec(tree) {\n\t\tthis.cmd(act.step);\n\t\tif (tree.left != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\tthis.printTreeRec(tree.left);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\tconst nextLabelID = this.nextIndex++;\n\t\tthis.cmd(act.createLabel, nextLabelID, tree.data, tree.x, tree.y);\n\t\tthis.cmd(act.setForegroundColor, nextLabelID, PRINT_COLOR);\n\t\tthis.cmd(act.move, nextLabelID, this.xPosOfNextLabel, this.yPosOfNextLabel);\n\t\tthis.cmd(act.step);\n\n\t\tthis.xPosOfNextLabel += PRINT_HORIZONTAL_GAP;\n\t\tif (this.xPosOfNextLabel > this.print_max) {\n\t\t\tthis.xPosOfNextLabel = FIRST_PRINT_POS_X;\n\t\t\tthis.yPosOfNextLabel += PRINT_VERTICAL_GAP;\n\t\t}\n\t\tif (tree.right != null) {\n\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\tthis.printTreeRec(tree.right);\n\t\t\tthis.cmd(act.move, this.highlightID, tree.x, tree.y);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t\treturn;\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clear.bind(this));\n\t}\n\n\tclear() {\n\t\tthis.commands = [];\n\t\tthis.recClear(this.treeRoot);\n\t\tthis.treeRoot = null;\n\t\treturn this.commands;\n\t}\n\n\trecClear(curr) {\n\t\tif (curr != null) {\n\t\t\tthis.cmd(act.delete, curr.graphicID);\n\t\t\tthis.recClear(curr.left);\n\t\t\tthis.recClear(curr.right);\n\t\t}\n\t}\n\n\tfindCallback() {\n\t\tconst findValue = this.normalizeNumber(this.findField.value, 4);\n\t\tthis.findField.value = '';\n\t\tthis.implementAction(this.findElement.bind(this), parseInt(findValue));\n\t}\n\n\tfindElement(findValue) {\n\t\tthis.commands = [];\n\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tconst found = this.doFind(this.treeRoot, findValue);\n\n\t\tif (found) {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' found.');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, 'Element ' + findValue + ' not found.');\n\t\t}\n\n\t\treturn this.commands;\n\t}\n\n\tdoFind(tree, value) {\n\t\tthis.cmd(act.setText, 0, 'Searching for ' + value);\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\t\tif (tree.data === value) {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Searching for ' + value + ' : ' + value + ' = ' + value + ' (Element found!)'\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splaying found node to root of tree');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\tthis.splayUp(tree);\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tif (tree.data > value) {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' < ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to left subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.left != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.left, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\tact.setText,\n\t\t\t\t\t\t0,\n\t\t\t\t\t\t'Searching for ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' : ' +\n\t\t\t\t\t\t\tvalue +\n\t\t\t\t\t\t\t' > ' +\n\t\t\t\t\t\t\ttree.data +\n\t\t\t\t\t\t\t' (look to right subtree)'\n\t\t\t\t\t);\n\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\t\t\t\tif (tree.right != null) {\n\t\t\t\t\t\tthis.cmd(\n\t\t\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\t\t\tthis.highlightID,\n\t\t\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\t\t\ttree.x,\n\t\t\t\t\t\t\ttree.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\t\t\tthis.cmd(act.step);\n\t\t\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\t\t\treturn this.doFind(tree.right, value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.splayUp(tree);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.setText,\n\t\t\t\t0,\n\t\t\t\t'Searching for ' + value + ' : < Empty Tree > (Element not found)'\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.setText, 0, 'Searching for ' + value + ' :  (Element not found)');\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tinsertElement(insertedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Inserting ' + insertedValue);\n\t\tthis.highlightID = this.nextIndex++;\n\n\t\tif (this.treeRoot == null) {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, this.startingX, STARTING_Y);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.treeRoot = new BSTNode(insertedValue, this.nextIndex, this.startingX, STARTING_Y);\n\t\t\tthis.nextIndex += 1;\n\t\t} else {\n\t\t\tthis.cmd(act.createCircle, this.nextIndex, insertedValue, 100, 100);\n\t\t\tthis.cmd(act.setForegroundColor, this.nextIndex, FOREGROUND_COLOR);\n\t\t\tthis.cmd(act.setBackgroundColor, this.nextIndex, BACKGROUND_COLOR);\n\t\t\tthis.cmd(act.step);\n\t\t\tconst insertElem = new BSTNode(insertedValue, this.nextIndex, 100, 100);\n\n\t\t\tthis.nextIndex += 1;\n\t\t\tthis.cmd(act.setHighlight, insertElem.graphicID, 1);\n\t\t\tthis.insert(insertElem, this.treeRoot);\n\t\t\tthis.resizeTree();\n\t\t\tthis.cmd(act.setText, 0, 'Splay inserted element to root of tree');\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.splayUp(insertElem);\n\t\t}\n\t\tthis.cmd(act.setText, 0, '');\n\t\treturn this.commands;\n\t}\n\n\tinsert(elem, tree) {\n\t\tlet foundDuplicate = false;\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 1);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 1);\n\n\t\tif (elem.data < tree.data) {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' < ' + tree.data + '.  Looking at left subtree');\n\t\t} else if (elem.data > tree.data) {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' >= ' + tree.data + '.  Looking at right subtree');\n\t\t} else {\n\t\t\tthis.cmd(act.setText, 0, elem.data + ' = ' + tree.data + '. Ignoring duplicate');\n\t\t\tfoundDuplicate = true;\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, tree.graphicID, 0);\n\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\n\t\tif (foundDuplicate) {\n\t\t\tthis.cmd(act.delete, elem.graphicID, 0);\n\t\t\treturn;\n\t\t}\n\n\t\tif (elem.data < tree.data) {\n\t\t\tif (tree.left == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.left = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.left.x, tree.left.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.left);\n\t\t\t}\n\t\t} else {\n\t\t\tif (tree.right == null) {\n\t\t\t\tthis.cmd(act.setText, 0, 'Found null tree, inserting element');\n\t\t\t\tthis.cmd(act.setHighlight, elem.graphicID, 0);\n\t\t\t\ttree.right = elem;\n\t\t\t\telem.parent = tree;\n\t\t\t\tthis.cmd(act.connect, tree.graphicID, elem.graphicID, LINK_COLOR);\n\t\t\t\telem.x = tree.x + WIDTH_DELTA / 2;\n\t\t\t\telem.y = tree.y + HEIGHT_DELTA;\n\t\t\t\tthis.cmd(act.move, elem.graphicID, elem.x, elem.y);\n\t\t\t} else {\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.createHighlightCircle,\n\t\t\t\t\tthis.highlightID,\n\t\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\t\ttree.x,\n\t\t\t\t\ttree.y\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\t\tthis.insert(elem, tree.right);\n\t\t\t}\n\t\t}\n\t}\n\n\tdeleteElement(deletedValue) {\n\t\tthis.commands = [];\n\t\tthis.cmd(act.setText, 0, 'Deleting ' + deletedValue);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, 0, '');\n\t\tthis.highlightID = this.nextIndex++;\n\t\tthis.treeDelete(this.treeRoot, deletedValue);\n\t\tthis.cmd(act.setText, 0, '');\n\t\t// Do delete\n\t\treturn this.commands;\n\t}\n\n\ttreeDelete(tree, valueToDelete) {\n\t\tthis.cmd(act.setText, 0, 'Finding ' + valueToDelete + ' and splaying to rooot');\n\t\tthis.cmd(act.step);\n\n\t\tconst inTree = this.doFind(this.treeRoot, valueToDelete);\n\t\tthis.cmd(act.setText, 0, 'Removing root, leaving left and right trees');\n\t\tthis.cmd(act.step);\n\t\tif (inTree) {\n\t\t\tif (this.treeRoot.right == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No right tree, make left tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.left;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else if (this.treeRoot.left == null) {\n\t\t\t\tthis.cmd(act.delete, this.treeRoot.graphicID);\n\t\t\t\tthis.cmd(act.setText, 0, 'No left tree, make right tree the root.');\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.treeRoot = this.treeRoot.right;\n\t\t\t\tthis.treeRoot.parent = null;\n\t\t\t\tthis.resizeTree();\n\t\t\t} else {\n\t\t\t\tconst right = this.treeRoot.right;\n\t\t\t\tconst left = this.treeRoot.left;\n\t\t\t\tconst oldGraphicID = this.treeRoot.graphicID;\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, left.graphicID);\n\t\t\t\tthis.cmd(act.disconnect, this.treeRoot.graphicID, right.graphicID);\n\t\t\t\tthis.cmd(act.setAlpha, this.treeRoot.graphicID, 0);\n\t\t\t\tthis.cmd(act.setText, 0, 'Splay largest element in left tree to root');\n\t\t\t\tthis.cmd(act.step);\n\n\t\t\t\tleft.parent = null;\n\t\t\t\tconst largestLeft = this.findMax(left);\n\t\t\t\tthis.splayUp(largestLeft);\n\t\t\t\tthis.cmd(\n\t\t\t\t\tact.setText,\n\t\t\t\t\t0,\n\t\t\t\t\t'Left tree now has no right subtree, connect left and right trees'\n\t\t\t\t);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\tthis.cmd(act.connect, largestLeft.graphicID, right.graphicID, LINK_COLOR);\n\t\t\t\tlargestLeft.parent = null;\n\t\t\t\tlargestLeft.right = right;\n\t\t\t\tright.parent = largestLeft;\n\t\t\t\tthis.treeRoot = largestLeft;\n\t\t\t\tthis.cmd(act.delete, oldGraphicID);\n\t\t\t\tthis.resizeTree();\n\t\t\t}\n\t\t}\n\t}\n\n\tsingleRotateRight(tree) {\n\t\tconst B = tree;\n\t\t// const t3 = B.right;\n\t\tconst A = tree.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tA.parent = B.parent;\n\t\tif (B.parent == null) {\n\t\t\tthis.treeRoot = A;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, B.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, B.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (B.isLeftChild()) {\n\t\t\t\tB.parent.left = A;\n\t\t\t} else {\n\t\t\t\tB.parent.right = A;\n\t\t\t}\n\t\t}\n\t\tA.right = B;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigRight(tree) {\n\t\tconst C = tree;\n\t\tconst B = tree.left;\n\t\tconst A = tree.left.left;\n\t\t// const t1 = A.left;\n\t\tconst t2 = A.right;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Right');\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, A.graphicID, 0);\n\n\t\tif (C.parent != null) {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = A;\n\t\t\t} else {\n\t\t\t\tC.parent.right = A;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = A;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, A.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = B;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = C;\n\t\t}\n\t\tthis.cmd(act.disconnect, B.graphicID, A.graphicID);\n\t\tthis.cmd(act.connect, A.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\n\t\tA.right = B;\n\t\tA.parent = C.parent;\n\t\tB.parent = A;\n\t\tB.left = t2;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tC.left = t3;\n\t\tthis.resizeTree();\n\t}\n\n\tzigZigLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\tconst C = tree.right.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = C.left;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig-Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 0);\n\t\tthis.cmd(act.setEdgeHighlight, B.graphicID, C.graphicID, 0);\n\n\t\tif (A.parent != null) {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, C.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = C;\n\t\t\t} else {\n\t\t\t\tA.parent.right = C;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.treeRoot = C;\n\t\t}\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, C.graphicID, t3.graphicID);\n\t\t\tthis.cmd(act.connect, B.graphicID, t3.graphicID, LINK_COLOR);\n\t\t\tt3.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.disconnect, B.graphicID, C.graphicID);\n\t\tthis.cmd(act.connect, C.graphicID, B.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tC.parent = A.parent;\n\t\tA.right = t2;\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = t3;\n\t\tC.left = B;\n\t\tB.parent = C;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsingleRotateLeft(tree) {\n\t\tconst A = tree;\n\t\tconst B = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\t// const t3 = B.right;\n\n\t\tthis.cmd(act.setText, 0, 'Zig Left');\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t\tt2.parent = A;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tB.parent = A.parent;\n\t\tif (A.parent == null) {\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID, LINK_COLOR);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t}\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tA.right = t2;\n\n\t\tthis.resizeTree();\n\t}\n\n\tsplayUp(tree) {\n\t\tif (tree.parent == null) {\n\t\t\treturn;\n\t\t} else if (tree.parent.parent == null) {\n\t\t\tif (tree.isLeftChild()) {\n\t\t\t\tthis.singleRotateRight(tree.parent);\n\t\t\t} else {\n\t\t\t\tthis.singleRotateLeft(tree.parent);\n\t\t\t}\n\t\t} else if (tree.isLeftChild() && !tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (!tree.isLeftChild() && tree.parent.isLeftChild()) {\n\t\t\tthis.doubleRotateRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else if (tree.isLeftChild()) {\n\t\t\tthis.zigZigRight(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t} else {\n\t\t\tthis.zigZigLeft(tree.parent.parent);\n\t\t\tthis.splayUp(tree);\n\t\t}\n\t}\n\n\tfindMax(tree) {\n\t\tif (tree.right != null) {\n\t\t\tthis.highlightID = this.nextIndex++;\n\t\t\tthis.cmd(\n\t\t\t\tact.createHighlightCircle,\n\t\t\t\tthis.highlightID,\n\t\t\t\tHIGHLIGHT_CIRCLE_COLOR,\n\t\t\t\ttree.x,\n\t\t\t\ttree.y\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\twhile (tree.right != null) {\n\t\t\t\tthis.cmd(act.move, this.highlightID, tree.right.x, tree.right.y);\n\t\t\t\tthis.cmd(act.step);\n\t\t\t\ttree = tree.right;\n\t\t\t}\n\t\t\tthis.cmd(act.delete, this.highlightID);\n\t\t\treturn tree;\n\t\t} else {\n\t\t\treturn tree;\n\t\t}\n\t}\n\n\tdoubleRotateRight(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Right');\n\t\tconst A = tree.left;\n\t\tconst B = tree.left.right;\n\t\tconst C = tree;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, A.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (C.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, C.parent.graphicID, C.graphicID);\n\t\t\tthis.cmd(act.connect, C.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (C.isLeftChild()) {\n\t\t\t\tC.parent.left = B;\n\t\t\t} else {\n\t\t\t\tC.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = C.parent;\n\t\t\tC.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, C.graphicID, A.graphicID);\n\t\tthis.cmd(act.disconnect, A.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tdoubleRotateLeft(tree) {\n\t\tthis.cmd(act.setText, 0, 'Zig-Zag Left');\n\t\tconst A = tree;\n\t\tconst B = tree.right.left;\n\t\tconst C = tree.right;\n\t\t// const t1 = A.left;\n\t\tconst t2 = B.left;\n\t\tconst t3 = B.right;\n\t\t// const t4 = C.right;\n\n\t\tthis.cmd(act.setEdgeHighlight, A.graphicID, C.graphicID, 1);\n\t\tthis.cmd(act.setEdgeHighlight, C.graphicID, B.graphicID, 1);\n\n\t\tthis.cmd(act.step);\n\n\t\tif (t2 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t2.graphicID);\n\t\t\tt2.parent = A;\n\t\t\tA.right = t2;\n\t\t\tthis.cmd(act.connect, A.graphicID, t2.graphicID, LINK_COLOR);\n\t\t}\n\t\tif (t3 != null) {\n\t\t\tthis.cmd(act.disconnect, B.graphicID, t3.graphicID);\n\t\t\tt3.parent = C;\n\t\t\tC.left = t2;\n\t\t\tthis.cmd(act.connect, C.graphicID, t3.graphicID, LINK_COLOR);\n\t\t}\n\n\t\tif (A.parent == null) {\n\t\t\tB.parent = null;\n\t\t\tthis.treeRoot = B;\n\t\t} else {\n\t\t\tthis.cmd(act.disconnect, A.parent.graphicID, A.graphicID);\n\t\t\tthis.cmd(act.connect, A.parent.graphicID, B.graphicID, LINK_COLOR);\n\t\t\tif (A.isLeftChild()) {\n\t\t\t\tA.parent.left = B;\n\t\t\t} else {\n\t\t\t\tA.parent.right = B;\n\t\t\t}\n\t\t\tB.parent = A.parent;\n\t\t\tA.parent = B;\n\t\t}\n\t\tthis.cmd(act.disconnect, A.graphicID, C.graphicID);\n\t\tthis.cmd(act.disconnect, C.graphicID, B.graphicID);\n\t\tthis.cmd(act.connect, B.graphicID, A.graphicID, LINK_COLOR);\n\t\tthis.cmd(act.connect, B.graphicID, C.graphicID, LINK_COLOR);\n\t\tB.left = A;\n\t\tA.parent = B;\n\t\tB.right = C;\n\t\tC.parent = B;\n\t\tA.right = t2;\n\t\tC.left = t3;\n\n\t\tthis.resizeTree();\n\t}\n\n\tresizeTree() {\n\t\tlet startingPoint = this.startingX;\n\t\tthis.resizeWidths(this.treeRoot);\n\t\tif (this.treeRoot != null) {\n\t\t\tif (this.treeRoot.leftWidth > startingPoint) {\n\t\t\t\tstartingPoint = this.treeRoot.leftWidth;\n\t\t\t} else if (this.treeRoot.rightWidth > startingPoint) {\n\t\t\t\tstartingPoint = Math.max(\n\t\t\t\t\tthis.treeRoot.leftWidth,\n\t\t\t\t\t2 * startingPoint - this.treeRoot.rightWidth\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.setNewPositions(this.treeRoot, startingPoint, STARTING_Y, 0);\n\t\t\tthis.animateNewPositions(this.treeRoot);\n\t\t\tthis.cmd(act.step);\n\t\t}\n\t}\n\n\tsetNewPositions(tree, xPosition, yPosition, side) {\n\t\tif (tree != null) {\n\t\t\ttree.y = yPosition;\n\t\t\tif (side === -1) {\n\t\t\t\txPosition = xPosition - tree.rightWidth;\n\t\t\t} else if (side === 1) {\n\t\t\t\txPosition = xPosition + tree.leftWidth;\n\t\t\t}\n\t\t\ttree.x = xPosition;\n\t\t\tthis.setNewPositions(tree.left, xPosition, yPosition + HEIGHT_DELTA, -1);\n\t\t\tthis.setNewPositions(tree.right, xPosition, yPosition + HEIGHT_DELTA, 1);\n\t\t}\n\t}\n\n\tanimateNewPositions(tree) {\n\t\tif (tree != null) {\n\t\t\tthis.cmd(act.move, tree.graphicID, tree.x, tree.y);\n\t\t\tthis.animateNewPositions(tree.left);\n\t\t\tthis.animateNewPositions(tree.right);\n\t\t}\n\t}\n\n\tresizeWidths(tree) {\n\t\tif (tree == null) {\n\t\t\treturn 0;\n\t\t}\n\t\ttree.leftWidth = Math.max(this.resizeWidths(tree.left), WIDTH_DELTA / 2);\n\t\ttree.rightWidth = Math.max(this.resizeWidths(tree.right), WIDTH_DELTA / 2);\n\t\treturn tree.leftWidth + tree.rightWidth;\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n}\n\nclass BSTNode {\n\tconstructor(val, id, initialX, initialY) {\n\t\tthis.data = val;\n\t\tthis.x = initialX;\n\t\tthis.y = initialY;\n\t\tthis.graphicID = id;\n\t\tthis.left = null;\n\t\tthis.right = null;\n\t\tthis.parent = null;\n\t}\n\n\tisLeftChild() {\n\t\tif (this.parent == null) {\n\t\t\treturn true;\n\t\t}\n\t\treturn this.parent.left === this;\n\t}\n}\n","import * as algos from './algo';\n\n// After adding the export in algos/index.js, add new algorithms in the following format:\n// AlgorithmName: ['Menu Display Name', algos.ClassName, 'Verbose Display Name (optional)']\nexport const algoMap = {\n\tArrayList: ['ArrayList', algos.ArrayList],\n\tLinkedList: ['Singly LinkedList', algos.LinkedList],\n\tDoublyLinkedList: ['Doubly LinkedList', algos.DoublyLinkedList],\n\tCircularlyLinkedList: ['Circularly LinkedList', algos.CircularlyLinkedList],\n\tStackArray: ['Stack (Array)', algos.StackArray],\n\tStackLL: ['Stack (LinkedList)', algos.StackLL],\n\tQueueArray: ['Queue (Array)', algos.QueueArray],\n\tQueueLL: ['Queue (LinkedList)', algos.QueueLL],\n\tDequeArray: ['Deque (Array)', algos.DequeArray],\n\tDequeLL: ['Deque (LinkedList)', algos.DequeLL],\n\tBST: ['Binary Search Tree', algos.BST],\n\tHeap: ['Heaps / PQs', algos.Heap],\n\tSkipList: ['SkipList', algos.SkipList],\n\tClosedHash: ['HashMap (Probing)', algos.ClosedHash],\n\tOpenHash: ['HashMap (Chaining)', algos.OpenHash],\n\tSplayTree: ['SplayTree', algos.SplayTree],\n\tAVL: ['AVL', algos.AVL],\n\tBTree: ['2-4 Tree', algos.BTree],\n\tBubbleSort: ['Bubble Sort', algos.BubbleSort],\n\tCocktailSort: ['Cocktail Shaker Sort', algos.CocktailSort],\n\tInsertionSort: ['Insertion Sort', algos.InsertionSort],\n\tSelectionSort: ['Selection Sort', algos.SelectionSort],\n\tQuickSort: ['QuickSort', algos.QuickSort],\n\tQuickSelect: ['QuickSelect', algos.QuickSelect],\n\tMergeSort: ['MergeSort', algos.MergeSort],\n\tLSDRadix: ['LSD Radix Sort', algos.LSDRadix],\n\tBruteForce: ['Brute Force', algos.BruteForce],\n\tBoyerMoore: ['Boyer-Moore', algos.BoyerMoore],\n\tKMP: ['KMP', algos.KMP],\n\tRabinKarp: ['Rabin-Karp', algos.RabinKarp],\n\tBFS: ['Breadth-First Search', algos.BFS],\n\tDFS: ['Depth-First Search', algos.DFS],\n\tDijkstra: [\"Dijkstra's\", algos.Dijkstra],\n\tPrim: [\"Prim's\", algos.Prim],\n\tKruskal: [\"Kruskal's\", algos.Kruskal],\n\tDPLCS: ['LCS', algos.DPLCS, 'Longest Common Subsequence'],\n\tFloyd: ['Floyd-Warshall', algos.Floyd],\n};\n\nexport const algoList = [\n\t'Lists',\n\t'ArrayList', 'LinkedList', 'DoublyLinkedList', 'CircularlyLinkedList',\n\t'Stacks, Queues and Deques',\n\t'StackArray', 'StackLL', 'QueueArray', 'QueueLL', 'DequeArray', 'DequeLL',\n\t'Trees and SkipList',\n\t'BST', 'Heap', 'AVL', 'BTree', 'SplayTree', 'SkipList',\n\t'HashMaps',\n\t'ClosedHash', 'OpenHash',\n\t'Sorting and QuickSelect',\n\t'BubbleSort', 'CocktailSort', 'InsertionSort', 'SelectionSort', 'QuickSort', 'QuickSelect', 'MergeSort', 'LSDRadix',\n\t'String Searching',\n\t'BruteForce', 'BoyerMoore', 'KMP', 'RabinKarp',\n\t'Graph Algorithms',\n\t'BFS', 'DFS', 'Dijkstra', 'Prim', 'Kruskal',\n\t'Dynamic Programming',\n\t'DPLCS', 'Floyd'\n]","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst ARRAY_START_X = 100;\nconst ARRAY_START_Y = 200;\nconst ARRAY_ELEM_WIDTH = 50;\nconst ARRAY_ELEM_HEIGHT = 50;\n\nconst ARRRAY_ELEMS_PER_LINE = 15;\nconst ARRAY_LINE_SPACING = 130;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 30;\n\nexport default class StackArray extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.nextIndex = 0;\n\n\t\tthis.arrayID = new Array(SIZE);\n\t\tthis.arrayLabelID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.arrayID[i] = this.nextIndex++;\n\t\t\tthis.arrayLabelID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\t\tthis.commands = [];\n\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tconst xpos = (i % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\t\tconst ypos = Math.floor(i / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\t\t\tthis.cmd(\n\t\t\t\tact.createRectangle,\n\t\t\t\tthis.arrayID[i],\n\t\t\t\t'',\n\t\t\t\tARRAY_ELEM_WIDTH,\n\t\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\t\txpos,\n\t\t\t\typos\n\t\t\t);\n\t\t\tthis.cmd(act.createLabel, this.arrayLabelID[i], i, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\t\tthis.cmd(act.setForegroundColor, this.arrayLabelID[i], '#0000FF');\n\t\t}\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'top', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t0,\n\t\t\tARRAY_ELEM_WIDTH,\n\t\t\tARRAY_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y\n\t\t);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.highlight1ID = this.nextIndex++;\n\t\tthis.highlight2ID = this.nextIndex++;\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearData.bind(this));\n\t}\n\n\tclearData() {\n\t\tthis.commands = [];\n\t\tthis.clearAll();\n\t\treturn this.commands;\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, xpos, ypos);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.setText, this.arrayID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.cmd(act.setHighlight, this.topID, 1);\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top - 1;\n\t\tthis.cmd(act.setText, this.topID, this.top);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setHighlight, this.topID, 0);\n\n\t\tthis.cmd(act.createHighlightCircle, this.highlight1ID, '#0000FF', TOP_POS_X, TOP_POS_Y);\n\t\tthis.cmd(act.step);\n\n\t\tconst xpos = (this.top % ARRRAY_ELEMS_PER_LINE) * ARRAY_ELEM_WIDTH + ARRAY_START_X;\n\t\tconst ypos =\n\t\t\tMath.floor(this.top / ARRRAY_ELEMS_PER_LINE) * ARRAY_LINE_SPACING + ARRAY_START_Y;\n\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.move, this.highlight1ID, xpos, ypos + ARRAY_ELEM_HEIGHT);\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.createLabel, labPopValID, this.arrayData[this.top], xpos, ypos);\n\t\tthis.cmd(act.setText, this.arrayID[this.top], '');\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.delete, this.highlight1ID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.setText, this.arrayID[i], '');\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setText, this.topID, '0');\n\t\treturn this.commands;\n\t}\n}\n","// Copyright 2011 David Galles, University of San Francisco. All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, are\n// permitted provided that the following conditions are met:\n//\n// 1. Redistributions of source code must retain the above copyright notice, this list of\n// conditions and the following disclaimer.\n//\n// 2. Redistributions in binary form must reproduce the above copyright notice, this list\n// of conditions and the following disclaimer in the documentation and/or other materials\n// provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY <COPYRIGHT HOLDER> ``AS IS'' AND ANY EXPRESS OR IMPLIED\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\n// FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> OR\n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n// NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF\n// ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n//\n// The views and conclusions contained in the software and documentation are those of the\n// authors and should not be interpreted as representing official policies, either expressed\n// or implied, of the University of San Francisco\n\nimport Algorithm, { addControlToAlgorithmBar, addDivisorToAlgorithmBar } from './Algorithm.js';\nimport { act } from '../anim/AnimationMain';\n\nconst LINKED_LIST_START_X = 100;\nconst LINKED_LIST_START_Y = 200;\nconst LINKED_LIST_ELEM_WIDTH = 70;\nconst LINKED_LIST_ELEM_HEIGHT = 30;\n\nconst LINKED_LIST_INSERT_X = 250;\nconst LINKED_LIST_INSERT_Y = 50;\n\nconst LINKED_LIST_ELEMS_PER_LINE = 8;\nconst LINKED_LIST_ELEM_SPACING = 100;\nconst LINKED_LIST_LINE_SPACING = 100;\n\nconst TOP_POS_X = 180;\nconst TOP_POS_Y = 100;\nconst TOP_LABEL_X = 130;\nconst TOP_LABEL_Y = 100;\n\nconst TOP_ELEM_WIDTH = 30;\nconst TOP_ELEM_HEIGHT = 30;\n\nconst PUSH_LABEL_X = 50;\nconst PUSH_LABEL_Y = 30;\nconst PUSH_ELEMENT_X = 120;\nconst PUSH_ELEMENT_Y = 30;\n\nconst SIZE = 32;\n\nexport default class StackLL extends Algorithm {\n\tconstructor(am, w, h) {\n\t\tsuper(am, w, h);\n\n\t\tthis.addControls();\n\t\tthis.nextIndex = 0;\n\t\tthis.commands = [];\n\t\tthis.setup();\n\t\tthis.initialIndex = this.nextIndex;\n\t}\n\n\taddControls() {\n\t\tthis.controls = [];\n\t\tthis.pushField = addControlToAlgorithmBar('Text', '');\n\t\tthis.pushField.onkeydown = this.returnSubmit(\n\t\t\tthis.pushField,\n\t\t\tthis.pushCallback.bind(this),\n\t\t\t4\n\t\t);\n\n\t\tthis.pushButton = addControlToAlgorithmBar('Button', 'Push');\n\t\tthis.pushButton.onclick = this.pushCallback.bind(this);\n\t\tthis.controls.push(this.pushField);\n\t\tthis.controls.push(this.pushButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.popButton = addControlToAlgorithmBar('Button', 'Pop');\n\t\tthis.popButton.onclick = this.popCallback.bind(this);\n\t\tthis.controls.push(this.popButton);\n\n\t\taddDivisorToAlgorithmBar();\n\n\t\tthis.clearButton = addControlToAlgorithmBar('Button', 'Clear');\n\t\tthis.clearButton.onclick = this.clearCallback.bind(this);\n\t\tthis.controls.push(this.clearButton);\n\t}\n\n\tenableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = false;\n\t\t}\n\t}\n\n\tdisableUI() {\n\t\tfor (let i = 0; i < this.controls.length; i++) {\n\t\t\tthis.controls[i].disabled = true;\n\t\t}\n\t}\n\n\tsetup() {\n\t\tthis.linkedListElemID = new Array(SIZE);\n\t\tfor (let i = 0; i < SIZE; i++) {\n\t\t\tthis.linkedListElemID[i] = this.nextIndex++;\n\t\t}\n\t\tthis.topID = this.nextIndex++;\n\t\tthis.topLabelID = this.nextIndex++;\n\n\t\tthis.arrayData = new Array(SIZE);\n\t\tthis.top = 0;\n\t\tthis.leftoverLabelID = this.nextIndex++;\n\n\t\tthis.cmd(act.createLabel, this.topLabelID, 'Top', TOP_LABEL_X, TOP_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createRectangle,\n\t\t\tthis.topID,\n\t\t\t'',\n\t\t\tTOP_ELEM_WIDTH,\n\t\t\tTOP_ELEM_HEIGHT,\n\t\t\tTOP_POS_X,\n\t\t\tTOP_POS_Y\n\t\t);\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\n\t\tthis.cmd(act.createLabel, this.leftoverLabelID, '', PUSH_LABEL_X, PUSH_LABEL_Y);\n\n\t\tthis.animationManager.startNewAnimation(this.commands);\n\t\tthis.animationManager.skipForward();\n\t\tthis.animationManager.clearHistory();\n\t}\n\n\tresetLinkedListPositions() {\n\t\tfor (let i = this.top - 1; i >= 0; i--) {\n\t\t\tconst nextX =\n\t\t\t\t((this.top - 1 - i) % LINKED_LIST_ELEMS_PER_LINE) * LINKED_LIST_ELEM_SPACING +\n\t\t\t\tLINKED_LIST_START_X;\n\t\t\tconst nextY =\n\t\t\t\tMath.floor((this.top - 1 - i) / LINKED_LIST_ELEMS_PER_LINE) *\n\t\t\t\t\tLINKED_LIST_LINE_SPACING +\n\t\t\t\tLINKED_LIST_START_Y;\n\t\t\tthis.cmd(act.move, this.linkedListElemID[i], nextX, nextY);\n\t\t}\n\t}\n\n\treset() {\n\t\tthis.top = 0;\n\t\tthis.nextIndex = this.initialIndex;\n\t}\n\n\tpushCallback() {\n\t\tif (this.top < SIZE && this.pushField.value !== '') {\n\t\t\tconst pushVal = this.pushField.value;\n\t\t\tthis.pushField.value = '';\n\t\t\tthis.implementAction(this.push.bind(this), pushVal);\n\t\t}\n\t}\n\n\tpopCallback() {\n\t\tif (this.top > 0) {\n\t\t\tthis.implementAction(this.pop.bind(this));\n\t\t}\n\t}\n\n\tclearCallback() {\n\t\tthis.implementAction(this.clearAll.bind(this));\n\t}\n\n\tpush(elemToPush) {\n\t\tthis.commands = [];\n\n\t\tconst labPushID = this.nextIndex++;\n\t\tconst labPushValID = this.nextIndex++;\n\t\tthis.arrayData[this.top] = elemToPush;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(\n\t\t\tact.createLinkedListNode,\n\t\t\tthis.linkedListElemID[this.top],\n\t\t\t'',\n\t\t\tLINKED_LIST_ELEM_WIDTH,\n\t\t\tLINKED_LIST_ELEM_HEIGHT,\n\t\t\tLINKED_LIST_INSERT_X,\n\t\t\tLINKED_LIST_INSERT_Y,\n\t\t\t0.25,\n\t\t\t0,\n\t\t\t1\n\t\t);\n\n\t\tthis.cmd(act.createLabel, labPushID, 'Pushing Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(act.createLabel, labPushValID, elemToPush, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\n\t\tthis.cmd(act.step);\n\n\t\tthis.cmd(act.move, labPushValID, LINKED_LIST_INSERT_X, LINKED_LIST_INSERT_Y);\n\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.setText, this.linkedListElemID[this.top], elemToPush);\n\t\tthis.cmd(act.delete, labPushValID);\n\n\t\tif (this.top === 0) {\n\t\t\tthis.cmd(act.setNull, this.topID, 0);\n\t\t\tthis.cmd(act.setNull, this.linkedListElemID[this.top], 1);\n\t\t} else {\n\t\t\tthis.cmd(\n\t\t\t\tact.connect,\n\t\t\t\tthis.linkedListElemID[this.top],\n\t\t\t\tthis.linkedListElemID[this.top - 1]\n\t\t\t);\n\t\t\tthis.cmd(act.step);\n\t\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\t\t}\n\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top]);\n\n\t\tthis.cmd(act.step);\n\t\tthis.top = this.top + 1;\n\t\tthis.resetLinkedListPositions();\n\t\tthis.cmd(act.delete, labPushID);\n\t\tthis.cmd(act.step);\n\n\t\treturn this.commands;\n\t}\n\n\tpop() {\n\t\tthis.commands = [];\n\n\t\tconst labPopID = this.nextIndex++;\n\t\tconst labPopValID = this.nextIndex++;\n\n\t\tthis.cmd(act.setText, this.leftoverLabelID, '');\n\n\t\tthis.cmd(act.createLabel, labPopID, 'Popped Value: ', PUSH_LABEL_X, PUSH_LABEL_Y);\n\t\tthis.cmd(\n\t\t\tact.createLabel,\n\t\t\tlabPopValID,\n\t\t\tthis.arrayData[this.top - 1],\n\t\t\tLINKED_LIST_START_X,\n\t\t\tLINKED_LIST_START_Y\n\t\t);\n\n\t\tthis.cmd(act.move, labPopValID, PUSH_ELEMENT_X, PUSH_ELEMENT_Y);\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.disconnect, this.topID, this.linkedListElemID[this.top - 1]);\n\n\t\tif (this.top === 1) {\n\t\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\t} else {\n\t\t\tthis.cmd(act.connect, this.topID, this.linkedListElemID[this.top - 2]);\n\t\t}\n\t\tthis.cmd(act.step);\n\t\tthis.cmd(act.delete, this.linkedListElemID[this.top - 1]);\n\t\tthis.top = this.top - 1;\n\t\tthis.resetLinkedListPositions();\n\n\t\tthis.cmd(act.delete, labPopValID);\n\t\tthis.cmd(act.delete, labPopID);\n\t\tthis.cmd(act.setText, this.leftoverLabelID, 'Popped Value: ' + this.arrayData[this.top]);\n\n\t\treturn this.commands;\n\t}\n\n\tclearAll() {\n\t\tthis.commands = [];\n\t\tfor (let i = 0; i < this.top; i++) {\n\t\t\tthis.cmd(act.delete, this.linkedListElemID[i]);\n\t\t}\n\t\tthis.top = 0;\n\t\tthis.cmd(act.setNull, this.topID, 1);\n\t\treturn this.commands;\n\t}\n}\n","import React from 'react';\n\n// Include the ClassName of algorithms that should have an example modal\nexport default {\n\tAVL: (\n\t\t<ul>\n\t\t\t<li>To cause a left rotation, add 1, 2 and 3, in that order</li>\n\t\t\t<li>To cause a right rotation, add 3, 2 and 1, in that order</li>\n\t\t\t<li>To cause a left-right rotation, add 3, 1 and 2, in that order</li>\n\t\t\t<li>To cause a right-left rotation, add 1, 3 and 2, in that order</li>\n\t\t</ul>\n\t),\n\tBoyerMoore: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different first letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;baaaa&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBruteForce: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a text with only one letter and a pattern with that\n\t\t\t\tsame letter, but a different last letter (for example, &quot;aaaaaaaaa&quot; for\n\t\t\t\ttext and &quot;aaaab&quot; for pattern), since we will only mismatch on the last\n\t\t\t\tcomparison\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tBST: (\n\t\t<ul>\n\t\t\t<li>To get a degenerate BST, you can add ascending data, such as 1, 2, 3, ...</li>\n\t\t\t<li>To get a full BST, you can add 2, 1, 4, 3, 5, in that order</li>\n\t\t\t<li>To get a complete BST, you can add 3, 2, 4, 1, in that order</li>\n\t\t\t<li>To get a full and complete BST, you can add 4, 2, 5, 1, 3, in that order</li>\n\t\t</ul>\n\t),\n\tBTree: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tTo cause overflow and trigger a promotion, add more than 3 data (for example 1, 2, 3\n\t\t\t\tand 4)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from a leaf node, add 1, 2, 3 and 4, in that order, then remove 3 or 4\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo remove from an inner node and use the predecessor, add 1, 3, 4, 5 and 2, in that\n\t\t\t\torder, then remove 3\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tTo cause underflow and trigger a rotation/transfer, add 1, 2, 3 and 4, in that\n\t\t\t\torder, then remove 1\n\t\t\t</li>\n\t\t\t<li>To cause underflow and trigger a fusion, follow the steps above then remove 2</li>\n\t\t</ul>\n\t),\n\tBubbleSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tCocktailSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tEven though Cocktail Shaker Sort has the same big-O as Bubble Sort, it is still\n\t\t\t\tfaster; one case where it significantly outperforms Bubble Sort is when we have a\n\t\t\t\tsorted array, except for the last element which is the smallest, for example [2, 3,\n\t\t\t\t4, 5, 6, 7, 8, 9, 1]\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tInsertionSort: (\n\t\t<ul>\n\t\t\t<li>The best case is when we have a sorted array (terminates if no swaps are made)</li>\n\t\t\t<li>\n\t\t\t\tThe worst case is when we have a reverse sorted array (we perform\n\t\t\t\t<p className=\"equation\">\n\t\t\t\t\tn + (n - 1) + (n - 2) + ... = n<sup>2</sup>\n\t\t\t\t</p>\n\t\t\t\tcomparisons)\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSelect: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tQuickSort: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tThe worst case occurs when we pick a bad pivot everytime (for example, the smallest\n\t\t\t\tor largest element), since we can no longer subvide the array and the algorithms\n\t\t\t\tbecomes similar to Selection Sort\n\t\t\t</li>\n\t\t</ul>\n\t),\n\tSkipList: (\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\tYou can get a degenerate SkipList by always adding with a constant amount of heads,\n\t\t\t\tfor example 0 or 4.\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\tNote that in a real SkipList, you would have an <span className=\"inline-eq\">O(log n) </span>\n\t\t\t\tcap to the number of levels, so we wouldn't be able to add the first element with 4\n\t\t\t\theads, for example.\n\t\t\t</li>\n\t\t</ul>\n\t),\n};\n","import '../css/AlgoScreen.css';\nimport '../css/App.css';\nimport AnimationManager from '../anim/AnimationMain';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { algoMap } from '../AlgoList';\nimport modals from '../examples/ExampleModals';\n\nclass AlgoScreen extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tconst algoName = props.location.pathname.slice(1);\n\t\tthis.canvasRef = React.createRef();\n\t\tthis.animBarRef = React.createRef();\n\n\t\tthis.state = {\n\t\t\talgoName: algoName,\n\t\t\texamplesEnabled: false,\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tif (algoMap[this.state.algoName]) {\n\t\t\tthis.animManag = new AnimationManager(this.canvasRef, this.animBarRef);\n\n\t\t\tthis.currentAlg = new algoMap[this.state.algoName][1](\n\t\t\t\tthis.animManag,\n\t\t\t\tthis.canvasRef.current.width,\n\t\t\t\tthis.canvasRef.current.height\n\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst algoName = this.state.algoName;\n\t\tif (!algoMap[algoName]) {\n\t\t\treturn (\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<Header/>\n\t\t\t\t\t<div className=\"content\">\n\t\t\t\t\t\t<div className=\"four-o-four\">\n\t\t\t\t\t\t\t<h1>404!</h1>\n\t\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t\tAlgorithm not found! Click <Link to=\"/\">here</Link> to return to the home screen and choose\n\t\t\t\t\t\t\t\tanother algorithm.\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Footer/>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\tconst header = algoMap[algoName][2]\n\t\t\t? algoMap[algoName][2]\n\t\t\t: algoMap[algoName][0];\n\t\treturn (\n\t\t\t<div className=\"VisualizationMainPage\">\n\t\t\t\t<div id=\"container\">\n\t\t\t\t\t<div id=\"header\">\n\t\t\t\t\t\t<h1><Link to=\"/\">&#x3008;</Link>&nbsp;&nbsp;{header}</h1>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"mainContent\">\n\t\t\t\t\t\t<div id=\"algoControlSection\">\n\t\t\t\t\t\t\t<table id=\"AlgorithmSpecificControls\"></table>\n\t\t\t\t\t\t\t{modals[algoName] && (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={this.state.examplesEnabled ? 'selected' : ''}\n\t\t\t\t\t\t\t\t\tid=\"examplesButton\"\n\t\t\t\t\t\t\t\t\tonClick={this.toggleExamples}\n\t\t\t\t\t\t\t\t></button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div className=\"viewport\">\n\t\t\t\t\t\t\t<canvas id=\"canvas\" width=\"1500\" height=\"505\" ref={this.canvasRef}></canvas>\n\t\t\t\t\t\t\t{this.state.examplesEnabled && (\n\t\t\t\t\t\t\t\t<div className=\"modal\">\n\t\t\t\t\t\t\t\t\t<div className=\"modal-content\">{modals[algoName]}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div id=\"generalAnimationControlSection\">\n\t\t\t\t\t\t\t<table id=\"GeneralAnimationControls\" ref={this.animBarRef}></table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div id=\"footer\">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t<Link to=\"/\">Return to Home Page</Link>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\ttoggleExamples = () => this.setState(state => ({ examplesEnabled: !state.examplesEnabled }));\n}\n\nAlgoScreen.propTypes = {\n\tlocation: PropTypes.object,\n};\n\nexport default AlgoScreen;\n","import React from 'react';\n\nconst AboutScreen = () => (\n\t<div className=\"about\">\n\t\t<p>\n\t\t\tThis is a tool to help you visualize and understand the data structures and algorithms\n\t\t\tcovered in Georgia Tech's CS1332 course. It is based on the{' '}\n\t\t\t<a href=\"https://www.cs.usfca.edu/~galles/visualization/about.html\">\n\t\t\t\tData Structures Visualizations website\n\t\t\t</a>{' '}\n\t\t\tby David Gales.\n\t\t</p>\n\t\t<p>\n\t\t\tThe CS1332 Visualization Tool was adapted and expanded by Rodrigo Pontes, with the help of\n\t\t\tMiguel de los Reyes and Alex McQuilkin and under the supervision of Prof. Mary Hudachek-Buswell,\n\t\t\tto include data structures and algorithms covered in the course.\n\t\t</p>\n\t\t<p>\n\t\t\tIt also includes icons from{' '}\n\t\t\t<a href=\"https://material.io/resources/icons/?style=baseline\">\n\t\t\t\tGoogle&#39;s Material Icons\n\t\t\t</a>,\n\t\t\tand components from{' '}\n\t\t\t<a href=\"https://material-ui.com/\">\n\t\t\t\tMaterial UI\n\t\t\t</a>.\n\t\t</p>\n\t</div>\n);\n\nexport default AboutScreen;\n","import '../css/App.css';\nimport { Link, Route, Switch } from 'react-router-dom';\nimport { algoList, algoMap } from '../AlgoList';\nimport AboutScreen from './AboutScreen';\nimport Footer from '../components/Footer';\nimport Header from '../components/Header';\nimport React from 'react';\n\nconst HomeScreen = () => (\n\t<div className=\"container\">\n\t\t<Header/>\n\t\t<div className=\"content\">\n\t\t\t<Switch>\n\t\t\t\t<Route exact path=\"/\">\n\t\t\t\t\t<div className=\"outer-flex\">\n\t\t\t\t\t\t<div className=\"inner-flex\">\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\talgoList.map((name, idx) => algoMap[name] ?\n\t\t\t\t\t\t\t\t<Link to={`/${name}`} key={idx}>\n\t\t\t\t\t\t\t\t\t<input className=\"button\" type=\"button\" value={algoMap[name][0]} />\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t<div key={idx} className=\"divider\">\n\t\t\t\t\t\t\t\t\t<span>{name}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Route>\n\t\t\t\t<Route path=\"/about\">\n\t\t\t\t\t<AboutScreen/>\n\t\t\t\t</Route>\n\t\t\t</Switch>\n\t\t</div>\n\t\t<Footer/>\n\t</div>\n);\n\nexport default HomeScreen;\n","import './css/App.css';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport AlgoScreen from './screens/AlgoScreen';\nimport HomeScreen from './screens/HomeScreen';\nimport React from 'react';\n\nconst App = () => (\n\t<Router basename={process.env.PUBLIC_URL + '/'}>\n\t\t<Switch>\n\t\t\t<Route exact path={[\"/\", \"/about\"]} component={HomeScreen} />\n\t\t\t<Route component={AlgoScreen} />\n\t\t</Switch>\n\t</Router>\n);\n\nexport default App;\n","import * as serviceWorker from './serviceWorker';\nimport App from './App';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}